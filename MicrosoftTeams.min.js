!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("microsoftTeams",[],t):"object"==typeof exports?exports.microsoftTeams=t():e.microsoftTeams=t()}("undefined"!=typeof self?self:this,(()=>(()=>{var e={933:(e,t)=>{"use strict";t.byteLength=function(e){var t=s(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,i=s(e),a=i[0],u=i[1],l=new o(c(e,a,u)),d=0,f=u>0?a-4:a;for(n=0;n<f;n+=4)t=r[e.charCodeAt(n)]<<18|r[e.charCodeAt(n+1)]<<12|r[e.charCodeAt(n+2)]<<6|r[e.charCodeAt(n+3)],l[d++]=t>>16&255,l[d++]=t>>8&255,l[d++]=255&t;2===u&&(t=r[e.charCodeAt(n)]<<2|r[e.charCodeAt(n+1)]>>4,l[d++]=255&t);1===u&&(t=r[e.charCodeAt(n)]<<10|r[e.charCodeAt(n+1)]<<4|r[e.charCodeAt(n+2)]>>2,l[d++]=t>>8&255,l[d++]=255&t);return l},t.fromByteArray=function(e){for(var t,r=e.length,o=r%3,i=[],a=16383,s=0,c=r-o;s<c;s+=a)i.push(l(e,s,s+a>c?c:s+a));1===o?(t=e[r-1],i.push(n[t>>2]+n[t<<4&63]+"==")):2===o&&(t=(e[r-2]<<8)+e[r-1],i.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"="));return i.join("")};for(var n=[],r=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0;a<64;++a)n[a]=i[a],r[i.charCodeAt(a)]=a;function s(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function c(e,t,n){return 3*(t+n)/4-n}function u(e){return n[e>>18&63]+n[e>>12&63]+n[e>>6&63]+n[63&e]}function l(e,t,n){for(var r,o=[],i=t;i<n;i+=3)r=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(255&e[i+2]),o.push(u(r));return o.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},815:(e,t,n)=>{t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,o=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(r++,"%c"===e&&(o=r))})),t.splice(o,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=n(530)(t);const{formatters:r}=e.exports;r.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},530:(e,t,n)=>{e.exports=function(e){function t(e){let n,o,i,a=null;function s(...e){if(!s.enabled)return;const r=s,o=Number(new Date),i=o-(n||o);r.diff=i,r.prev=n,r.curr=o,n=o,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((n,o)=>{if("%%"===n)return"%";a++;const i=t.formatters[o];if("function"==typeof i){const t=e[a];n=i.call(r,t),e.splice(a,1),a--}return n})),t.formatArgs.call(r,e);(r.log||t.log).apply(r,e)}return s.namespace=e,s.useColors=t.useColors(),s.color=t.selectColor(e),s.extend=r,s.destroy=t.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==a?a:(o!==t.namespaces&&(o=t.namespaces,i=t.enabled(e)),i),set:e=>{a=e}}),"function"==typeof t.init&&t.init(s),s}function r(e,n){const r=t(this.namespace+(void 0===n?":":n)+e);return r.log=this.log,r}function o(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names.map(o),...t.skips.map(o).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const r=("string"==typeof e?e:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(821),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((n=>{t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}},821:e=>{var t=1e3,n=60*t,r=60*n,o=24*r,i=7*o;function a(e){if(!((e=String(e)).length>100)){var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(a){var s=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*s;case"weeks":case"week":case"w":return s*i;case"days":case"day":case"d":return s*o;case"hours":case"hour":case"hrs":case"hr":case"h":return s*r;case"minutes":case"minute":case"mins":case"min":case"m":return s*n;case"seconds":case"second":case"secs":case"sec":case"s":return s*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}}}function s(e){var i=Math.abs(e);return i>=o?Math.round(e/o)+"d":i>=r?Math.round(e/r)+"h":i>=n?Math.round(e/n)+"m":i>=t?Math.round(e/t)+"s":e+"ms"}function c(e){var i=Math.abs(e);return i>=o?u(e,i,o,"day"):i>=r?u(e,i,r,"hour"):i>=n?u(e,i,n,"minute"):i>=t?u(e,i,t,"second"):e+" ms"}function u(e,t,n,r){var o=t>=1.5*n;return Math.round(e/n)+" "+r+(o?"s":"")}e.exports=function(e,t){t=t||{};var n=typeof e;if("string"===n&&e.length>0)return a(e);if("number"===n&&isFinite(e))return t.long?c(e):s(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,o){if(1&o&&(r=this(r)),8&o)return r;if("object"==typeof r&&r){if(4&o&&r.__esModule)return r;if(16&o&&"function"==typeof r.then)return r}var i=Object.create(null);n.r(i);var a={};e=e||[null,t({}),t([]),t(t)];for(var s=2&o&&r;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((e=>a[e]=()=>r[e]));return a.default=()=>r,n.d(i,a),i}})(),(()=>{n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}})(),(()=>{n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}})();var r={};return(()=>{"use strict";n.r(r),n.d(r,{ActionObjectType:()=>Me,AppId:()=>Yr,ChannelType:()=>fn,ChildAppWindow:()=>Wm,DialogDimension:()=>dn,EduType:()=>_e,EmailAddress:()=>eg,ErrorCode:()=>xe,FileOpenPreference:()=>ke,FrameContexts:()=>sn,HostClientType:()=>on,HostName:()=>an,LiveShareHost:()=>hC,NotificationTypes:()=>Gc,ParentAppWindow:()=>jm,RenderingSurfaces:()=>cn,SecondaryM365ContentIdName:()=>Ne,TaskModuleDimension:()=>dn,TeamType:()=>un,UUID:()=>jn,UserSettingTypes:()=>Kc,UserTeamRole:()=>ln,ValidatedSafeString:()=>Xr,ViewerActionTypes:()=>Jc,activateChildProxyingCommunication:()=>br,app:()=>i,appEntity:()=>W,appInitialization:()=>Pe,appInstallDialog:()=>X,authentication:()=>Z,barCode:()=>ee,calendar:()=>de,call:()=>Ie,chat:()=>te,clipboard:()=>ne,conversations:()=>b,copilot:()=>O,dialog:()=>f,enablePrintCapability:()=>Ow,executeDeepLink:()=>zw,externalAppAuthentication:()=>R,externalAppAuthenticationForCEA:()=>F,externalAppCardActions:()=>k,externalAppCardActionsForCEA:()=>M,externalAppCardActionsForDA:()=>N,externalAppCommands:()=>x,files:()=>D,geoLocation:()=>ie,getAdaptiveCardSchemaVersion:()=>Vm,getContext:()=>Fw,getCurrentFeatureFlagsState:()=>Ir,getMruTabInstances:()=>Ww,getTabInstances:()=>Bw,hostEntity:()=>K,initialize:()=>Tw,initializeWithFrameContext:()=>qw,liveShare:()=>Fe,location:()=>se,logs:()=>S,mail:()=>pe,marketplace:()=>Be,media:()=>Y,meeting:()=>ue,meetingRoom:()=>U,menus:()=>p,messageChannels:()=>L,monetization:()=>le,navigateBack:()=>Zw,navigateCrossDomain:()=>Qw,navigateToTab:()=>Kw,nestedAppAuth:()=>re,nestedAppAuthBridge:()=>H,notifications:()=>_,openFilePreview:()=>nu,otherAppStateChange:()=>V,overwriteFeatureFlagsState:()=>Tr,pages:()=>y,people:()=>me,print:()=>Rw,profile:()=>he,registerAppButtonClickHandler:()=>Nw,registerAppButtonHoverEnterHandler:()=>xw,registerAppButtonHoverLeaveHandler:()=>Dw,registerBackButtonHandler:()=>Uw,registerBeforeUnloadHandler:()=>Hw,registerChangeSettingsHandler:()=>Vw,registerCustomHandler:()=>eu,registerFocusEnterHandler:()=>_w,registerFullScreenHandler:()=>Mw,registerOnLoadHandler:()=>Lw,registerOnThemeChangeHandler:()=>kw,registerUserSettingsChangeHandler:()=>tu,remoteCamera:()=>B,returnFocus:()=>Jw,search:()=>ve,secondaryBrowser:()=>ae,sendCustomEvent:()=>Yc,sendCustomMessage:()=>Xc,setFeatureFlagsState:()=>Pr,setFrameContext:()=>$w,settings:()=>Oe,shareDeepLink:()=>jw,sharing:()=>Ce,sidePanelInterfaces:()=>I,stageView:()=>Se,store:()=>Q,tasks:()=>Re,teams:()=>$,teamsCore:()=>ge,thirdPartyCloudStorage:()=>Te,uploadCustomApp:()=>Zc,version:()=>yr,videoEffects:()=>q,videoEffectsEx:()=>G,visualMedia:()=>Ee,webStorage:()=>Ae});var e={};n.r(e),n.d(e,{_clearTelemetryPort:()=>so,getTelemetryPort:()=>io,isSupported:()=>ao});var t={};n.r(t),n.d(t,{_clearDataLayerPort:()=>mo,getDataLayerPort:()=>po,isSupported:()=>go});var o={};n.r(o),n.d(o,{registerBeforeSuspendOrTerminateHandler:()=>ho,registerOnResumeHandler:()=>vo});var i={};n.r(i),n.d(i,{ExpectedFailureReason:()=>bo,FailedReason:()=>So,Messages:()=>yo,_initialize:()=>Po,_uninitialize:()=>To,getContext:()=>Oo,getFrameContext:()=>Ao,initialize:()=>Io,isInitialized:()=>Eo,lifecycle:()=>o,notifyAppLoaded:()=>Ro,notifyExpectedFailure:()=>Mo,notifyFailure:()=>ko,notifySuccess:()=>Fo,openLink:()=>Do,registerHostToAppPerformanceMetricsHandler:()=>xo,registerOnThemeChangeHandler:()=>No});var a={};n.r(a),n.d(a,{isSupported:()=>Ho,resize:()=>Lo});var s={};n.r(s),n.d(s,{isSupported:()=>Vo,open:()=>_o});var c={};n.r(c),n.d(c,{isSupported:()=>zo,registerOnMessageFromParent:()=>jo,sendMessageToDialog:()=>Wo,sendMessageToParentFromDialog:()=>Bo});var u={};n.r(u),n.d(u,{bot:()=>s,getDialogInfoFromBotUrlDialogInfo:()=>Ko,getDialogInfoFromUrlDialogInfo:()=>Jo,isSupported:()=>Go,open:()=>$o,parentCommunication:()=>c,submit:()=>qo});var l={};n.r(l),n.d(l,{isSupported:()=>si,open:()=>ai});var d={};n.r(d),n.d(d,{bot:()=>l,isSupported:()=>ui,open:()=>ci});var f={};n.r(f),n.d(f,{adaptiveCard:()=>d,initialize:()=>li,isSupported:()=>di,update:()=>a,url:()=>u});var p={};n.r(p),n.d(p,{DisplayMode:()=>pi,MenuItem:()=>mi,MenuListType:()=>gi,initialize:()=>Si,isSupported:()=>Oi,setNavBarMenu:()=>Ai,setUpViews:()=>bi,showActionMenu:()=>Pi});var g={};n.r(g),n.d(g,{initialize:()=>Ri,isSupported:()=>Bi,registerChangeConfigHandler:()=>Li,registerOnRemoveHandler:()=>xi,registerOnRemoveHandlerHelper:()=>Di,registerOnSaveHandler:()=>Mi,registerOnSaveHandlerHelper:()=>Ni,setConfig:()=>ki,setValidityState:()=>Fi});var m={};n.r(m),n.d(m,{isSupported:()=>wa,onClick:()=>ma,onHoverEnter:()=>ha,onHoverLeave:()=>va});var h={};n.r(h),n.d(h,{_initialize:()=>Ca,isSupported:()=>Ea,navigateBack:()=>ya,registerBackButtonHandler:()=>Sa,registerBackButtonHandlerHelper:()=>ba});var v={};n.r(v),n.d(v,{isSupported:()=>Pa,navigateTo:()=>Aa,navigateToDefaultPage:()=>Ia});var w={};n.r(w),n.d(w,{enterFullscreen:()=>Ta,exitFullscreen:()=>Oa,isSupported:()=>Ra});var C={};n.r(C),n.d(C,{getMruTabInstances:()=>Ma,getTabInstances:()=>ka,isSupported:()=>Na,navigateToTab:()=>Fa});var y={};n.r(y),n.d(y,{EnterFocusType:()=>xa,ReturnFocusType:()=>Da,appButton:()=>m,backStack:()=>h,config:()=>g,currentApp:()=>v,fullTrust:()=>w,getConfig:()=>Va,initializeWithFrameContext:()=>_a,isSupported:()=>$a,navigateCrossDomain:()=>Ba,navigateToApp:()=>Wa,registerFocusEnterHandler:()=>La,registerFullScreenHandler:()=>za,returnFocus:()=>Ua,setCurrentFrame:()=>Ha,shareDeepLink:()=>ja,tabs:()=>C});var S={};n.r(S),n.d(S,{isSupported:()=>qc,registerGetLogHandler:()=>$c});var b={};n.r(b),n.d(b,{closeConversation:()=>iu,getChatMembers:()=>au,isSupported:()=>su,openConversation:()=>ou});var E={};n.r(E),n.d(E,{isSupported:()=>du,sendCustomTelemetryData:()=>fu});var A={};n.r(A),n.d(A,{getEligibilityInfo:()=>vu,isSupported:()=>hu});var I={};n.r(I),n.d(I,{ContentItemType:()=>Cu,CopilotMode:()=>Eu,MediaSelectionType:()=>yu,SidePanelErrorCode:()=>Tu,SidePanelErrorImpl:()=>Ou,TeamsContextType:()=>Iu,TeamsDimensionName:()=>bu,TeamsSessionType:()=>Su,TranscriptState:()=>Au,UserConsent:()=>Pu});var P={};n.r(P),n.d(P,{copilotSidePanelNotSupportedOnPlatformError:()=>Uu,getContent:()=>Nu,isResponseAReportableError:()=>Mu,isSupported:()=>ku,preCheckUserConsent:()=>xu,registerUserActionContentSelect:()=>Du});var T={};n.r(T),n.d(T,{closeSidePanel:()=>ju,isSupported:()=>Wu});var O={};n.r(O),n.d(O,{customTelemetry:()=>E,eligibility:()=>A,sidePanel:()=>P,view:()=>T});var R={};n.r(R),n.d(R,{ActionExecuteInvokeRequestType:()=>Ju,ActionExecuteResponseHandler:()=>Xu,InvokeErrorCode:()=>Zu,InvokeResponseType:()=>Qu,OriginalRequestType:()=>Ku,SerializableActionExecuteInvokeRequest:()=>qu,authenticateAndResendRequest:()=>rl,authenticateWithOauth2:()=>al,authenticateWithPowerPlatformConnectorPlugins:()=>sl,authenticateWithSSO:()=>ol,authenticateWithSSOAndResendRequest:()=>il,isActionExecuteResponse:()=>Gu,isInvokeError:()=>Yu,isSupported:()=>cl,validateActionExecuteInvokeRequest:()=>tl});var F={};n.r(F),n.d(F,{authenticateAndResendRequest:()=>pl,authenticateWithOauth:()=>fl,authenticateWithSSO:()=>dl,authenticateWithSSOAndResendRequest:()=>gl,isSupported:()=>ml,validateInput:()=>hl});var k={};n.r(k),n.d(k,{ActionOpenUrlErrorCode:()=>Cl,ActionOpenUrlType:()=>wl,isSupported:()=>bl,processActionOpenUrl:()=>Sl,processActionSubmit:()=>yl});var M={};n.r(M),n.d(M,{isSupported:()=>Tl,processActionOpenUrl:()=>Il,processActionSubmit:()=>Pl});var N={};n.r(N),n.d(N,{SerializableActionOpenUrlDialogInfo:()=>Dl,isSupported:()=>Nl,processActionOpenUrlDialog:()=>Ml});var x={};n.r(x),n.d(x,{isSupported:()=>_l,processActionCommand:()=>Hl});var D={};n.r(D),n.d(D,{CloudStorageProvider:()=>Bl,CloudStorageProviderFileAction:()=>ql,CloudStorageProviderType:()=>Wl,DocumentLibraryAccessType:()=>zl,FileDownloadStatus:()=>$l,SpecialDocumentLibraryType:()=>jl,addCloudStorageFolder:()=>Jl,addCloudStorageProvider:()=>nd,addCloudStorageProviderFile:()=>od,copyMoveFiles:()=>Yl,deleteCloudStorageFolder:()=>Kl,deleteCloudStorageProviderFile:()=>ad,downloadCloudStorageProviderFile:()=>sd,getCloudStorageFolderContents:()=>Ql,getCloudStorageFolders:()=>Gl,getExternalProviders:()=>Xl,getFileDownloads:()=>ed,openCloudStorageFile:()=>Zl,openDownloadFolder:()=>td,registerCloudStorageProviderContentChangeHandler:()=>ld,registerCloudStorageProviderListChangeHandler:()=>ud,removeCloudStorageProvider:()=>rd,renameCloudStorageProviderFile:()=>id,uploadCloudStorageProviderFile:()=>cd});var U={};n.r(U),n.d(U,{getPairedMeetingRoomInfo:()=>pd,isSupported:()=>vd,registerMeetingRoomCapabilitiesUpdateHandler:()=>md,registerMeetingRoomStatesUpdateHandler:()=>hd,sendCommandToPairedMeetingRoom:()=>gd});var L={};n.r(L),n.d(L,{dataLayer:()=>t,isSupported:()=>wd,telemetry:()=>e});var H={};n.r(H),n.d(H,{initialize:()=>Ed,version:()=>Cd});var _={};n.r(_),n.d(_,{isSupported:()=>Md,showNotification:()=>kd});var V={};n.r(V),n.d(V,{isSupported:()=>Ld,notifyInstallCompleted:()=>Ud,registerAppInstallationHandler:()=>xd,unregisterAppInstallationHandler:()=>Dd});var B={};n.r(B),n.d(B,{ControlCommand:()=>_d,ErrorReason:()=>Vd,SessionTerminatedReason:()=>Bd,getCapableParticipants:()=>Wd,isSupported:()=>Qd,registerOnCapableParticipantsChangeHandler:()=>qd,registerOnDeviceStateChangeHandler:()=>Jd,registerOnErrorHandler:()=>Gd,registerOnSessionStatusChangeHandler:()=>Kd,requestControl:()=>jd,sendControlCommand:()=>zd,terminateSession:()=>$d});var W={};n.r(W),n.d(W,{isSupported:()=>Yd,selectAppEntity:()=>Xd});var j={};n.r(j),n.d(j,{getUserJoinedTeams:()=>tf,isSupported:()=>nf});var z={};n.r(z),n.d(z,{getConfigSetting:()=>of,isSupported:()=>af,joinedTeams:()=>j});var $={};n.r($),n.d($,{ChannelType:()=>cf,fullTrust:()=>z,getTeamChannels:()=>uf,isSupported:()=>df,refreshSiteUrl:()=>lf});var q={};n.r(q),n.d(q,{EffectChangeType:()=>Sf,EffectFailureReason:()=>bf,VideoFrameFormat:()=>yf,isSupported:()=>Of,notifySelectedVideoEffectChanged:()=>Af,registerForVideoEffect:()=>If,registerForVideoFrame:()=>Ef});var G={};n.r(G),n.d(G,{ErrorLevel:()=>Xf,frameProcessingTimeoutInMs:()=>Qf,isSupported:()=>ap,notifyFatalError:()=>up,notifySelectedVideoEffectChanged:()=>rp,registerForVideoEffect:()=>op,registerForVideoFrame:()=>Yf,updatePersonalizedEffects:()=>ip});var J={};n.r(J),n.d(J,{addAndConfigure:()=>vp,getAll:()=>wp,isSupported:()=>bp,reconfigure:()=>Cp,remove:()=>Sp,rename:()=>yp});var K={};n.r(K),n.d(K,{AppTypes:()=>Ip,isSupported:()=>Pp,tab:()=>J});var Q={};n.r(Q),n.d(Q,{isSupported:()=>Up,openAppDetail:()=>Np,openFullStore:()=>Mp,openInContextStore:()=>xp,openSpecificStore:()=>Dp});var Z={};n.r(Z),n.d(Z,{DataResidency:()=>Xp,authenticate:()=>zp,getAuthToken:()=>qp,getUser:()=>Jp,notifyFailure:()=>Zp,notifySuccess:()=>Qp,registerAuthenticationHandlers:()=>jp});var X={};n.r(X),n.d(X,{isSupported:()=>Sg,openAppInstallDialog:()=>yg});var Y={};n.r(Y),n.d(Y,{CameraStartMode:()=>Pg,File:()=>kg,FileFormat:()=>Ag,ImageOutputFormats:()=>Fg,ImageUriType:()=>Rg,Media:()=>Ug,MediaControllerEvent:()=>Ig,MediaType:()=>Og,Source:()=>Tg,VideoController:()=>Hg,captureImage:()=>Mg,hasPermission:()=>Ng,requestPermission:()=>xg,scanBarCode:()=>Bg,selectMedia:()=>_g,viewImages:()=>Vg});var ee={};n.r(ee),n.d(ee,{hasPermission:()=>nm,isSupported:()=>om,requestPermission:()=>rm,scanBarCode:()=>tm});var te={};n.r(te),n.d(te,{isSupported:()=>um,openChat:()=>am,openGroupChat:()=>cm});var ne={};n.r(ne),n.d(ne,{isSupported:()=>gm,read:()=>pm,write:()=>fm});var re={};n.r(re),n.d(re,{addNAATrustedOrigins:()=>Pm,canParentManageNAATrustedOrigins:()=>Sm,deleteNAATrustedOrigins:()=>Tm,getParentOrigin:()=>ym,isDeeplyNestedAuthSupported:()=>bm,isNAAChannelRecommended:()=>Cm});var oe={};n.r(oe),n.d(oe,{chooseLocation:()=>Mm,isSupported:()=>xm,showLocation:()=>Nm});var ie={};n.r(ie),n.d(ie,{getCurrentLocation:()=>Um,hasPermission:()=>Lm,isSupported:()=>_m,map:()=>oe,requestPermission:()=>Hm});var ae={};n.r(ae),n.d(ae,{isSupported:()=>qm,open:()=>$m});var se={};n.r(se),n.d(se,{getLocation:()=>Jm,isSupported:()=>Qm,showLocation:()=>Km});var ce={};n.r(ce),n.d(ce,{setOptions:()=>Xm});var ue={};n.r(ue),n.d(ue,{CallType:()=>oh,EventActionSource:()=>ah,MeetingReactionType:()=>nh,MeetingType:()=>rh,SharingProtocol:()=>ih,appShareButton:()=>ce,getAppContentStageSharingCapabilities:()=>vh,getAppContentStageSharingState:()=>Ch,getAuthenticationTokenForAnonymousUser:()=>dh,getIncomingClientAudioState:()=>sh,getLiveStreamState:()=>fh,getMeetingDetails:()=>uh,getMeetingDetailsVerbose:()=>lh,joinMeeting:()=>Eh,registerLiveStreamChangedHandler:()=>mh,registerMeetingReactionReceivedHandler:()=>bh,registerRaiseHandStateChangedHandler:()=>Sh,registerSpeakingStateChangeHandler:()=>yh,requestAppAudioHandling:()=>Ah,requestStartLiveStreaming:()=>ph,requestStopLiveStreaming:()=>gh,shareAppContentToStage:()=>hh,stopSharingAppContentToStage:()=>wh,toggleIncomingClientAudio:()=>ch,updateMicState:()=>Th});var le={};n.r(le),n.d(le,{isSupported:()=>Mh,openPurchaseExperience:()=>kh});var de={};n.r(de),n.d(de,{composeMeeting:()=>Dh,isSupported:()=>Uh,openCalendarItem:()=>xh});var fe={};n.r(fe),n.d(fe,{composeMailWithHandoff:()=>Vh,isSupported:()=>Bh});var pe={};n.r(pe),n.d(pe,{ComposeMailType:()=>Gh,composeMail:()=>$h,handoff:()=>fe,isSupported:()=>qh,openMailItem:()=>zh});var ge={};n.r(ge),n.d(ge,{enablePrintCapability:()=>Kh,isSupported:()=>tv,print:()=>Qh,registerBeforeUnloadHandler:()=>Yh,registerBeforeUnloadHandlerHelper:()=>ev,registerOnLoadHandler:()=>Zh,registerOnLoadHandlerHelper:()=>Xh});var me={};n.r(me),n.d(me,{isSupported:()=>av,selectPeople:()=>ov});var he={};n.r(he),n.d(he,{isSupported:()=>dv,showProfile:()=>lv});var ve={};n.r(ve),n.d(ve,{closeSearch:()=>Cv,isSupported:()=>wv,registerHandlers:()=>hv,unregisterHandlers:()=>vv});var we={};n.r(we),n.d(we,{getContent:()=>bv,isSupported:()=>Ev});var Ce={};n.r(Ce),n.d(Ce,{SharingAPIMessages:()=>Pv,history:()=>we,isSupported:()=>Mv,shareWebContent:()=>Tv});var ye={};n.r(ye),n.d(ye,{close:()=>xv,isSupported:()=>Dv});var Se={};n.r(Se),n.d(Se,{StageViewOpenMode:()=>Lv,isSupported:()=>_v,open:()=>Hv,self:()=>ye});var be={};n.r(be),n.d(be,{captureImages:()=>jv,isSupported:()=>$v,retrieveImages:()=>zv});var Ee={};n.r(Ee),n.d(Ee,{CameraRestriction:()=>Qv,Source:()=>Zv,hasPermission:()=>Xv,image:()=>be,requestPermission:()=>Yv});var Ae={};n.r(Ae),n.d(Ae,{isSupported:()=>aw,isWebStorageClearedOnUserLogOut:()=>ow});var Ie={};n.r(Ie),n.d(Ie,{CallModalities:()=>cw,isSupported:()=>lw,startCall:()=>uw});var Pe={};n.r(Pe),n.d(Pe,{ExpectedFailureReason:()=>bo,FailedReason:()=>So,Messages:()=>yo,notifyAppLoaded:()=>fw,notifyExpectedFailure:()=>mw,notifyFailure:()=>gw,notifySuccess:()=>pw});var Te={};n.r(Te),n.d(Te,{getDragAndDropFiles:()=>Ew,isSupported:()=>Iw});var Oe={};n.r(Oe),n.d(Oe,{getSettings:()=>eC,registerOnRemoveHandler:()=>rC,registerOnSaveHandler:()=>nC,setSettings:()=>tC,setValidityState:()=>Yw});var Re={};n.r(Re),n.d(Re,{getDefaultSizeIfNotProvided:()=>dC,startTask:()=>aC,submitTask:()=>cC,updateTask:()=>sC});var Fe={};n.r(Fe),n.d(Fe,{ContainerState:()=>gC,LiveShareHost:()=>hC,UserMeetingRole:()=>pC,isSupported:()=>mC});var ke,Me,Ne,xe,De,Ue,Le,He,_e,Ve,Be={};function We(e){return void 0!==(null==e?void 0:e.errorCode)}n.r(Be),n.d(Be,{CartStatus:()=>MC,Intent:()=>kC,addOrUpdateCartItems:()=>xC,cartVersion:()=>FC,getCart:()=>NC,isSupported:()=>LC,removeCartItems:()=>DC,updateCartStatus:()=>UC}),function(e){e.Inline="inline",e.Desktop="desktop",e.Web="web"}(ke||(ke={})),function(e){e.M365Content="m365content"}(Me||(Me={})),function(e){e.DriveId="driveId",e.GroupId="groupId",e.SiteId="siteId",e.UserId="userId"}(Ne||(Ne={})),function(e){e[e.NOT_SUPPORTED_ON_PLATFORM=100]="NOT_SUPPORTED_ON_PLATFORM",e[e.INTERNAL_ERROR=500]="INTERNAL_ERROR",e[e.NOT_SUPPORTED_IN_CURRENT_CONTEXT=501]="NOT_SUPPORTED_IN_CURRENT_CONTEXT",e[e.PERMISSION_DENIED=1e3]="PERMISSION_DENIED",e[e.NETWORK_ERROR=2e3]="NETWORK_ERROR",e[e.NO_HW_SUPPORT=3e3]="NO_HW_SUPPORT",e[e.INVALID_ARGUMENTS=4e3]="INVALID_ARGUMENTS",e[e.UNAUTHORIZED_USER_OPERATION=5e3]="UNAUTHORIZED_USER_OPERATION",e[e.INSUFFICIENT_RESOURCES=6e3]="INSUFFICIENT_RESOURCES",e[e.THROTTLE=7e3]="THROTTLE",e[e.USER_ABORT=8e3]="USER_ABORT",e[e.OPERATION_TIMED_OUT=8001]="OPERATION_TIMED_OUT",e[e.OLD_PLATFORM=9e3]="OLD_PLATFORM",e[e.FILE_NOT_FOUND=404]="FILE_NOT_FOUND",e[e.SIZE_EXCEEDED=1e4]="SIZE_EXCEEDED"}(xe||(xe={})),function(e){e.GeoLocation="geolocation",e.Media="media"}(De||(De={})),function(e){e.BCAIS="bcais",e.BCWAF="bcwaf",e.BCWBF="bcwbf"}(Ue||(Ue={})),function(e){e.Faculty="faculty",e.Student="student",e.Other="other"}(Le||(Le={})),function(e){e.Adult="adult",e.MinorNoParentalConsentRequired="minorNoParentalConsentRequired",e.MinorWithoutParentalConsent="minorWithoutParentalConsent",e.MinorWithParentalConsent="minorWithParentalConsent",e.NonAdult="nonAdult"}(He||(He={})),function(e){e.HigherEducation="higherEducation",e.K12="k12",e.Other="other"}(_e||(_e={})),function(e){e.TextPlain="text/plain",e.TextHtml="text/html",e.ImagePNG="image/png",e.ImageJPEG="image/jpeg"}(Ve||(Ve={}));const je=JSON.parse('{"validOrigins":["teams.microsoft.com","teams.microsoft.us","gov.teams.microsoft.us","dod.teams.microsoft.us","int.teams.microsoft.com","outlook.office.com","outlook-sdf.office.com","outlook.office365.com","outlook-sdf.office365.com","outlook.live.com","outlook-sdf.live.com","teams.live.com","local.teams.live.com","local.teams.live.com:8080","local.teams.office.com","local.teams.office.com:8080","devspaces.skype.com","*.www.office.com","www.office.com","word.office.com","excel.office.com","powerpoint.office.com","www.officeppe.com","*.www.microsoft365.com","www.microsoft365.com","bing.com","edgeservices.bing.com","work.bing.com","www.bing.com","www.staging-bing-int.com","*.cloud.microsoft","*.m365.cloud.microsoft","*.outlook.cloud.microsoft","chatuxmanager.svc.cloud.microsoft","copilot.microsoft.com","windows.msn.com","fa000000125.resources.office.net","fa000000129.resources.office.net","fa000000124.resources.office.net","fa000000128.resources.office.net","fa000000136.resources.office.net"]}');const ze="2.0.1",$e="2.0.2",qe="2.0.3",Ge="2.0.4",Je="2.0.1",Ke="1.9.0",Qe="2.0.0",Ze="1.7.0",Xe="1.8.0",Ye="1.9.0",et=n.t(je,2).validOrigins,tt=1500,nt=new URL("https://res.cdn.office.net/teams-js/validDomains/json/validDomains.json"),rt=/^https:\/\//,ot="https",it="teams.microsoft.com",at="The library has not yet been initialized",st="The runtime has not yet been initialized",ct="The runtime version is not supported",ut="The call was not properly started";var lt=n(933);const dt=pt,ft=2147483647;function pt(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return mt(e)}return gt(e,t,n)}function gt(e,t,n){if("string"==typeof e)return Ct(e,t);if(ArrayBuffer.isView(e))return Pt(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(St(e,ArrayBuffer)||e&&St(e.buffer,ArrayBuffer))return Tt(e,t,n);if("undefined"!=typeof SharedArrayBuffer&&(St(e,SharedArrayBuffer)||e&&St(e.buffer,SharedArrayBuffer)))return Tt(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return pt.from(r,t,n);const o=Jt(e);if(o)return o;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return pt.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function mt(e){return ht(e),vt(e<0?0:0|wt(e))}function ht(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function vt(e){if(e>ft)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,pt.prototype),t}function wt(e){if(e>=ft)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+ft.toString(16)+" bytes");return 0|e}function Ct(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!pt.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const n=0|yt(e,t);let r=vt(n);const o=r.write(e,t);return o!==n&&(r=r.slice(0,o)),r}function yt(e,t){if(pt.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||St(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;let o=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return bt(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return Et(e).length;default:if(o)return r?-1:bt(e).length;t=(""+t).toLowerCase(),o=!0}}function St(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function bt(e,t){let n;t=t||1/0;const r=e.length;let o=null;const i=[];for(let a=0;a<r;++a){if(n=e.charCodeAt(a),n>55295&&n<57344){if(!o){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function Et(e){return lt.toByteArray(It(e))}pt.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),pt.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required"),pt.from=function(e,t,n){return gt(e,t,n)},Object.setPrototypeOf(pt.prototype,Uint8Array.prototype),Object.setPrototypeOf(pt,Uint8Array),pt.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},pt.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==pt.prototype};const At=/[^+/0-9A-Za-z-_]/g;function It(e){if((e=(e=e.split("=")[0]).trim().replace(At,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}function Pt(e){if(St(e,Uint8Array)){const t=new Uint8Array(e);return Tt(t.buffer,t.byteOffset,t.byteLength)}return Ot(e)}function Tt(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');let r;return r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(r,pt.prototype),r}function Ot(e){const t=e.length<0?0:0|wt(e.length),n=vt(t);for(let r=0;r<t;r+=1)n[r]=255&e[r];return n}function Rt(e,t,n){n=Math.min(e.length,n);const r=[];let o=t;for(;o<n;){const t=e[o];let i=null,a=t>239?4:t>223?3:t>191?2:1;if(o+a<=n){let n,r,s,c;switch(a){case 1:t<128&&(i=t);break;case 2:n=e[o+1],128==(192&n)&&(c=(31&t)<<6|63&n,c>127&&(i=c));break;case 3:n=e[o+1],r=e[o+2],128==(192&n)&&128==(192&r)&&(c=(15&t)<<12|(63&n)<<6|63&r,c>2047&&(c<55296||c>57343)&&(i=c));break;case 4:n=e[o+1],r=e[o+2],s=e[o+3],128==(192&n)&&128==(192&r)&&128==(192&s)&&(c=(15&t)<<18|(63&n)<<12|(63&r)<<6|63&s,c>65535&&c<1114112&&(i=c))}}null===i?(i=65533,a=1):i>65535&&(i-=65536,r.push(i>>>10&1023|55296),i=56320|1023&i),r.push(i),o+=a}return Mt(r)}function Ft(e,t,n){let r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return Nt(this,t,n);case"utf8":case"utf-8":return Rt(this,t,n);case"ascii":return xt(this,t,n);case"latin1":case"binary":return Dt(this,t,n);case"base64":return Ut(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Lt(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}pt.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?Rt(this,0,e):Ft.apply(this,arguments)};const kt=4096;function Mt(e){const t=e.length;if(t<=kt)return String.fromCharCode.apply(String,e);let n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=kt));return n}function Nt(e,t,n){const r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);let o="";for(let r=t;r<n;++r)o+=Gt[e[r]];return o}function xt(e,t,n){let r="";n=Math.min(e.length,n);for(let o=t;o<n;++o)r+=String.fromCharCode(127&e[o]);return r}function Dt(e,t,n){let r="";n=Math.min(e.length,n);for(let o=t;o<n;++o)r+=String.fromCharCode(e[o]);return r}function Ut(e,t,n){return 0===t&&n===e.length?lt.fromByteArray(e):lt.fromByteArray(e.slice(t,n))}function Lt(e,t,n){const r=e.slice(t,n);let o="";for(let e=0;e<r.length-1;e+=2)o+=String.fromCharCode(r[e]+256*r[e+1]);return o}function Ht(e,t,n,r){n=Number(n)||0;const o=e.length-n;r?(r=Number(r))>o&&(r=o):r=o;const i=t.length;let a;for(r>i/2&&(r=i/2),a=0;a<r;++a){const r=parseInt(t.substr(2*a,2),16);if(qt(r))return a;e[n+a]=r}return a}function _t(e,t,n,r){return $t(bt(t,e.length-n),e,n,r)}function Vt(e,t,n,r){return $t(jt(t),e,n,r)}function Bt(e,t,n,r){return $t(Et(t),e,n,r)}function Wt(e,t,n,r){return $t(zt(t,e.length-n),e,n,r)}function jt(e){const t=[];for(let n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}function zt(e,t){let n,r,o;const i=[];for(let a=0;a<e.length&&!((t-=2)<0);++a)n=e.charCodeAt(a),r=n>>8,o=n%256,i.push(o),i.push(r);return i}function $t(e,t,n,r){let o;for(o=0;o<r&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}function qt(e){return e!=e}pt.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}const o=this.length-t;if((void 0===n||n>o)&&(n=o),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");let i=!1;for(;;)switch(r){case"hex":return Ht(this,e,t,n);case"utf8":case"utf-8":return _t(this,e,t,n);case"ascii":case"latin1":case"binary":return Vt(this,e,t,n);case"base64":return Bt(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Wt(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}};const Gt=function(){const e="0123456789abcdef",t=new Array(256);for(let n=0;n<16;++n){const r=16*n;for(let o=0;o<16;++o)t[r+o]=e[n]+e[o]}return t}();function Jt(e){if(pt.isBuffer(e)){const t=0|wt(e.length),n=vt(t);return 0===n.length||e.copy(n,0,0,t),n}return void 0!==e.length?"number"!=typeof e.length||qt(e.length)?vt(0):Ot(e):"Buffer"===e.type&&Array.isArray(e.data)?Ot(e.data):void 0}const Kt={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let Qt;const Zt=new Uint8Array(16);function Xt(){if(!Qt&&(Qt="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Qt))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Qt(Zt)}const Yt=[];for(let e=0;e<256;++e)Yt.push((e+256).toString(16).slice(1));function en(e,t=0){return Yt[e[t+0]]+Yt[e[t+1]]+Yt[e[t+2]]+Yt[e[t+3]]+"-"+Yt[e[t+4]]+Yt[e[t+5]]+"-"+Yt[e[t+6]]+Yt[e[t+7]]+"-"+Yt[e[t+8]]+Yt[e[t+9]]+"-"+Yt[e[t+10]]+Yt[e[t+11]]+Yt[e[t+12]]+Yt[e[t+13]]+Yt[e[t+14]]+Yt[e[t+15]]}const tn=function(e,t,n){if(Kt.randomUUID&&!t&&!e)return Kt.randomUUID();const r=(e=e||{}).random||(e.rng||Xt)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=r[e];return t}return en(r)},nn=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;const rn=function(e){return"string"==typeof e&&nn.test(e)};var on,an,sn,cn,un,ln,dn,fn;!function(e){e.desktop="desktop",e.web="web",e.android="android",e.ios="ios",e.ipados="ipados",e.macos="macos",e.visionOS="visionOS",e.rigel="rigel",e.surfaceHub="surfaceHub",e.teamsRoomsWindows="teamsRoomsWindows",e.teamsRoomsAndroid="teamsRoomsAndroid",e.teamsPhones="teamsPhones",e.teamsDisplays="teamsDisplays"}(on||(on={})),function(e){e.office="Office",e.outlook="Outlook",e.outlookWin32="OutlookWin32",e.orange="Orange",e.places="Places",e.teams="Teams",e.teamsModern="TeamsModern"}(an||(an={})),function(e){e.settings="settings",e.content="content",e.authentication="authentication",e.remove="remove",e.task="task",e.sidePanel="sidePanel",e.stage="stage",e.meetingStage="meetingStage"}(sn||(sn={})),function(e){e.copilotSidePanel="copilotSidePanel",e.copilotMainPane="copilotMainPane",e.copilotFullScreen="copilotFullScreen"}(cn||(cn={})),function(e){e[e.Standard=0]="Standard",e[e.Edu=1]="Edu",e[e.Class=2]="Class",e[e.Plc=3]="Plc",e[e.Staff=4]="Staff"}(un||(un={})),function(e){e[e.Admin=0]="Admin",e[e.User=1]="User",e[e.Guest=2]="Guest"}(ln||(ln={})),function(e){e.Large="large",e.Medium="medium",e.Small="small"}(dn||(dn={})),function(e){e.Regular="Regular",e.Private="Private",e.Shared="Shared"}(fn||(fn={}));const pn={errorCode:xe.NOT_SUPPORTED_ON_PLATFORM},gn={majorVersion:1,minorVersion:5},mn={adaptiveCardSchemaVersion:{majorVersion:1,minorVersion:5}},hn=new Error("Invalid input count: Must supply a valid image count (limit of 10)."),vn=new Error("Invalid response: Received more images than the specified max limit in the response.");function wn(e){return(t,n)=>{if(!t)throw new Error(e||n)}}function Cn(e,t){if("string"!=typeof e||"string"!=typeof t)return NaN;const n=e.split("."),r=t.split(".");function o(e){return/^\d+$/.test(e)}if(!n.every(o)||!r.every(o))return NaN;for(;n.length<r.length;)n.push("0");for(;r.length<n.length;)r.push("0");for(let e=0;e<n.length;++e)if(Number(n[e])!=Number(r[e]))return Number(n[e])>Number(r[e])?1:-1;return 0}function yn(){return tn()}function Sn(e){return Object.keys(e).forEach((t=>{null!==e[t]&&void 0!==e[t]&&"object"==typeof e[t]&&Sn(e[t])})),Object.freeze(e)}function bn(e,t,...n){const r=e(...n);return r.then((e=>{t&&t(void 0,e)})).catch((e=>{t&&t(e)})),r}function En(e,t,...n){const r=e(...n);return r.then((()=>{t&&t(null)})).catch((e=>{t&&t(e)})),r}function An(e,t,...n){const r=e(...n);return r.then((e=>{t&&t(null,e)})).catch((e=>{t&&t(e,null)})),r}function In(e,t,n){return new Promise(((r,o)=>{const i=setTimeout(o,t,n);e().then((e=>{clearTimeout(i),r(e)})).catch((e=>{clearTimeout(i),o(e)}))}))}function Pn(e){const t=new URL("https://teams.microsoft.com/l/entity/"+encodeURIComponent(e.appId.toString())+"/"+encodeURIComponent(e.pageId));return e.webUrl&&t.searchParams.append("webUrl",e.webUrl.toString()),(e.chatId||e.channelId||e.subPageId)&&t.searchParams.append("context",JSON.stringify({chatId:e.chatId,channelId:e.channelId,subEntityId:e.subPageId})),t.toString()}function Tn(e){return!(Cn(`${e.majorVersion}.${e.minorVersion}`,`${gn.majorVersion}.${gn.minorVersion}`)>=0)}function On(e){return"https:"===e.protocol}function Rn(e,t){return new Promise(((n,r)=>{if(e||r("MimeType cannot be null or empty."),t||r("Base64 string cannot be null or empty."),e.startsWith("image/")){const r=atob(t),o=new Uint8Array(r.length);for(let e=0;e<r.length;e++)o[e]=r.charCodeAt(e);n(new Blob([o],{type:e}))}const o=dt.from(t,"base64").toString();n(new Blob([o],{type:e}))}))}function Fn(e){return new Promise(((t,n)=>{0===e.size&&n(new Error("Blob cannot be empty."));const r=new FileReader;r.onloadend=()=>{r.result?t(r.result.toString().split(",")[1]):n(new Error("Failed to read the blob"))},r.onerror=()=>{n(r.error)},r.readAsDataURL(e)}))}function kn(){if(Mn())throw new Error("window object undefined at SSR check");return window}function Mn(){return"undefined"==typeof window}function Nn(e,t){if(Un(e)||!Ln(e)||!Hn(e))throw t||new Error("id is not valid.")}function xn(e,t){const n=e.toString().toLocaleLowerCase();if(Un(n))throw t||new Error("Invalid Url");if(n.length>2048)throw t||new Error("Url exceeds the maximum size of 2048 characters");if(!On(e))throw t||new Error("Url should be a valid https url")}function Dn(e){const t=document.createElement("a");return t.href=e,new URL(t.href)}function Un(e){return new RegExp(`${/<script[^>]*>|&lt;script[^&]*&gt;|%3Cscript[^%]*%3E/gi.source}|${/<\/script[^>]*>|&lt;\/script[^&]*&gt;|%3C\/script[^%]*%3E/gi.source}`,"gi").test(e)}function Ln(e){return e.length<256&&e.length>4}function Hn(e){for(let t=0;t<e.length;t++){const n=e.charCodeAt(t);if(n<32||n>126)return!1}return!0}function _n(e){if(!e)throw new Error("id must not be empty");if(!1===rn(e))throw new Error("id must be a valid UUID")}const Vn=!!performance&&"now"in performance;function Bn(){return Vn?performance.now()+performance.timeOrigin:void 0}function Wn(e,t=0){if(t>1e3)return!1;if(void 0===e||"boolean"==typeof e||"number"==typeof e||"bigint"==typeof e||"string"==typeof e||null===e)return!0;if(Array.isArray(e))return e.every((e=>Wn(e,t+1)));return!("object"!=typeof e||"[object Object]"!==Object.prototype.toString.call(e)||Object.getPrototypeOf(e)!==Object.prototype&&null!==Object.getPrototypeOf(e))&&Object.keys(e).every((n=>Wn(e[n],t+1)))}class jn{constructor(e=yn()){this.uuid=e,_n(e)}toString(){return this.uuid}serialize(){return this.toString()}}function zn(e){if(!(e instanceof jn))throw new Error(`Potential id (${JSON.stringify(e)}) is invalid; it is not an instance of UUID class.`)}class $n{}$n.initializeCalled=!1,$n.initializeCompleted=!1,$n.additionalValidOrigins=[],$n.initializePromise=void 0,$n.isFramelessWindow=!1,$n.frameContext=void 0,$n.hostClientType=void 0,$n.printCapabilityEnabled=!1,$n.teamsJsInstanceId=(new jn).toString();var qn=n(815);const Gn=new jn,Jn=qn.debug.formatArgs;qn.debug.formatArgs=function(e){e[0]=`(${(new Date).toISOString()}): ${e[0]} [${Gn.toString()}]`,Jn.call(this,e)};const Kn=(0,qn.debug)("teamsJs");function Qn(e){return Kn.extend(e)}function Zn(e,t){return`${e}_${t}`}function Xn(e){return/^v\d+_[\w.]+$/.test(e)}var Yn=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};const er=Qn("runtime"),tr=4;function nr(e){return e.apiVersion===tr}const rr={apiVersion:-1,supports:{}};function or(e){if(nr(e))return!0;throw-1===e.apiVersion?new Error(st):new Error(ct)}let ir=rr;const ar={apiVersion:4,isNAAChannelRecommended:!1,isDeeplyNestedAuthSupported:!1,hostVersionsInfo:mn,isLegacyTeams:!0,supports:{appInstallDialog:{},appEntity:{},call:{},chat:{},conversations:{},dialog:{card:{bot:{}},url:{bot:{},parentCommunication:{}},update:{}},interactive:{},logs:{},meetingRoom:{},menus:{},monetization:{},notifications:{},pages:{config:{},backStack:{},fullTrust:{}},remoteCamera:{},teams:{fullTrust:{}},teamsCore:{},video:{sharedFrame:{}}}},sr=[on.desktop,on.web,on.rigel,on.surfaceHub,on.teamsRoomsWindows,on.teamsRoomsAndroid,on.teamsPhones,on.teamsDisplays],cr=[on.android,on.ios,on.ipados,on.visionOS],ur=[...sr,...cr];function lr(e){let t=e;if(t.apiVersion<tr&&dr.forEach((e=>{t.apiVersion===e.versionToUpgradeFrom&&(t=e.upgradeToNextVersion(t))})),nr(t))return t;throw new Error("Received a runtime that could not be upgraded to the latest version")}const dr=[{versionToUpgradeFrom:1,upgradeToNextVersion:e=>{var t;return{apiVersion:2,hostVersionsInfo:void 0,isLegacyTeams:e.isLegacyTeams,supports:Object.assign(Object.assign({},e.supports),{dialog:e.supports.dialog?{card:void 0,url:e.supports.dialog,update:null===(t=e.supports.dialog)||void 0===t?void 0:t.update}:void 0})}}},{versionToUpgradeFrom:2,upgradeToNextVersion:e=>{const t=e.supports,{appNotification:n}=t,r=Yn(t,["appNotification"]);return Object.assign(Object.assign({},e),{apiVersion:3,supports:r})}},{versionToUpgradeFrom:3,upgradeToNextVersion:e=>{var t,n,r,o,i;return{apiVersion:4,hostVersionsInfo:e.hostVersionsInfo,isNAAChannelRecommended:e.isNAAChannelRecommended,isLegacyTeams:e.isLegacyTeams,supports:Object.assign(Object.assign({},e.supports),{dialog:e.supports.dialog?{card:null===(t=e.supports.dialog)||void 0===t?void 0:t.card,url:{bot:null===(r=null===(n=e.supports.dialog)||void 0===n?void 0:n.url)||void 0===r?void 0:r.bot,parentCommunication:(null===(o=e.supports.dialog)||void 0===o?void 0:o.url)?{}:void 0},update:null===(i=e.supports.dialog)||void 0===i?void 0:i.update}:void 0})}}}],fr="2.1.2",pr={"1.0.0":[{capability:{pages:{appButton:{},tabs:{}},stageView:{}},hostClientTypes:sr}],"1.9.0":[{capability:{location:{}},hostClientTypes:ur}],"2.0.0":[{capability:{people:{}},hostClientTypes:ur},{capability:{sharing:{}},hostClientTypes:[on.desktop,on.web]}],"2.0.1":[{capability:{teams:{fullTrust:{joinedTeams:{}}}},hostClientTypes:[on.android,on.desktop,on.ios,on.teamsRoomsAndroid,on.teamsPhones,on.teamsDisplays,on.web]},{capability:{webStorage:{}},hostClientTypes:[on.desktop]}],"2.0.5":[{capability:{webStorage:{}},hostClientTypes:[on.android,on.ios]}],"2.0.8":[{capability:{sharing:{}},hostClientTypes:[on.android,on.ios]}],"2.1.1":[{capability:{nestedAppAuth:{}},hostClientTypes:[on.android,on.ios,on.ipados,on.visionOS]}],"2.1.2":[]},gr=er.extend("generateBackCompatRuntimeConfig");function mr(e,t){const n=Object.assign({},e);for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&("object"!=typeof t[r]||Array.isArray(t[r])?r in e||(n[r]=t[r]):n[r]=mr(e[r]||{},t[r]));return n}function hr(e,t,n){gr("generating back compat runtime config for %s",e);let r=Object.assign({},t.supports);gr("Supported capabilities in config before updating based on highestSupportedVersion: %o",r),Object.keys(n).forEach((t=>{Cn(e,t)>=0&&n[t].forEach((e=>{void 0!==$n.hostClientType&&e.hostClientTypes.includes($n.hostClientType)&&(r=mr(r,e.capability))}))}));const o={apiVersion:tr,hostVersionsInfo:mn,isLegacyTeams:!0,supports:r};return gr("Runtime config after updating based on highestSupportedVersion: %o",o),o}const vr=er.extend("applyRuntimeConfig");function wr(e){"string"==typeof e.apiVersion&&(vr("Trying to apply runtime with string apiVersion, processing as v1: %o",e),e=Object.assign(Object.assign({},e),{apiVersion:1})),vr("Fast-forwarding runtime %o",e);const t=lr(e);vr("Applying runtime %o",t),ir=Sn(t)}function Cr(e){return null!=e&&void 0!==e.serialize&&"function"==typeof e.serialize}const yr="2.41.0",Sr={childProxyingCommunication:!1};function br(){Sr.childProxyingCommunication=!0}function Er(){return Sr.childProxyingCommunication}let Ar={disableEnforceOriginMatchForChildResponses:!1};function Ir(){return Ar}function Pr(e){Ar=e}function Tr(e){return Pr(Object.assign(Object.assign({},Ar),e)),Ir()}var Or=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};const Rr=e=>{const{uuid:t}=e,n=Or(e,["uuid"]),r=null==t?void 0:t.toString();return Object.assign(Object.assign({},n),{uuidAsString:r})},Fr=e=>{const{uuidAsString:t}=e,n=Or(e,["uuidAsString"]);return Object.assign(Object.assign({},n),{uuid:t?new jn(t):void 0})},kr=e=>{const{uuidAsString:t}=e,n=Or(e,["uuidAsString"]);return Object.assign(Object.assign({},n),{uuid:t?new jn(t):void 0})},Mr=e=>{const{uuid:t}=e,n=Or(e,["uuid"]),r=null==t?void 0:t.toString();return Object.assign(Object.assign({},n),{uuidAsString:r})};function Nr(e){return void 0!==e.uuidAsString?`${e.uuidAsString} (legacy id: ${e.id})`:void 0!==e.uuid?`${e.uuid.toString()} (legacy id: ${e.id})`:`legacy id: ${e.id} (no uuid)`}const xr=Qn("flushMessageQueue");function Dr(e,t,n,r){if(e&&t&&0!==n.length)for(;n.length>0;){const o=n.shift();if(o){const n=Rr(o);xr("Flushing message %s from %s message queue via postMessage.",Nr(n),r),e.postMessage(n,t)}}}const Ur=Qn("internal"),Lr=Ur.extend("ensureInitializeCalled"),Hr=Ur.extend("ensureInitialized");function _r(){if(!$n.initializeCalled)throw Lr(at),new Error(at)}function Vr(e,...t){if(!$n.initializeCompleted)throw Hr("%s. initializeCalled: %s",at,$n.initializeCalled.toString()),new Error(at);if(t&&t.length>0){let e=!1;for(let n=0;n<t.length;n++)if(t[n]===$n.frameContext){e=!0;break}if(!e)throw new Error(`This call is only allowed in following contexts: ${JSON.stringify(t)}. Current context: "${$n.frameContext}".`)}return or(e)}function Br(e=ze){const t=Cn($n.clientSupportedSDKVersion,e);return!isNaN(t)&&t>=0}function Wr(){return $n.hostClientType==on.android||$n.hostClientType==on.ios||$n.hostClientType==on.ipados||$n.hostClientType==on.visionOS}function jr(e=ze){if(!Wr()){throw{errorCode:xe.NOT_SUPPORTED_ON_PLATFORM}}if(!Br(e)){throw{errorCode:xe.OLD_PLATFORM}}}function zr(e){let t=$n.additionalValidOrigins.concat(e.filter((e=>"string"==typeof e&&rt.test(e))));const n={};t=t.filter((e=>!n[e]&&(n[e]=!0,!0))),$n.additionalValidOrigins=t}function $r(e){if(!Kr(e))throw new Error(`Potential app id (${e}) is invalid; its length ${e.length} is not within the length limits (${Gr}-${Jr}).`)}function qr(e){if(Un(e))throw new Error(`Potential app id (${e}) is invalid; it contains script tags.`);if(Qr(e))throw new Error(`Potential app id (${e}) is invalid; it contains non-printable characters.`)}const Gr=4,Jr=256;function Kr(e){return e.length<Jr&&e.length>Gr}function Qr(e){return[...e].some((e=>{const t=e.charCodeAt(0);return t<32||t>126}))}function Zr(e){if(!(e instanceof Yr))throw new Error(`Potential app id (${e}) is invalid; it is not an instance of AppId class.`)}class Xr{constructor(e){this.idAsString=e,qr(e)}serialize(){return this.toString()}toString(){return this.idAsString}}class Yr extends Xr{constructor(e){super(e),$r(e)}toJSON(){return{appIdAsString:this.toString()}}}function eo(e){return null==e}var to=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};let no;const ro="v1",oo=Qn("messageChannels.telemetry");function io(){return to(this,void 0,void 0,(function*(){if(no)return oo("Returning telemetry port from cache"),no;if(!ao())throw pn;return no=yield gc(Zn(ro,"messageChannels.telemetry.getTelemetryPort"),"messageChannels.telemetry.getTelemetryPort"),no}))}function ao(){var e;return!(!Vr(ir)||!(null===(e=ir.supports.messageChannels)||void 0===e?void 0:e.telemetry))}function so(){no=void 0}var co=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};let uo;const lo="v1",fo=Qn("messageChannels.dataLayer");function po(){return co(this,void 0,void 0,(function*(){if(uo)return fo("Returning dataLayer port from cache"),uo;if(!go())throw pn;return uo=yield gc(Zn(lo,"messageChannels.dataLayer.getDataLayerPort"),"messageChannels.dataLayer.getDataLayerPort"),uo}))}function go(){var e;return!(!Vr(ir)||!(null===(e=ir.supports.messageChannels)||void 0===e?void 0:e.dataLayer))}function mo(){uo=void 0}function ho(e){if(!e)throw new Error("[app.lifecycle.registerBeforeSuspendOrTerminateHandler] Handler cannot be null");Vr(ir),ks(e)}function vo(e){if(!e)throw new Error("[app.lifecycle.registerOnResumeHandler] Handler cannot be null");Vr(ir),Ms(e)}const wo="v2",Co=Qn("app"),yo={AppLoaded:"appInitialization.appLoaded",Success:"appInitialization.success",Failure:"appInitialization.failure",ExpectedFailure:"appInitialization.expectedFailure"};var So,bo;function Eo(){return $n.initializeCompleted}function Ao(){return $n.frameContext}function Io(e){return Gi(Zn(wo,"app.initialize"),e)}function Po(e){nc.currentWindow=e}function To(){$n.initializeCalled&&(ms(),$n.initializeCalled=!1,$n.initializeCompleted=!1,$n.initializePromise=void 0,$n.additionalValidOrigins=[],$n.frameContext=void 0,$n.hostClientType=void 0,$n.isFramelessWindow=!1,so(),mo(),ic())}function Oo(){return new Promise((e=>{_r(),e(ac(Zn(wo,"app.getContext"),"getContext"))})).then((e=>Uo(e)))}function Ro(){_r(),Ji(Zn(wo,"app.notifyAppLoaded"))}function Fo(){return Zi(Zn(wo,"app.notifySuccess"))}function ko(e){_r(),Qi(Zn(wo,"app.notifyFailure"),e)}function Mo(e){_r(),Ki(Zn(wo,"app.notifyExpectedFailure"),e)}function No(e){na(Zn(wo,"app.registerOnThemeChangeHandler"),e)}function xo(e){As(e)}function Do(e){return ra(Zn(wo,"app.openLink"),e)}function Uo(e){var t;return{actionInfo:e.actionInfo,app:{locale:e.locale,sessionId:e.appSessionId?e.appSessionId:"",theme:e.theme?e.theme:"default",iconPositionVertical:e.appIconPosition,osLocaleInfo:e.osLocaleInfo,parentMessageId:e.parentMessageId,userClickTime:e.userClickTime,userClickTimeV2:e.userClickTimeV2,userFileOpenPreference:e.userFileOpenPreference,host:{name:e.hostName?e.hostName:an.teams,clientType:e.hostClientType?e.hostClientType:on.web,sessionId:e.sessionId?e.sessionId:"",ringId:e.ringId},appLaunchId:e.appLaunchId,appId:e.appId?new Yr(e.appId):void 0,manifestVersion:e.manifestVersion},page:{id:e.entityId,frameContext:e.frameContext?e.frameContext:$n.frameContext,renderingSurface:e.renderingSurface?e.renderingSurface:void 0,subPageId:e.subEntityId,isFullScreen:e.isFullScreen,isMultiWindow:e.isMultiWindow,isBackgroundLoad:e.isBackgroundLoad,sourceOrigin:e.sourceOrigin},user:{id:null!==(t=e.userObjectId)&&void 0!==t?t:"",displayName:e.userDisplayName,isCallingAllowed:e.isCallingAllowed,isPSTNCallingAllowed:e.isPSTNCallingAllowed,licenseType:e.userLicenseType,loginHint:e.loginHint,userPrincipalName:e.userPrincipalName,tenant:e.tid?{id:e.tid,teamsSku:e.tenantSKU}:void 0},channel:e.channelId?{id:e.channelId,displayName:e.channelName,relativeUrl:e.channelRelativeUrl,membershipType:e.channelType,defaultOneNoteSectionId:e.defaultOneNoteSectionId,ownerGroupId:e.hostTeamGroupId,ownerTenantId:e.hostTeamTenantId}:void 0,chat:e.chatId?{id:e.chatId}:void 0,meeting:e.meetingId?{id:e.meetingId}:void 0,sharepoint:e.sharepoint,team:e.teamId?{internalId:e.teamId,displayName:e.teamName,type:e.teamType,groupId:e.groupId,templateId:e.teamTemplateId,isArchived:e.isTeamArchived,userRole:e.userTeamRole}:void 0,sharePointSite:e.teamSiteUrl||e.teamSiteDomain||e.teamSitePath||e.mySitePath||e.mySiteDomain?{teamSiteUrl:e.teamSiteUrl,teamSiteDomain:e.teamSiteDomain,teamSitePath:e.teamSitePath,teamSiteId:e.teamSiteId,mySitePath:e.mySitePath,mySiteDomain:e.mySiteDomain}:void 0,dialogParameters:e.dialogParameters||{}}}function Lo(e){Xo(Zn(Qo,"dialog.update.resize"),e)}function Ho(){return!(!Vr(ir)||!ir.supports.dialog)&&!!ir.supports.dialog.update}function _o(e,t,n){ei(Zn(Qo,"dialog.url.bot.open"),e,t,n)}function Vo(){return Vr(ir)&&void 0!==(ir.supports.dialog&&ir.supports.dialog.url&&ir.supports.dialog.url.bot)}function Bo(e){if(Vr(ir,sn.task),!zo())throw pn;vc(Zn(Qo,"dialog.url.parentCommunication.sendMessageToParentFromDialog"),"messageForParent",[e])}function Wo(e){if(Vr(ir,sn.content,sn.sidePanel,sn.meetingStage),!zo())throw pn;vc(Zn(Qo,"dialog.url.parentCommunication.sendMessageToDialog"),"messageForChild",[e])}function jo(e){if(Vr(ir,sn.task),!zo())throw pn;for(Cs("messageForChild"),ws(Zn(Qo,"dialog.url.parentCommunication.registerMessageForChildHandler"),"messageForChild",e),oi.reverse();oi.length>0;){e(oi.pop())}}function zo(){var e,t;return Vr(ir)&&!!(null===(t=null===(e=ir.supports.dialog)||void 0===e?void 0:e.url)||void 0===t?void 0:t.parentCommunication)}function $o(e,t,n){Yo(Zn(Qo,"dialog.url.open"),e,t,n)}function qo(e,t){ti(Zn(Qo,"dialog.url.submit"),e,t)}function Go(){return Vr(ir)&&void 0!==(ir.supports.dialog&&ir.supports.dialog.url)}function Jo(e){return{url:e.url,height:e.size?e.size.height:dn.Small,width:e.size?e.size.width:dn.Small,title:e.title,fallbackUrl:e.fallbackUrl}}function Ko(e){const t=Jo(e);return t.completionBotId=e.completionBotId,t}!function(e){e.AuthFailed="AuthFailed",e.Timeout="Timeout",e.Other="Other"}(So||(So={})),function(e){e.PermissionError="PermissionError",e.NotFound="NotFound",e.Throttling="Throttling",e.Offline="Offline",e.Other="Other"}(bo||(bo={})),Co("teamsjs instance is version %s, starting at %s UTC (%s local)",yr,(new Date).toISOString(),(new Date).toLocaleString()),function(){if(Mn())return;const e=document.getElementsByTagName("script"),t=e&&e[e.length-1]&&e[e.length-1].src,n="Today, teamsjs can only be used from a single script or you may see undefined behavior. This log line is used to help detect cases where teamsjs is loaded multiple times -- it is always written. The presence of the log itself does not indicate a multi-load situation, but multiples of these log lines will. If you would like to use teamjs from more than one script at the same time, please open an issue at https://github.com/OfficeDev/microsoft-teams-library-js/issues";t&&0!==t.length?Co("teamsjs is being used from %s. %s",t,n):Co("teamsjs is being used from a script tag embedded directly in your html. %s",n)}();const Qo="v2",Zo="dialog.submit should not be called from FrameContext.content.\nIf dialog.submit was called from inside the dialog, please disregard this message.\nThis issue occurs due to a bug in Teams mobile where the dialog is incorrectly identified as being in the content FrameContext.\nWe are working to resolve this.";function Xo(e,t){if(Vr(ir,sn.content,sn.sidePanel,sn.task,sn.meetingStage),!Ho())throw pn;vc(e,"tasks.updateTask",[t])}function Yo(e,t,n,r){if(Vr(ir,sn.content,sn.sidePanel,sn.meetingStage),!Go())throw pn;r&&ws(Zn(Qo,"dialog.url.registerMessageForParentHandler"),"messageForParent",r);vc(e,"tasks.startTask",[Jo(t)],((e,t)=>{null==n||n({err:e,result:t}),Cs("messageForParent")}))}function ei(e,t,n,r){if(Vr(ir,sn.content,sn.sidePanel,sn.meetingStage),!Vo())throw pn;r&&ws(Zn(Qo,"dialog.url.bot.registerMessageForParentHandler"),"messageForParent",r);vc(e,"tasks.startTask",[Ko(t)],((e,t)=>{null==n||n({err:e,result:t}),Cs("messageForParent")}))}function ti(e,t,n){if(Vr(ir,sn.content,sn.task),!Go())throw pn;$n.frameContext===sn.content&&console.warn(Zo),vc(e,"tasks.completeTask",[t,n?Array.isArray(n)?n:[n]:[]])}function ni(e){return{card:e.card,height:e.size?e.size.height:dn.Small,width:e.size?e.size.width:dn.Small,title:e.title}}function ri(e){const t=ni(e);return t.completionBotId=e.completionBotId,t}const oi=[];function ii(e){$n.frameContext&&($n.frameContext===sn.task?oi.push(e):Cs("messageForChild"))}function ai(e,t){if(Vr(ir,sn.content,sn.sidePanel,sn.meetingStage),!si())throw pn;const n=ri(e);vc(Zn(Qo,"dialog.adaptiveCard.bot.open"),"tasks.startTask",[n],((e,n)=>{null==t||t({err:e,result:n})}))}function si(){const e=ir.hostVersionsInfo&&ir.hostVersionsInfo.adaptiveCardSchemaVersion&&!Tn(ir.hostVersionsInfo.adaptiveCardSchemaVersion);return Vr(ir)&&void 0!==(e&&ir.supports.dialog&&ir.supports.dialog.card&&ir.supports.dialog.card.bot)}function ci(e,t){if(Vr(ir,sn.content,sn.sidePanel,sn.meetingStage),!ui())throw pn;const n=ni(e);vc(Zn(Qo,"dialog.adaptiveCard.open"),"tasks.startTask",[n],((e,n)=>{null==t||t({err:e,result:n})}))}function ui(){const e=ir.hostVersionsInfo&&ir.hostVersionsInfo.adaptiveCardSchemaVersion&&!Tn(ir.hostVersionsInfo.adaptiveCardSchemaVersion);return Vr(ir)&&void 0!==(e&&ir.supports.dialog&&ir.supports.dialog.card)}function li(){ws(Zn(Qo,"dialog.registerMessageForChildHandler"),"messageForChild",ii,!1)}function di(){return!(!Vr(ir)||!ir.supports.dialog)}const fi="v2";var pi,gi;!function(e){e[e.ifRoom=0]="ifRoom",e[e.overflowOnly=1]="overflowOnly"}(pi||(pi={}));class mi{constructor(){this.enabled=!0,this.selected=!1}}let hi,vi,wi,Ci,yi;function Si(){ws(Zn(fi,"menus.registerNavBarMenuItemPressHandler"),"navBarMenuItemPress",Ii,!1),ws(Zn(fi,"menus.registerActionMenuItemPressHandler"),"actionMenuItemPress",Ti,!1),ws(Zn(fi,"menus.registerSetModuleViewHandler"),"setModuleView",Ei,!1)}function bi(e,t){if(Vr(ir),!Oi())throw pn;wi=t,vc(Zn(fi,"menus.setUpViews"),"setUpViews",[e])}function Ei(e){wi&&wi(e)||(Vr(ir),vc(Zn(fi,"menus.handleViewConfigItemPress"),"viewConfigItemPress",[e]))}function Ai(e,t){if(Vr(ir),!Oi())throw pn;hi=t,vc(Zn(fi,"menus.setNavBarMenu"),"setNavBarMenu",[e])}function Ii(e){hi&&hi(e)||(Vr(ir),vc(Zn(fi,"menus.handleNavBarMenuItemPress"),"handleNavBarMenuItemPress",[e]))}function Pi(e,t){if(Vr(ir),!Oi())throw pn;vi=t,vc(Zn(fi,"menus.showActionMenu"),"showActionMenu",[e])}function Ti(e){vi&&vi(e)||(Vr(ir),vc(Zn(fi,"menus.handleActionMenuItemPress"),"handleActionMenuItemPress",[e]))}function Oi(){return!(!Vr(ir)||!ir.supports.menus)}function Ri(){ws(Zn(qa,"pages.config.registerSettingsSaveHandler"),"settings.save",Ui,!1),ws(Zn(qa,"pages.config.registerSettingsRemoveHandler"),"settings.remove",_i,!1)}function Fi(e){return ts(Zn(qa,"pages.config.setValidityState"),e)}function ki(e){return rs(Zn(qa,"pages.config.setConfig"),e)}function Mi(e){Ni(Zn(qa,"pages.config.registerOnSaveHandler"),e,(()=>{if(!eo(e)&&!Bi())throw pn}))}function Ni(e,t,n){!eo(t)&&Vr(ir,sn.settings),n&&n(),Ci=t,!eo(t)&&vc(e,"registerHandler",["save"])}function xi(e){Di(Zn(qa,"pages.config.registerOnRemoveHandler"),e,(()=>{if(!eo(e)&&!Bi())throw pn}))}function Di(e,t,n){!eo(t)&&Vr(ir,sn.remove,sn.settings),n&&n(),yi=t,!eo(t)&&vc(e,"registerHandler",["remove"])}function Ui(e){const t=new Hi(e);Ci?Ci(t):Ls()?zs("settings.save",[e]):t.notifySuccess()}function Li(e){Ss(Zn(qa,"pages.config.registerChangeConfigHandler"),"changeSettings",e,[sn.content],(()=>{if(!Bi())throw pn}))}!function(e){e.dropDown="dropDown",e.popOver="popOver"}(gi||(gi={}));class Hi{constructor(e){this.notified=!1,this.result=e||{}}notifySuccess(){this.ensureNotNotified(),vc(Zn(qa,"pages.saveEvent.notifySuccess"),"settings.save.success"),this.notified=!0}notifyFailure(e){this.ensureNotNotified(),vc(Zn(qa,"pages.saveEvent.notifyFailure"),"settings.save.failure",[e]),this.notified=!0}ensureNotNotified(){if(this.notified)throw new Error("The SaveEvent may only notify success or failure once.")}}function _i(){const e=new Vi;yi?yi(e):Ls()?zs("settings.remove",[]):e.notifySuccess()}class Vi{constructor(){this.notified=!1}notifySuccess(){this.ensureNotNotified(),vc(Zn(qa,"pages.removeEvent.notifySuccess"),"settings.remove.success"),this.notified=!0}notifyFailure(e){this.ensureNotNotified(),vc(Zn(qa,"pages.removeEvent.notifyFailure"),"settings.remove.failure",[e]),this.notified=!0}ensureNotNotified(){if(this.notified)throw new Error("The removeEventType may only notify success or failure once.")}}function Bi(){return!(!Vr(ir)||!ir.supports.pages)&&!!ir.supports.pages.config}class Wi{}class ji extends Wi{validate(e){return!0}deserialize(e){return e}}var zi=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const $i=6e4,qi=Qn("app");function Gi(e,t){if(Mn()){return qi.extend("initialize")("window object undefined at initialization"),Promise.resolve()}return In((()=>ta(e,t)),$i,new Error("SDK initialization timed out."))}function Ji(e){vc(e,yo.AppLoaded,[yr])}function Ki(e,t){vc(e,yo.ExpectedFailure,[t.reason,t.message])}function Qi(e,t){vc(e,yo.Failure,[t.reason,t.message])}function Zi(e){return zi(this,void 0,void 0,(function*(){if($n.initializeCompleted)return Yi(e);if(!$n.initializePromise)throw new Error(at);return $n.initializePromise.then((()=>Yi(e)))}))}function Xi(){var e;return Vr(ir)&&!!(null===(e=ir.supports.app)||void 0===e?void 0:e.notifySuccessResponse)}function Yi(e){return zi(this,void 0,void 0,(function*(){return Xi()?fc(yo.Success,[yr],new ji,e).then((()=>({hasFinishedSuccessfully:!0}))):(vc(e,yo.Success,[yr]),{hasFinishedSuccessfully:"unknown"})}))}const ea=qi.extend("initializeHelper");function ta(e,t){return new Promise((n=>{$n.initializeCalled||($n.initializeCalled=!0,gs(),$n.initializePromise=oc(t,e).then((({context:e,clientType:t,runtimeConfig:n,clientSupportedSDKVersion:r=ze})=>{$n.frameContext=e,$n.hostClientType=t,$n.clientSupportedSDKVersion=r;try{ea("Parsing %s",n);const e=JSON.parse(n);if(ea("Checking if %o is a valid runtime object",null!=e?e:"null"),!e||!e.apiVersion)throw new Error("Received runtime config is invalid");n&&wr(e)}catch(e){if(!(e instanceof SyntaxError))throw e;try{ea("Attempting to parse %s as an SDK version",n),isNaN(Cn(n,ze))||($n.clientSupportedSDKVersion=n);const e=JSON.parse(r);if(ea("givenRuntimeConfig parsed to %o",null!=e?e:"null"),!e)throw new Error("givenRuntimeConfig string was successfully parsed. However, it parsed to value of null");wr(e)}catch(e){if(!(e instanceof SyntaxError))throw e;wr(hr($n.clientSupportedSDKVersion,ar,pr))}}$n.initializeCompleted=!0})),Si(),Ri(),li()),Array.isArray(t)&&zr(t),void 0!==$n.initializePromise?n($n.initializePromise):ea("GlobalVars.initializePromise is unexpectedly undefined")}))}function na(e,t){!eo(t)&&_r(),bs(e,t)}function ra(e,t){return new Promise((n=>{Vr(ir,sn.content,sn.sidePanel,sn.settings,sn.task,sn.stage,sn.meetingStage),n(sc(e,"executeDeepLink",t))}))}var oa=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};let ia=[];const aa=Qn("validateOrigin");let sa;function ca(){return oa(this,void 0,void 0,(function*(){sa||(yield la())}))}function ua(){return 0===ia.length}function la(e=!1){return oa(this,void 0,void 0,(function*(){if(!ua()&&!e)return ia;if(sa)return sa;if(Mn())return ia=et,et;{aa("Initiating fetch call to acquire valid origins list from CDN");const e=new AbortController,t=setTimeout((()=>e.abort()),tt);return sa=fetch(nt,{signal:e.signal}).then((e=>{if(clearTimeout(t),!e.ok)throw new Error("Invalid Response from Fetch Call");return aa("Fetch call completed and retrieved valid origins list from CDN"),e.json().then((e=>{if(da(JSON.stringify(e)))return ia=e.validOrigins,ia;throw new Error("Valid origins list retrieved from CDN is invalid")}))})).catch((e=>("AbortError"===e.name?aa(`validOrigins fetch call to CDN failed due to Timeout of ${tt} ms. Defaulting to fallback list`):aa("validOrigins fetch call to CDN failed with error: %s. Defaulting to fallback list",e),ia=et,ia))),sa}}))}function da(e){let t=JSON.parse(e);try{t=JSON.parse(e)}catch(e){return!1}if(!t.validOrigins)return!1;for(const e of t.validOrigins)try{new URL("https://"+e)}catch(t){return aa("isValidOriginsFromCDN call failed to validate origin: %s",e),!1}return!0}function fa(e,t){if("*."===e.substring(0,2)){const n=e.substring(1);if(t.length>n.length&&t.split(".").length===n.split(".").length&&t.substring(t.length-n.length)===n)return!0}else if(e===t)return!0;return!1}function pa(e,t){const n=t||ua()?et:ia;return ga(e,n)?Promise.resolve(!0):(aa("Origin %s is not in the local valid origins list, fetching from CDN",e),la(t).then((t=>ga(e,t))))}function ga(e,t){if(!On(e))return aa("Origin %s is invalid because it is not using https protocol. Protocol being used: %s",e,e.protocol),!1;const n=e.host;if(t.some((e=>fa(e,n))))return!0;for(const e of $n.additionalValidOrigins){if(fa("https://"===e.substring(0,8)?e.substring(8):e,n))return!0}return aa("Origin %s is invalid because it is not an origin approved by this library or included in the call to app.initialize.\nOrigins approved by this library: %o\nOrigins included in app.initialize: %o",e,t,$n.additionalValidOrigins),!1}function ma(e){Ss(Zn(qa,"pages.appButton.onClick"),"appButtonClick",e,[sn.content],(()=>{if(!wa())throw pn}))}function ha(e){Ss(Zn(qa,"pages.appButton.onHoverEnter"),"appButtonHoverEnter",e,[sn.content],(()=>{if(!wa())throw pn}))}function va(e){Ss(Zn(qa,"pages.appButton.onHoverLeave"),"appButtonHoverLeave",e,[sn.content],(()=>{if(!wa())throw pn}))}function wa(){return!(!Vr(ir)||!ir.supports.pages)&&!!ir.supports.pages.appButton}function Ca(){us()}function ya(){return Ja(Zn(qa,"pages.backStack.navigateBack"))}function Sa(e){ba(Zn(qa,"pages.backStack.registerBackButtonHandler"),e,(()=>{if(!eo(e)&&!Ea())throw pn}))}function ba(e,t,n){!eo(t)&&Vr(ir),n&&n(),cs(t),!eo(t)&&vc(e,"registerHandler",["backButton"])}function Ea(){return!(!Vr(ir)||!ir.supports.pages)&&!!ir.supports.pages.backStack}function Aa(e){return new Promise((t=>{if(Vr(ir,sn.content,sn.sidePanel,sn.settings,sn.task,sn.stage,sn.meetingStage),!Pa())throw pn;t(uc(Zn(qa,"pages.currentApp.navigateTo"),"pages.currentApp.navigateTo",e))}))}function Ia(){return new Promise((e=>{if(Vr(ir,sn.content,sn.sidePanel,sn.settings,sn.task,sn.stage,sn.meetingStage),!Pa())throw pn;e(uc(Zn(qa,"pages.currentApp.navigateToDefaultPage"),"pages.currentApp.navigateToDefaultPage"))}))}function Pa(){return!(!Vr(ir)||!ir.supports.pages)&&!!ir.supports.pages.currentApp}function Ta(){if(Vr(ir,sn.content),!Ra())throw pn;vc(Zn(qa,"pages.fullTrust.enterFullscreen"),"enterFullscreen",[])}function Oa(){if(Vr(ir,sn.content),!Ra())throw pn;vc(Zn(qa,"pages.fullTrust.exitFullscreen"),"exitFullscreen",[])}function Ra(){return!(!Vr(ir)||!ir.supports.pages)&&!!ir.supports.pages.fullTrust}function Fa(e){return Ka(Zn(qa,"pages.tabs.navigateToTab"),e)}function ka(e){return Za(Zn(qa,"pages.tabs.getTabInstances"),e)}function Ma(e){return Xa(Zn(qa,"pages.tabs.getMruTabInstances"),e)}function Na(){return!(!Vr(ir)||!ir.supports.pages)&&!!ir.supports.pages.tabs}var xa,Da;function Ua(e){const t=Zn(qa,"pages.returnFocus");if(Vr(ir),!$a())throw pn;if(void 0===e&&vc(t,"returnFocus",[!1]),"boolean"==typeof e)vc(t,"returnFocus",[e]);else switch(e){case Da.PreviousLandmark:case Da.GoToActivityFeed:vc(t,"returnFocus",[!1,e]);break;case Da.NextLandmark:vc(t,"returnFocus",[!0,e])}}function La(e){Ss(Zn(qa,"pages.registerFocusEnterHandler"),"focusEnter",e,[],(()=>{if(!$a())throw pn}))}function Ha(e){es(Zn(qa,"pages.setCurrentFrame"),e)}function _a(e,t,n){ca(),Gi(Zn(qa,"pages.initializeWithFrameContext"),n).then((()=>t&&t())),Ha(e)}function Va(){return ns(Zn(qa,"pages.getConfig."))}function Ba(e){return Ga(Zn(qa,"pages.navigateCrossDomain"),e)}function Wa(e){return new Promise((t=>{if(Vr(ir,sn.content,sn.sidePanel,sn.settings,sn.task,sn.stage,sn.meetingStage),!$a())throw pn;const n=Zn(qa,"pages.navigateToApp");if(ir.isLegacyTeams){t(sc(n,"executeDeepLink",Pn(os(e)?e:is(e))))}else{t(sc(n,"pages.navigateToApp",os(e)?as(e):e))}}))}function ja(e){return Ya(Zn(qa,"pages.shareDeepLink"),e)}function za(e){Ss(Zn(qa,"pages.registerFullScreenHandler"),"fullScreenChange",e,[],(()=>{if(!eo(e)&&!$a())throw pn}))}function $a(){return!(!Vr(ir)||!ir.supports.pages)}ca(),function(e){e[e.PreviousLandmark=0]="PreviousLandmark",e[e.NextLandmark=1]="NextLandmark",e[e.Read=2]="Read",e[e.Compose=3]="Compose"}(xa||(xa={})),function(e){e[e.PreviousLandmark=0]="PreviousLandmark",e[e.NextLandmark=1]="NextLandmark",e[e.GoToActivityFeed=2]="GoToActivityFeed"}(Da||(Da={}));const qa="v2";function Ga(e,t){return new Promise((n=>{if(Vr(ir,sn.content,sn.sidePanel,sn.settings,sn.remove,sn.task,sn.stage,sn.meetingStage),!$a())throw pn;n(cc(e,"navigateCrossDomain","Cross-origin navigation is only supported for URLs matching the pattern registered in the manifest.",t))}))}function Ja(e){return new Promise((t=>{if(Vr(ir),!Ea())throw pn;t(cc(e,"navigateBack","Back navigation is not supported in the current client or context."))}))}function Ka(e,t){return new Promise((n=>{if(Vr(ir),!Na())throw pn;n(cc(e,"navigateToTab","Invalid internalTabInstanceId and/or channelId were/was provided",t))}))}function Qa(e,t){if(Vr(ir),!$a())throw pn;vc(e,"returnFocus",[t])}function Za(e,t){return new Promise((n=>{if(Vr(ir),!Na())throw pn;n(ac(e,"getTabInstances",t))}))}function Xa(e,t){return new Promise((n=>{if(Vr(ir),!Na())throw pn;n(ac(e,"getMruTabInstances",t))}))}function Ya(e,t){if(Vr(ir,sn.content,sn.sidePanel,sn.meetingStage),!$a())throw pn;vc(e,"shareDeepLink",[t.subPageId,t.subPageLabel,t.subPageWebUrl])}function es(e,t){if(Vr(ir,sn.content),!$a())throw pn;vc(e,"setFrameContext",[t])}function ts(e,t){if(Vr(ir,sn.settings,sn.remove),!Bi())throw pn;vc(e,"settings.setValidityState",[t])}function ns(e){return new Promise((t=>{if(Vr(ir,sn.content,sn.settings,sn.remove,sn.sidePanel),!$a())throw pn;t(ac(e,"settings.getSettings"))}))}function rs(e,t){return new Promise((n=>{if(Vr(ir,sn.content,sn.settings,sn.sidePanel),!Bi())throw pn;n(sc(e,"settings.setSettings",t))}))}function os(e){return e.appId instanceof Yr}function is(e){return Object.assign(Object.assign({},e),{appId:new Yr(e.appId),webUrl:e.webUrl?new URL(e.webUrl):void 0})}function as(e){return Object.assign(Object.assign({},e),{appId:e.appId.toString(),webUrl:e.webUrl?e.webUrl.toString():void 0})}let ss;function cs(e){ss=e}function us(){ws(Zn(qa,"pages.backStack.registerBackButtonPressHandler"),"backButtonPress",ls,!1)}function ls(){ss&&ss()||(Ls()?zs("backButtonPress",[]):ya())}var ds=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const fs=Qn("handlers");class ps{static initializeHandlers(){ps.handlers.themeChange=Es,ps.handlers.load=Ts,ps.handlers.beforeUnload=Fs,us()}static uninitializeHandlers(){ps.handlers={},ps.themeChangeHandler=null,ps.loadHandler=null,ps.beforeUnloadHandler=null,ps.beforeSuspendOrTerminateHandler=null,ps.resumeHandler=null}}function gs(){ps.initializeHandlers()}function ms(){ps.uninitializeHandlers()}ps.handlers={},ps.themeChangeHandler=null,ps.loadHandler=null,ps.beforeUnloadHandler=null,ps.beforeSuspendOrTerminateHandler=null,ps.resumeHandler=null,ps.hostToAppPerformanceMetricsHandler=null;const hs=fs.extend("callHandler");function vs(e,t){const n=ps.handlers[e];if(n){hs("Invoking the registered handler for message %s with arguments %o",e,t);return[!0,n.apply(this,t)]}return Ls()?(zs(e,t),[!1,void 0]):(hs("Handler for action message %s not found.",e),[!1,void 0])}function ws(e,t,n,r=!0,o=[]){n?(ps.handlers[t]=n,r&&vc(e,"registerHandler",[t,...o])):delete ps.handlers[t]}function Cs(e){delete ps.handlers[e]}function ys(e){return null!=ps.handlers[e]}function Ss(e,t,n,r,o){n&&Vr(ir,...r),o&&o(),ws(e,t,n)}function bs(e,t){ps.themeChangeHandler=t,!eo(t)&&vc(e,"registerHandler",["themeChange"])}function Es(e){ps.themeChangeHandler&&ps.themeChangeHandler(e),Ls()&&zs("themeChange",[e])}function As(e){ps.hostToAppPerformanceMetricsHandler=e}function Is(e){ps.hostToAppPerformanceMetricsHandler&&ps.hostToAppPerformanceMetricsHandler(e)}function Ps(e,t){ps.loadHandler=t,!eo(t)&&vc(e,"registerHandler",["load"])}function Ts(e){const t=Os(e);ps.resumeHandler?(ps.resumeHandler(t),Ls()&&zs("load",[t])):ps.loadHandler&&(ps.loadHandler(e),Ls()&&zs("load",[e]))}function Os(e){return{entityId:e.entityId,contentUrl:new URL(e.contentUrl)}}function Rs(e,t){ps.beforeUnloadHandler=t,!eo(t)&&vc(e,"registerHandler",["beforeUnload"])}function Fs(){return ds(this,void 0,void 0,(function*(){const e=()=>{vc(Zn("v2","handleBeforeUnload"),"readyToUnload",[])};ps.beforeSuspendOrTerminateHandler?(yield ps.beforeSuspendOrTerminateHandler(),Ls()?zs("beforeUnload"):e()):ps.beforeUnloadHandler&&ps.beforeUnloadHandler(e)||(Ls()?zs("beforeUnload"):e())}))}function ks(e){ps.beforeSuspendOrTerminateHandler=e,!eo(e)&&vc(Zn("v2","registerBeforeSuspendOrTerminateHandler"),"registerHandler",["beforeUnload"])}function Ms(e){ps.resumeHandler=e,!eo(e)&&vc(Zn("v2","registerOnResumeHandler"),"registerHandler",["load"])}var Ns=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const xs=Qn("childProxyingCommunication");class Ds{}function Us(){Ds.window=null,Ds.origin=null,Ds.messageQueue=[]}function Ls(){return!!Er()&&!!Ds.window}function Hs(e,t){return!!Er()&&(Ds.window&&!Ds.window.closed&&e!==Ds.window||(Ds.window=e,Ds.origin=t),Ds.window&&Ds.window.closed?(Ds.window=null,Ds.origin=null,!1):Ds.window===e)}function _s(e,t,n,r){return Ns(this,void 0,void 0,(function*(){Ds.window===t&&(Dr(Ds.window,Ds.origin,Ds.messageQueue,"child"),Bs(e,n,r))}))}Ds.messageQueue=[];const Vs=xs.extend("handleIncomingMessageFromChild");function Bs(e,t,n){if(void 0===e.data.id||void 0===e.data.func)return;const r=Fr(e.data),[o,i]=vs(r.func,r.args);if(o&&void 0!==i)return Vs("Handler called in response to message %s from child. Returning response from handler to child, action: %s.",Nr(r),r.func),void js(r.id,r.uuid,Array.isArray(i)?i:[i]);Vs("No handler for message %s from child found; relaying message on to parent, action: %s. Relayed message will have a new id.",Nr(r),r.func),Ws(r,t,n)}function Ws(e,t,n){const r=t(Zn("v2","tasks.startTask"),e.func,e.args,!0,e.teamsJsInstanceId),o=Ds.origin;n(r.uuid,((...t)=>{if(!Ds.window)return;if(!Ir().disableEnforceOriginMatchForChildResponses&&o!==Ds.origin)return void Vs("Origin of child window has changed, not sending response back to child window");const n=t.pop();Vs("Message from parent being relayed to child, id: %s",Nr(e)),js(e.id,e.uuid,t,n)}))}function js(e,t,n,r){const o=Ds.window,i=$s(e,t,n,r),a=Mr(i),s=Ds.origin;o&&s&&(Vs("Sending message %s to %s via postMessage, args = %o",Nr(a),"child",a.args),o.postMessage(a,s))}function zs(e,t){const n=Ds.window,r=qs(e,t),o=Ds.origin;n&&o?n.postMessage(r,o):Ds.messageQueue.push(r)}function $s(e,t,n,r){return{id:e,uuid:t,args:n||[],isPartialResponse:r}}function qs(e,t){return{func:e,args:t||[]}}class Gs{static storeCallbackInformation(e,t){Gs.callbackInformation.set(e,t)}static clearMessages(){Gs.callbackInformation.clear()}static deleteMessageInformation(e){Gs.callbackInformation.delete(e)}static handleOneWayPerformanceMetrics(e,t,n){const r=e.monotonicTimestamp;r&&n?Is({actionName:e.func,messageDelay:n-r,requestStartedAt:r}):t("Unable to send performance metrics for event %s",e.func)}static handlePerformanceMetrics(e,t,n,r){const o=Gs.callbackInformation.get(e);o&&t.monotonicTimestamp&&r?(Is({actionName:o.name,messageDelay:r-t.monotonicTimestamp,requestStartedAt:o.calledAt}),Gs.deleteMessageInformation(e)):n("Unable to send performance metrics for callback %s with arguments %o",e.toString(),t.args)}}Gs.callbackInformation=new Map;const Js=Qn("nestedAppAuthUtils"),Ks=Js.extend("tryPolyfillWithNestedAppAuthBridge"),Qs="v2";function Zs(e,t,n){var r;const o=Ks;if($n.isFramelessWindow)return void o("Cannot polyfill nestedAppAuthBridge as current window is frameless");if(!t)return void o("Cannot polyfill nestedAppAuthBridge as current window does not exist");if(t.parent!==t.top)return void o("Default NAA bridge injection not supported in nested iframe. Use standalone NAA bridge instead.");const i=(()=>{try{return JSON.parse(e)}catch(e){return null}})();if(!i||!(null===(r=i.supports)||void 0===r?void 0:r.nestedAppAuth))return void o("Cannot polyfill nestedAppAuthBridge as current hub does not support nested app auth");const a=t;if(a.nestedAppAuthBridge)return void o("nestedAppAuthBridge already exists on current window, skipping polyfill");const s=Ys(a,n);s&&(a.nestedAppAuthBridge=s)}const Xs=Js.extend("createNestedAppAuthBridge");function Ys(e,t){const n=Xs;if(!e)return n("nestedAppAuthBridge cannot be created as current window does not exist"),null;const{onMessage:r,sendPostMessage:o}=t,i=e=>t=>r(t,e);return{addEventListener:(t,r)=>{"message"===t?e.addEventListener(t,i(r)):n(`Event ${t} is not supported by nestedAppAuthBridge`)},postMessage:e=>{const t=(()=>{try{return JSON.parse(e)}catch(e){return null}})();if(!t||"object"!=typeof t||"NestedAppAuthRequest"!==t.messageType)return void n("Unrecognized data format received by app, message being ignored. Message: %o",e);const r=Zn(Qs,"nestedAppAuth.execute");o(e,r)},removeEventListener:(t,n)=>{e.removeEventListener(t,i(n))}}}var ec=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const tc=Qn("communication");class nc{}class rc{}function oc(e,t){if(rc.messageListener=e=>Ic(e),nc.currentWindow=nc.currentWindow||kn(),nc.parentWindow=nc.currentWindow.parent!==nc.currentWindow.self?nc.currentWindow.parent:nc.currentWindow.opener,nc.topWindow=nc.currentWindow.top,(nc.parentWindow||e)&&nc.currentWindow.addEventListener("message",rc.messageListener,!1),!nc.parentWindow){const e=nc.currentWindow;if(!e.nativeInterface)return Promise.reject(new Error("Initialization Failed. No Parent window found."));$n.isFramelessWindow=!0,e.onNativeMessage=Dc}try{return nc.parentOrigin="*",lc(t,"initialize",[yr,tr,e]).then((([e,t,n,r])=>(Zs(r,nc.currentWindow,{onMessage:Tc,sendPostMessage:Cc}),{context:e,clientType:t,runtimeConfig:n,clientSupportedSDKVersion:r})))}finally{nc.parentOrigin=null}}function ic(){nc.currentWindow&&nc.currentWindow.removeEventListener("message",rc.messageListener,!1),nc.currentWindow=null,nc.parentWindow=null,nc.parentOrigin=null,rc.parentMessageQueue=[],rc.nextMessageId=0,rc.callbacks.clear(),rc.promiseCallbacks.clear(),rc.portCallbacks.clear(),rc.legacyMessageIdsToUuidMap={},Gs.clearMessages(),Us()}function ac(e,t,...n){return lc(e,t,n).then((([e])=>e))}function sc(e,t,...n){return lc(e,t,n).then((([e,t])=>{if(!e)throw new Error(t)}))}function cc(e,t,n,...r){return lc(e,t,r).then((([e,t])=>{if(!e)throw new Error(t||n)}))}function uc(e,t,...n){return lc(e,t,n).then((([e,t])=>{if(e)throw e;return t}))}function lc(e,t,n=void 0){if(!Xn(e))throw Error(`apiVersionTag: ${e} passed in doesn't follow the pattern starting with 'v' followed by digits, then underscore with words, please check.`);return new Promise((r=>{r(hc(Ec(e,t,n).uuid))}))}function dc(e){return e.map((e=>Cr(e)?e.serialize():e))}function fc(e,t,n,r,o){var i;return ec(this,void 0,void 0,(function*(){const a=dc(t),[s]=yield lc(r,e,a);if(o&&o(s)||!o&&We(s))throw new Error(`${s.errorCode}, message: ${null!==(i=s.message)&&void 0!==i?i:"None"}`);if(n.validate(s))return n.deserialize(s);throw new Error(`${xe.INTERNAL_ERROR}, message: Invalid response from host - ${JSON.stringify(s)}`)}))}function pc(e,t,n,r){var o;return ec(this,void 0,void 0,(function*(){const i=dc(t),[a]=yield lc(n,e,i);if(r&&r(a)||!r&&We(a))throw new Error(`${a.errorCode}, message: ${null!==(o=a.message)&&void 0!==o?o:"None"}`);if(void 0!==a)throw new Error(`${xe.INTERNAL_ERROR}, message: Invalid response from host`)}))}function gc(e,t,n=void 0){if(!Xn(e))throw Error(`apiVersionTag: ${e} passed in doesn't follow the pattern starting with 'v' followed by digits, then underscore with words, please check.`);return mc(Ec(e,t,n).uuid)}function mc(e){return new Promise(((t,n)=>{rc.portCallbacks.set(e,((e,r)=>{e instanceof MessagePort?t(e):n(r&&r.length>0?r[0]:new Error("Host responded without port or error details."))}))}))}function hc(e){return new Promise((t=>{rc.promiseCallbacks.set(e,t)}))}function vc(e,t,n,r){let o;if(n instanceof Function?r=n:n instanceof Array&&(o=n),!Xn(e))throw Error(`apiVersionTag: ${e} passed in doesn't follow the pattern starting with 'v' followed by digits, then underscore with words, please check.`);const i=Ec(e,t,o);r&&rc.callbacks.set(i.uuid,r)}rc.parentMessageQueue=[],rc.topMessageQueue=[],rc.nextMessageId=0,rc.callbacks=new Map,rc.promiseCallbacks=new Map,rc.portCallbacks=new Map,rc.legacyMessageIdsToUuidMap={};const wc=tc.extend("sendNestedAuthRequestToTopWindow");function Cc(e,t){const n=wc,r=nc.topWindow,o=jc(e,t);return n("Message %s information: %o",Nr(o),{actionName:o.func}),Sc(r,o)}const yc=tc.extend("sendRequestToTargetWindowHelper");function Sc(e,t){const n=yc,r=Vc(e),o=Rr(t);if($n.isFramelessWindow)nc.currentWindow&&nc.currentWindow.nativeInterface&&(n("Sending message %s to %s via framelessPostMessage interface",Nr(o),r),nc.currentWindow.nativeInterface.framelessPostMessage(JSON.stringify(o)));else{const i=_c(e);e&&i?(n("Sending message %s to %s via postMessage",Nr(o),r),e.postMessage(o,i)):(n("Adding message %s to %s message queue",Nr(o),r),Hc(e).push(t))}return t}const bc=tc.extend("sendMessageToParentHelper");function Ec(e,t,n,r,o){const i=bc,a=nc.parentWindow,s=Wc(e,t,n,r,o);return Gs.storeCallbackInformation(s.uuid,{name:t,calledAt:s.timestamp}),i("Message %s information: %o",Nr(s),{actionName:t,args:n}),Sc(a,s)}const Ac=tc.extend("processIncomingMessage");function Ic(e){return ec(this,void 0,void 0,(function*(){if(!e||!e.data||"object"!=typeof e.data)return void Ac("Unrecognized message format received by app, message being ignored. Message: %o",e);const t=e.source||e.originalEvent&&e.originalEvent.source,n=e.origin||e.originalEvent&&e.originalEvent.origin;return Rc(t,n).then((r=>{r?(Fc(t,n),t!==nc.parentWindow?Hs(t,n)&&_s(e,t,Ec,((e,t)=>rc.callbacks.set(e,t))):Dc(e)):Ac("Message being ignored by app because it is either coming from the current window or a different window with an invalid origin, message: %o, source: %o, origin: %o",e,t,n)}))}))}const Pc=tc.extend("processAuthBridgeMessage");function Tc(e,t){var n,r;const o=Pc;if(!e||!e.data||"object"!=typeof e.data)return void o("Unrecognized message format received by app, message being ignored. Message: %o",e);const{args:i}=e.data,[,a]=null!=i?i:[],s=(()=>{try{return JSON.parse(a)}catch(e){return null}})();if(!s||"object"!=typeof s||"NestedAppAuthResponse"!==s.messageType)return void o("Unrecognized data format received by app, message being ignored. Message: %o",e);const c=e.source||(null===(n=null==e?void 0:e.originalEvent)||void 0===n?void 0:n.source),u=e.origin||(null===(r=null==e?void 0:e.originalEvent)||void 0===r?void 0:r.origin);c?Rc(c,u)?(nc.topWindow&&!nc.topWindow.closed&&c!==nc.topWindow||(nc.topWindow=c,nc.topOrigin=u),nc.topWindow&&nc.topWindow.closed&&(nc.topWindow=null,nc.topOrigin=null),Dr(nc.topWindow,nc.topOrigin,rc.topMessageQueue,"top"),t(a)):o("Message being ignored by app because it is either coming from the current window or a different window with an invalid origin"):o("Message being ignored by app because it is coming for a target that is null")}const Oc=tc.extend("shouldProcessIncomingMessage");function Rc(e,t){return ec(this,void 0,void 0,(function*(){if(nc.currentWindow&&e===nc.currentWindow)return Oc("Should not process message because it is coming from the current window"),!1;if(nc.currentWindow&&nc.currentWindow.location&&t&&t===nc.currentWindow.location.origin)return!0;{let e;try{e=new URL(t)}catch(e){return Oc("Message has an invalid origin of %s",t),!1}const n=yield pa(e);return n||Oc("Message has an invalid origin of %s",t),n}}))}function Fc(e,t){$n.isFramelessWindow||nc.parentWindow&&!nc.parentWindow.closed&&e!==nc.parentWindow||(nc.parentWindow=e,nc.parentOrigin=t),nc.parentWindow&&nc.parentWindow.closed&&(nc.parentWindow=null,nc.parentOrigin=null),Dr(nc.parentWindow,nc.parentOrigin,rc.parentMessageQueue,"parent")}const kc=tc.extend("handleIncomingMessageFromParent");function Mc(e){const t=kc;if(!e.uuid)return rc.legacyMessageIdsToUuidMap[e.id];{const t=e.uuid,n=Nc(rc.callbacks,t);if(n)return n;const r=Nc(rc.promiseCallbacks,t);if(r)return r;const o=Nc(rc.portCallbacks,t);if(o)return o}t("Received message %s that failed to produce a callbackId",Nr(e))}function Nc(e,t){if(t){const n=[...e].find((([e,n])=>e.toString()===t.toString()));if(n)return n[0]}}function xc(e,t){const n=Nc(t,e.uuid);n&&t.delete(n),e.uuid?rc.legacyMessageIdsToUuidMap={}:delete rc.legacyMessageIdsToUuidMap[e.id]}function Dc(e){const t=kc,n=Bn();if("id"in e.data&&"number"==typeof e.data.id){const r=e.data,o=kr(r),i=Mc(o);if(i){const r=rc.callbacks.get(i);t("Received a response from parent for message %s",i.toString()),Gs.handlePerformanceMetrics(i,o,t,n),r&&(t("Invoking the registered callback for message %s with arguments %o",i.toString(),o.args),r.apply(null,[...o.args,o.isPartialResponse]),Uc(e)||(t("Removing registered callback for message %s",i.toString()),xc(o,rc.callbacks)));const a=rc.promiseCallbacks.get(i);a&&(t("Invoking the registered promise callback for message %s with arguments %o",i.toString(),o.args),a(o.args),t("Removing registered promise callback for message %s",i.toString()),xc(o,rc.promiseCallbacks));const s=rc.portCallbacks.get(i);if(s){let n;t("Invoking the registered port callback for message %s with arguments %o",i.toString(),o.args),e.ports&&e.ports[0]instanceof MessagePort&&(n=e.ports[0]),s(n,o.args),t("Removing registered port callback for message %s",i.toString()),xc(o,rc.portCallbacks)}o.uuid&&(rc.legacyMessageIdsToUuidMap={})}}else if("func"in e.data&&"string"==typeof e.data.func){const r=e.data;Gs.handleOneWayPerformanceMetrics(r,t,n),t('Received a message from parent %s, action: "%s"',Nr(r),r.func),vs(r.func,r.args)}else t("Received an unknown message: %O",e)}function Uc(e){return!0===e.data.isPartialResponse}function Lc(){return nc.topWindow!==nc.parentWindow}function Hc(e){return e===nc.topWindow&&Lc()?rc.topMessageQueue:e===nc.parentWindow?rc.parentMessageQueue:[]}function _c(e){return e===nc.topWindow&&Lc()?nc.topOrigin:e===nc.parentWindow?nc.parentOrigin:null}function Vc(e){return e===nc.topWindow&&Lc()?"top":e===nc.parentWindow?"parent":null}function Bc(e,t){let n;n=nc.currentWindow.setInterval((()=>{0===Hc(e).length&&(clearInterval(n),t())}),100)}function Wc(e,t,n,r,o){const i=rc.nextMessageId++,a=new jn;rc.legacyMessageIdsToUuidMap[i]=a;const s=!0===r?o:$n.teamsJsInstanceId;return{id:i,uuid:a,func:t,timestamp:Date.now(),monotonicTimestamp:Bn(),args:n||[],apiVersionTag:e,isProxiedFromChild:null!=r&&r,teamsJsInstanceId:s}}function jc(e,t){const n=rc.nextMessageId++,r=new jn;return rc.legacyMessageIdsToUuidMap[n]=r,{id:n,uuid:r,func:"nestedAppAuth.execute",timestamp:Date.now(),monotonicTimestamp:Bn(),apiVersionTag:t,args:[],data:e}}const zc="v1";function $c(e){if(!eo(e)&&Vr(ir),!eo(e)&&!qc())throw pn;e?ws(Zn(zc,"log.request"),"log.request",(()=>{const t=e();vc(Zn(zc,"log.receive"),"log.receive",[t])})):Cs("log.request")}function qc(){return!(!Vr(ir)||!ir.supports.logs)}var Gc,Jc,Kc;!function(e){e.fileDownloadStart="fileDownloadStart",e.fileDownloadComplete="fileDownloadComplete"}(Gc||(Gc={})),function(e){e.view="view",e.edit="edit",e.editNew="editNew"}(Jc||(Jc={})),function(e){e.fileOpenPreference="fileOpenPreference",e.theme="theme"}(Kc||(Kc={}));const Qc="v1";function Zc(e,t){Vr(ir),vc(Zn(Qc,"uploadCustomApp"),"uploadCustomApp",[e],t||wn())}function Xc(e,t,n){Vr(ir),vc(Zn(Qc,"sendCustomMessage"),e,t,n)}function Yc(e,t){if(Vr(ir),!Ls())throw new Error("The child window has not yet been initialized or is not present");zs(e,t)}function eu(e,t){Vr(ir),ws(Zn(Qc,"registerCustomHandler"),e,((...e)=>t.apply(this,e)))}function tu(e,t){Vr(ir),ws(Zn(Qc,"registerUserSettingsChangeHandler"),"userSettingsChange",t,!0,[e])}function nu(e){Vr(ir,sn.content,sn.task);const t=[e.entityId,e.title,e.description,e.type,e.objectUrl,e.downloadUrl,e.webPreviewUrl,e.webEditUrl,e.baseUrl,e.editFile,e.subEntityId,e.viewerAction,e.fileOpenPreference,e.conversationId,e.sizeInBytes];vc(Zn(Qc,"openFilePreview"),"openFilePreview",t)}const ru="v1";function ou(e){return new Promise((t=>{if(Vr(ir,sn.content),!su())throw pn;const n=sc(Zn(ru,"conversations.openConversation"),"conversations.openConversation",{title:e.title,subEntityId:e.subEntityId,conversationId:e.conversationId,channelId:e.channelId,entityId:e.entityId});e.onStartConversation&&ws(Zn(ru,"conversations.registerStartConversationHandler"),"startConversation",((t,n,r,o)=>{var i;return null===(i=e.onStartConversation)||void 0===i?void 0:i.call(e,{subEntityId:t,conversationId:n,channelId:r,entityId:o})})),e.onCloseConversation&&ws(Zn(ru,"conversations.registerCloseConversationHandler"),"closeConversation",((t,n,r,o)=>{var i;return null===(i=e.onCloseConversation)||void 0===i?void 0:i.call(e,{subEntityId:t,conversationId:n,channelId:r,entityId:o})})),t(n)}))}function iu(){if(Vr(ir,sn.content),!su())throw pn;vc(Zn(ru,"conversations.closeConversation"),"conversations.closeConversation"),Cs("startConversation"),Cs("closeConversation")}function au(){return new Promise((e=>{if(Vr(ir),!su())throw pn;e(ac(Zn(ru,"conversations.getChatMember"),"getChatMembers"))}))}function su(){return!(!Vr(ir)||!ir.supports.conversations)}var cu=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const uu="v2",lu=Qn("copilot");function du(){var e;return Vr(ir)&&!!(null===(e=ir.supports.copilot)||void 0===e?void 0:e.customTelemetry)}function fu(e,t){var n;return void 0===t&&(t=null!==(n=Bn())&&void 0!==n?n:Date.now()),cu(this,void 0,void 0,(function*(){return Vr(ir),lu("Sending custom telemetry data to host for stage: %s to record timestamp: %s",e,t),pc("copilot.customTelemetry.sendCustomTelemetryData",[e.toString(),t],Zn(uu,"copilot.customTelemetry.sendCustomTelemetryData"))}))}var pu=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const gu="v2",mu=Qn("copilot");function hu(){var e,t;return Vr(ir)&&(!!(null===(e=ir.hostVersionsInfo)||void 0===e?void 0:e.appEligibilityInformation)||!!(null===(t=ir.supports.copilot)||void 0===t?void 0:t.eligibility))}function vu(e){var t,n;return pu(this,void 0,void 0,(function*(){if(Vr(ir),!hu())throw new Error(`Error code: ${pn.errorCode}, message: Not supported on platform`);if((null===(t=ir.hostVersionsInfo)||void 0===t?void 0:t.appEligibilityInformation)&&!e)return mu("Eligibility information is already available on runtime."),ir.hostVersionsInfo.appEligibilityInformation;mu("Eligibility information is not available on runtime. Requesting from host.");const r=yield ac(Zn(gu,"copilot.eligibility.getEligibilityInfo"),"copilot.eligibility.getEligibilityInfo",e);if(We(r))throw new Error(`Error code: ${r.errorCode}, message: ${null!==(n=r.message)&&void 0!==n?n:"Failed to get eligibility information from the host."}`);if(!wu(r))throw new Error("Error deserializing eligibility information");return r}))}function wu(e){return void 0!==e.ageGroup&&void 0!==e.cohort&&void 0!==e.userClassification&&void 0!==e.isCopilotEligible&&void 0!==e.isCopilotEnabledRegion&&void 0!==e.isOptedOutByAdmin&&(!e.featureSet||void 0!==e.featureSet.serverFeatures&&void 0!==e.featureSet.uxFeatures)}var Cu,yu,Su,bu,Eu,Au,Iu,Pu,Tu;!function(e){e.EMAIL="email",e.TEXT="text",e.MEDIA="media",e.CALENDAR_INVITE="calendarInvite",e.WEB_PAGE="webPage",e.MIXED="mixed",e.TEAMS="teams",e.FILE="file"}(Cu||(Cu={})),function(e){e.IMAGE="image",e.AUDIO="audio",e.VIDEO="video"}(yu||(yu={})),function(e){e.Private="Private",e.Shared="Shared",e.Recap="Recap",e.RecapCall="RecapCall",e.PrivateViewCall="PrivateViewCall",e.Chat="Chat",e.Compose="Compose"}(Su||(Su={})),function(e){e.ClientDeviceType="ClientDeviceType",e.ClientRing="ClientRing",e.ClientScenarioName="ClientScenarioName"}(bu||(bu={})),function(e){e.Enabled="enabled",e.Disabled="disabled",e.EnabledWithTranscript="enabledWithTranscript"}(Eu||(Eu={})),function(e){e.NotStarted="notStarted",e.Active="active",e.Inactive="inactive",e.UnknownFutureValue="unknownFutureValue"}(Au||(Au={})),function(e){e.Chat="Chat",e.Channel="Channel",e.Meeting="Meeting",e.MeetingChat="MeetingChat"}(Iu||(Iu={})),function(e){e.Accepted="accepted",e.NotAccepted="not_accepted"}(Pu||(Pu={})),function(e){e.ConsentNotAccepted="consent_not_accepted",e.PageContentBlockedPolicy="page_content_blocked_policy",e.PageContentBlockedDlp="page_content_blocked_dlp",e.PageContentTypeNotSupportedYet="page_content_type_not_supported_yet",e.PageContentSizeNotSupported="page_content_size_not_supported",e.PageContextChanged="page_context_changed",e.PageContentExtractionFailed="page_content_extraction_failed",e.PageContentSizeNotSupportedPDF="page_content_size_not_supported_pdf",e.NotSupportedOnPlatform="not_supported_on_platform",e.OtherError="other_error"}(Tu||(Tu={}));class Ou extends Error{constructor(e,t){super(t),this.errorCode=e,this.name="SidePanelError"}}var Ru=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const Fu="v2";function ku(){var e;return Vr(ir)&&!!(null===(e=ir.supports.copilot)||void 0===e?void 0:e.sidePanel)}function Mu(e){if("object"!=typeof e||null===e)return!1;const t=e;return Object.values(Tu).includes(t.errorCode)&&(void 0===t.message||"string"==typeof t.message)||We(e)}function Nu(e){return Ru(this,void 0,void 0,(function*(){Vr(ir);return fc("copilot.sidePanel.getContent",e?[new _u(e)]:[],new Lu,Zn(Fu,"copilot.sidePanel.getContent"),Mu)}))}function xu(){return Ru(this,void 0,void 0,(function*(){return Vr(ir),fc("copilot.sidePanel.preCheckUserConsent",[],new Hu,Zn(Fu,"copilot.sidePanel.preCheckUserConsent"),Mu)}))}function Du(e){Ss(Zn(Fu,"copilot.sidePanel.registerUserActionContentSelect"),"copilot.sidePanel.userActionContentSelect",e,[sn.content],(()=>{if(!ku())throw Uu}))}const Uu=new Ou(Tu.NotSupportedOnPlatform,"This API is not supported on the current platform.");class Lu extends Wi{validate(e){return null!==e&&"object"==typeof e}deserialize(e){return e}}class Hu extends Wi{validate(e){return null!==e&&"object"==typeof e}deserialize(e){return e}}class _u{constructor(e){this.contentRequest=e}serialize(){return this.contentRequest}}var Vu=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const Bu="v2";function Wu(){var e;return Vr(ir)&&!!(null===(e=ir.supports.copilot)||void 0===e?void 0:e.view)}function ju(){return Vu(this,void 0,void 0,(function*(){Vr(ir),yield fc("copilot.view.closeSidePanel",[],new zu,Zn(Bu,"copilot.view.closeSidePanel"))}))}class zu extends Wi{validate(e){return!0}deserialize(e){return e}}const $u="v2";class qu{constructor(e){this.invokeRequest=e}serialize(){return this.invokeRequest}}function Gu(e){const t=e;return t.responseType===Qu.ActionExecuteInvokeResponse&&void 0!==t.value&&void 0!==t.statusCode&&void 0!==t.type}const Ju="Action.Execute";var Ku,Qu,Zu;!function(e){e.ActionExecuteInvokeRequest="ActionExecuteInvokeRequest",e.QueryMessageExtensionRequest="QueryMessageExtensionRequest"}(Ku||(Ku={})),function(e){e.ActionExecuteInvokeResponse="ActionExecuteInvokeResponse",e.QueryMessageExtensionResponse="QueryMessageExtensionResponse"}(Qu||(Qu={}));class Xu extends Wi{validate(e){return Gu(e)}deserialize(e){return e}}function Yu(e){if("object"!=typeof e||null===e)return!1;const t=e;return Object.values(Zu).includes(t.errorCode)&&(void 0===t.message||"string"==typeof t.message)}function el(e){e.requestType===Ku.ActionExecuteInvokeRequest?tl(e):e.requestType===Ku.QueryMessageExtensionRequest&&nl(e)}function tl(e){if(e.type!==Ju){throw{errorCode:Zu.INTERNAL_ERROR,message:`Invalid action type ${e.type}. Action type must be "${Ju}"`}}if(!Wn(e.data)){throw{errorCode:Zu.INTERNAL_ERROR,message:`Invalid data type ${typeof e.data}. Data must be a primitive or a plain object.`}}}function nl(e){if(e.commandId.length>64)throw new Error("originalRequestInfo.commandId exceeds the maximum size of 64 characters");if(e.parameters.length>5)throw new Error("originalRequestInfo.parameters exceeds the maximum size of 5");for(const t of e.parameters){if(t.name.length>64)throw new Error("originalRequestInfo.parameters.name exceeds the maximum size of 64 characters");if(t.value.length>512)throw new Error("originalRequestInfo.parameters.value exceeds the maximum size of 512 characters")}}function rl(e,t,n){if(Vr(ir,sn.content),!cl())throw pn;const r=new Yr(e);return el(n),lc(Zn($u,"externalAppAuthentication.authenticateAndResendRequest"),"externalAppAuthentication.authenticateAndResendRequest",[r.toString(),n,t.url.href,t.width,t.height,t.isExternal]).then((([e,t])=>{if(e&&null!=t.responseType)return t;throw t}))}function ol(e,t){if(Vr(ir,sn.content),!cl())throw pn;const n=new Yr(e);return lc(Zn($u,"externalAppAuthentication.authenticateWithSSO"),"externalAppAuthentication.authenticateWithSSO",[n.toString(),t.claims,t.silent]).then((([e,t])=>{if(!e)throw t}))}function il(e,t,n){if(Vr(ir,sn.content),!cl())throw pn;const r=new Yr(e);return el(n),lc(Zn($u,"externalAppAuthentication.authenticateWithSSOAndResendRequest"),"externalAppAuthentication.authenticateWithSSOAndResendRequest",[r.toString(),n,t.claims,t.silent]).then((([e,t])=>{if(e&&null!=t.responseType)return t;throw t}))}function al(e,t,n){if(Vr(ir,sn.content),!cl())throw pn;return Nn(e,new Error("titleId is Invalid.")),Nn(t,new Error("oauthConfigId is Invalid.")),lc(Zn($u,"externalAppAuthentication.authenticateWithOauth2"),"externalAppAuthentication.authenticateWithOauth2",[e,t,n.width,n.height,n.isExternal]).then((([e,t])=>{if(!e)throw t}))}function sl(e,t,n){if(Vr(ir,sn.content),!cl())throw pn;return Nn(e,new Error("titleId is Invalid.")),t&&xn(t),lc(Zn($u,"externalAppAuthentication.authenticateWithPowerPlatformConnectorPlugins"),"externalAppAuthentication.authenticateWithPowerPlatformConnectorPlugins",[e,null==t?void 0:t.toString(),null==n?void 0:n.width,null==n?void 0:n.height,null==n?void 0:n.isExternal]).then((([e,t])=>{if(!e)throw t}))}function cl(){return!(!Vr(ir)||!ir.supports.externalAppAuthentication)}!function(e){e.INTERNAL_ERROR="INTERNAL_ERROR"}(Zu||(Zu={}));var ul=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const ll="v2";function dl(e,t,n){return ul(this,void 0,void 0,(function*(){if(Vr(ir,sn.content),!ml())throw pn;return hl(e,t),pc("externalAppAuthenticationForCEA.authenticateWithSSO",[e,t,n.authId,n.connectionName,n.claims,n.silent],Zn(ll,"externalAppAuthenticationForCEA.authenticateWithSSO"),Yu)}))}function fl(e,t,n){return ul(this,void 0,void 0,(function*(){if(Vr(ir,sn.content),!ml())throw pn;return hl(e,t),pc("externalAppAuthenticationForCEA.authenticateWithOauth",[e,t,n.url.href,n.width,n.height,n.isExternal],Zn(ll,"externalAppAuthenticationForCEA.authenticateWithOauth"),Yu)}))}function pl(e,t,n,r){return ul(this,void 0,void 0,(function*(){if(Vr(ir,sn.content),!ml())throw pn;return hl(e,t),tl(r),fc("externalAppAuthenticationForCEA.authenticateAndResendRequest",[e,t,new qu(r),n.url.href,n.width,n.height,n.isExternal],new Xu,Zn(ll,"externalAppAuthenticationForCEA.authenticateAndResendRequest"),Yu)}))}function gl(e,t,n,r){return ul(this,void 0,void 0,(function*(){if(Vr(ir,sn.content),!ml())throw pn;return hl(e,t),tl(r),fc("externalAppAuthenticationForCEA.authenticateWithSSOAndResendRequest",[e,t,new qu(r),n.authId,n.connectionName,n.claims,n.silent],new Xu,Zn(ll,"externalAppAuthenticationForCEA.authenticateWithSSOAndResendRequest"),Yu)}))}function ml(){return!(!Vr(ir)||!ir.supports.externalAppAuthenticationForCEA)}function hl(e,t){Nn(t,new Error("conversation id is not valid.")),Zr(e)}const vl="v2";var wl,Cl;function yl(e,t){if(Vr(ir,sn.content),!bl())throw pn;const n=new Yr(e);return lc(Zn(vl,"externalAppCardActions.processActionSubmit"),"externalAppCardActions.processActionSubmit",[n.toString(),t]).then((([e,t])=>{if(!e)throw t}))}function Sl(e,t,n){if(Vr(ir,sn.content),!bl())throw pn;const r=new Yr(e);return lc(Zn(vl,"externalAppCardActions.processActionOpenUrl"),"externalAppCardActions.processActionOpenUrl",[r.toString(),t.href,n]).then((([e,t])=>{if(e)throw e;return t}))}function bl(){return!(!Vr(ir)||!ir.supports.externalAppCardActions)}!function(e){e.DeepLinkDialog="DeepLinkDialog",e.DeepLinkOther="DeepLinkOther",e.DeepLinkStageView="DeepLinkStageView",e.GenericUrl="GenericUrl"}(wl||(wl={})),function(e){e.INTERNAL_ERROR="INTERNAL_ERROR",e.INVALID_LINK="INVALID_LINK",e.NOT_SUPPORTED="NOT_SUPPORTED"}(Cl||(Cl={}));var El=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const Al="v2";function Il(e,t,n){return El(this,void 0,void 0,(function*(){if(Vr(ir,sn.content),!Tl())throw pn;hl(e,t);const[r,o]=yield lc(Zn(Al,"externalAppCardActionsForCEA.processActionOpenUrl"),"externalAppCardActionsForCEA.processActionOpenUrl",[e.toString(),t,n.href]);if(r)throw r;return o}))}function Pl(e,t,n){return El(this,void 0,void 0,(function*(){if(Vr(ir,sn.content),!Tl())throw pn;hl(e,t);const r=yield ac(Zn(Al,"externalAppCardActionsForCEA.processActionSubmit"),"externalAppCardActionsForCEA.processActionSubmit",e.toString(),t,n);if(r)throw r}))}function Tl(){return!(!Vr(ir)||!ir.supports.externalAppCardActionsForCEA)}var Ol;function Rl(e){if("object"!=typeof e||null===e)return!1;const t=e;return Object.values(Ol).includes(t.errorCode)&&(void 0===t.message||"string"==typeof t.message)}!function(e){e.INTERNAL_ERROR="INTERNAL_ERROR"}(Ol||(Ol={}));var Fl=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const kl="v2";function Ml(e,t,n){return Fl(this,void 0,void 0,(function*(){if(Vr(ir,sn.content),!Nl())throw pn;return xl(e,n),pc("externalAppCardActionsForDA.processActionOpenUrlDialog",[e,new Dl(t),n],Zn(kl,"externalAppCardActionsForDA.processActionOpenUrlDialog"),Rl)}))}function Nl(){return!(!Vr(ir)||!ir.supports.externalAppCardActionsForDA)}function xl(e,t){Zr(e),zn(t)}class Dl{constructor(e){this.info=e}serialize(){const{url:e,title:t,size:n}=this.info;return{url:e.href,title:t,size:n}}}var Ul=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const Ll="v2";function Hl(e,t,n){return Ul(this,void 0,void 0,(function*(){if(Vr(ir,sn.content),!_l())throw pn;const r=new Yr(e),[o,i]=yield lc(Zn(Ll,"externalAppCommands.processActionCommand"),"externalAppCommands.processActionCommand",[r.toString(),t,n]);if(o)throw o;return i}))}function _l(){return!(!Vr(ir)||!ir.supports.externalAppCommands)}const Vl="v1";var Bl,Wl,jl,zl,$l,ql;function Gl(e,t){if(Vr(ir,sn.content),!e||0===e.length)throw new Error("[files.getCloudStorageFolders] channelId name cannot be null or empty");if(!t)throw new Error("[files.getCloudStorageFolders] Callback cannot be null");vc(Zn(Vl,"files.getCloudStorageFolders"),"files.getCloudStorageFolders",[e],t)}function Jl(e,t){if(Vr(ir,sn.content),!e||0===e.length)throw new Error("[files.addCloudStorageFolder] channelId name cannot be null or empty");if(!t)throw new Error("[files.addCloudStorageFolder] Callback cannot be null");vc(Zn(Vl,"files.addCloudStorageFolder"),"files.addCloudStorageFolder",[e],t)}function Kl(e,t,n){if(Vr(ir,sn.content),!e)throw new Error("[files.deleteCloudStorageFolder] channelId name cannot be null or empty");if(!t)throw new Error("[files.deleteCloudStorageFolder] folderToDelete cannot be null or empty");if(!n)throw new Error("[files.deleteCloudStorageFolder] Callback cannot be null");vc(Zn(Vl,"files.deleteCloudStorageFolder"),"files.deleteCloudStorageFolder",[e,t],n)}function Ql(e,t,n){if(Vr(ir,sn.content),!e||!t)throw new Error("[files.getCloudStorageFolderContents] folder/providerCode name cannot be null or empty");if(!n)throw new Error("[files.getCloudStorageFolderContents] Callback cannot be null");if("isSubdirectory"in e&&!e.isSubdirectory)throw new Error("[files.getCloudStorageFolderContents] provided folder is not a subDirectory");vc(Zn(Vl,"files.getCloudStorageFolderContents"),"files.getCloudStorageFolderContents",[e,t],n)}function Zl(e,t,n){if(Vr(ir,sn.content),!e||!t)throw new Error("[files.openCloudStorageFile] file/providerCode cannot be null or empty");if(e.isSubdirectory)throw new Error("[files.openCloudStorageFile] provided file is a subDirectory");vc(Zn(Vl,"files.openCloudStorageFile"),"files.openCloudStorageFile",[e,t,n])}function Xl(e=!1,t){if(Vr(ir,sn.content),!t)throw new Error("[files.getExternalProviders] Callback cannot be null");vc(Zn(Vl,"files.getExternalProviders"),"files.getExternalProviders",[e],t)}function Yl(e,t,n,r,o=!1,i){if(Vr(ir,sn.content),!e||0===e.length)throw new Error("[files.copyMoveFiles] selectedFiles cannot be null or empty");if(!t)throw new Error("[files.copyMoveFiles] providerCode cannot be null or empty");if(!n)throw new Error("[files.copyMoveFiles] destinationFolder cannot be null or empty");if(!r)throw new Error("[files.copyMoveFiles] destinationProviderCode cannot be null or empty");if(!i)throw new Error("[files.copyMoveFiles] callback cannot be null");vc(Zn(Vl,"files.copyMoveFiles"),"files.copyMoveFiles",[e,t,n,r,o],i)}function ed(e){if(Vr(ir,sn.content),!e)throw new Error("[files.getFileDownloads] Callback cannot be null");vc(Zn(Vl,"files.getFileDownloads"),"files.getFileDownloads",[],e)}function td(e=void 0,t){if(Vr(ir,sn.content),!t)throw new Error("[files.openDownloadFolder] Callback cannot be null");vc(Zn(Vl,"files.openDownloadFolder"),"files.openDownloadFolder",[e],t)}function nd(e){if(Vr(ir,sn.content),!e)throw dd(xe.INVALID_ARGUMENTS,"[files.addCloudStorageProvider] callback cannot be null");vc(Zn(Vl,"files.addCloudStorageProvider"),"files.addCloudStorageProvider",[],e)}function rd(e,t){if(Vr(ir,sn.content),!t)throw dd(xe.INVALID_ARGUMENTS,"[files.removeCloudStorageProvider] callback cannot be null");if(!e||!e.content)throw dd(xe.INVALID_ARGUMENTS,"[files.removeCloudStorageProvider] 3P cloud storage provider request content is missing");vc(Zn(Vl,"files.removeCloudStorageProvider"),"files.removeCloudStorageProvider",[e],t)}function od(e,t){if(Vr(ir,sn.content),!t)throw dd(xe.INVALID_ARGUMENTS,"[files.addCloudStorageProviderFile] callback cannot be null");if(!e||!e.content)throw dd(xe.INVALID_ARGUMENTS,"[files.addCloudStorageProviderFile] 3P cloud storage provider request content is missing");vc(Zn(Vl,"files.addCloudStorageProviderFile"),"files.addCloudStorageProviderFile",[e],t)}function id(e,t){if(Vr(ir,sn.content),!t)throw dd(xe.INVALID_ARGUMENTS,"[files.renameCloudStorageProviderFile] callback cannot be null");if(!e||!e.content)throw dd(xe.INVALID_ARGUMENTS,"[files.renameCloudStorageProviderFile] 3P cloud storage provider request content is missing");vc(Zn(Vl,"files.renameCloudStorageProviderFile"),"files.renameCloudStorageProviderFile",[e],t)}function ad(e,t){if(Vr(ir,sn.content),!t)throw dd(xe.INVALID_ARGUMENTS,"[files.deleteCloudStorageProviderFile] callback cannot be null");if(!(e&&e.content&&e.content.itemList&&e.content.itemList.length>0))throw dd(xe.INVALID_ARGUMENTS,"[files.deleteCloudStorageProviderFile] 3P cloud storage provider request content details are missing");vc(Zn(Vl,"files.deleteCloudStorageProviderFile"),"files.deleteCloudStorageProviderFile",[e],t)}function sd(e,t){if(Vr(ir,sn.content),!t)throw dd(xe.INVALID_ARGUMENTS,"[files.downloadCloudStorageProviderFile] callback cannot be null");if(!(e&&e.content&&e.content.itemList&&e.content.itemList.length>0))throw dd(xe.INVALID_ARGUMENTS,"[files.downloadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");vc(Zn(Vl,"files.downloadCloudStorageProviderFile"),"files.downloadCloudStorageProviderFile",[e],t)}function cd(e,t){if(Vr(ir,sn.content),!t)throw dd(xe.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] callback cannot be null");if(!(e&&e.content&&e.content.itemList&&e.content.itemList.length>0))throw dd(xe.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");if(!e.content.destinationFolder)throw dd(xe.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] Invalid destination folder details");vc(Zn(Vl,"files.uploadCloudStorageProviderFile"),"files.uploadCloudStorageProviderFile",[e],t)}function ud(e){if(Vr(ir),!e)throw new Error("[registerCloudStorageProviderListChangeHandler] Handler cannot be null");ws(Zn(Vl,"files.registerCloudStorageProviderListChangeHandler"),"files.cloudStorageProviderListChange",e)}function ld(e){if(Vr(ir),!e)throw new Error("[registerCloudStorageProviderContentChangeHandler] Handler cannot be null");ws(Zn(Vl,"files.registerCloudStorageProviderContentChangeHandler"),"files.cloudStorageProviderContentChange",e)}function dd(e,t){return{errorCode:e,message:t}}!function(e){e.Dropbox="DROPBOX",e.Box="BOX",e.Sharefile="SHAREFILE",e.GoogleDrive="GOOGLEDRIVE",e.Egnyte="EGNYTE",e.SharePoint="SharePoint"}(Bl||(Bl={})),function(e){e[e.Sharepoint=0]="Sharepoint",e[e.WopiIntegration=1]="WopiIntegration",e[e.Google=2]="Google",e[e.OneDrive=3]="OneDrive",e[e.Recent=4]="Recent",e[e.Aggregate=5]="Aggregate",e[e.FileSystem=6]="FileSystem",e[e.Search=7]="Search",e[e.AllFiles=8]="AllFiles",e[e.SharedWithMe=9]="SharedWithMe"}(Wl||(Wl={})),function(e){e.ClassMaterials="classMaterials"}(jl||(jl={})),function(e){e.Readonly="readonly"}(zl||(zl={})),function(e){e.Downloaded="Downloaded",e.Downloading="Downloading",e.Failed="Failed"}($l||($l={})),function(e){e.Download="DOWNLOAD",e.Upload="UPLOAD",e.Delete="DELETE"}(ql||(ql={}));const fd="v1";function pd(){return new Promise((e=>{if(Vr(ir),!vd())throw pn;e(uc(Zn(fd,"meetingRoom.getPairedMeetingRoomInfo"),"meetingRoom.getPairedMeetingRoomInfo"))}))}function gd(e){return new Promise((t=>{if(!e||0==e.length)throw new Error("[meetingRoom.sendCommandToPairedMeetingRoom] Command name cannot be null or empty");if(Vr(ir),!vd())throw pn;t(uc(Zn(fd,"meetingRoom.sendCommandToPairedMeetingRoom"),"meetingRoom.sendCommandToPairedMeetingRoom",e))}))}function md(e){if(!e)throw new Error("[meetingRoom.registerMeetingRoomCapabilitiesUpdateHandler] Handler cannot be null");if(Vr(ir),!vd())throw pn;ws(Zn(fd,"meetingRoom.registerMeetingRoomCapabilitiesUpdateHandler"),"meetingRoom.meetingRoomCapabilitiesUpdate",(t=>{Vr(ir),e(t)}))}function hd(e){if(!e)throw new Error("[meetingRoom.registerMeetingRoomStatesUpdateHandler] Handler cannot be null");if(Vr(ir),!vd())throw pn;ws(Zn(fd,"meetingRoom.registerMeetingRoomStatesUpdateHandler"),"meetingRoom.meetingRoomStatesUpdate",(t=>{Vr(ir),e(t)}))}function vd(){return!(!Vr(ir)||!ir.supports.meetingRoom)}function wd(){return!(!Vr(ir)||!ir.supports.messageChannels)}const Cd="1.0.1",yd={onMessage:function(e,t){if(!e||!e.data||"object"!=typeof e.data||null===e.data)return void Od("Invalid message format, ignoring. Message: %o",e);if(!Id(e.source,e.origin))return void Od("Message source/origin not allowed, ignoring.");const{args:n}=e.data,[,r]=null!=n?n:[],o=(()=>{try{return JSON.parse(r)}catch(e){return Rd("Failed to parse response message:",e),null}})();if(!o||"NestedAppAuthResponse"!==o.messageType)return void Od("Invalid response format, ignoring. Message: %o",e);t(r)}};let Sd=null,bd=!1;function Ed(e,t,n=!1){if(bd=n,!e)throw new Error("Cannot polyfill nestedAppAuthBridge as the current window does not exist");if(!t)throw new Error("Top origin is required to initialize the Nested App Auth Bridge");try{const e=new URL(t);if("https:"!==e.protocol)throw new Error(`Invalid top origin: ${t}. Only HTTPS origins are allowed.`);Sd=e.origin}catch(e){throw new Error(`Failed to initialize bridge: invalid top origin: ${t}`)}const r=e;if(r.nestedAppAuthBridge)return void Od("Nested App Auth Bridge is already present");const o=Ad(r);o&&(r.nestedAppAuthBridge=o)}function Ad(e){const t=new WeakMap,{onMessage:n}=yd,r=e=>t=>n(t,e);return{addEventListener:(n,o)=>{if("message"===n){const i=r(o);t.set(o,i),e.addEventListener(n,i)}else Od(`Event ${n} is not supported by nestedAppAuthBridge`)},postMessage:t=>{if(!e.top)throw new Error("window.top is not available for posting messages");try{const n=JSON.parse(t);if("object"==typeof n&&"NestedAppAuthRequest"===n.messageType){const n=Pd(t);if(e===e.top||!Sd)return void Rd("Not in an embedded iframe; skipping postMessage.");e.top.postMessage(n,Sd)}}catch(e){return void Rd("Failed to parse message:",e,"Original message:",t)}},removeEventListener:(n,r)=>{const o=t.get(r);o&&(e.removeEventListener(n,o),t.delete(r))}}}function Id(e,t){if(t===Sd)try{return"https:"===new URL(t).protocol}catch(e){return Rd("Invalid message origin URL:",e),!1}return!1}function Pd(e){const t=Date.now();return{id:Td(),uuid:tn(),func:"nestedAppAuth.execute",timestamp:t,apiVersionTag:"v2_nestedAppAuth.execute",monotonicTimestamp:t,args:[],data:e}}function Td(){return"undefined"!=typeof crypto&&crypto.randomUUID?crypto.randomUUID():Math.random().toString(36).substring(2,11)}function Od(...e){bd&&console.log(...e)}function Rd(...e){bd&&console.error(...e)}const Fd="v1";function kd(e){if(Vr(ir,sn.content),!Md())throw pn;vc(Zn(Fd,"notifications.showNotification"),"notifications.showNotification",[e])}function Md(){return!(!Vr(ir)||!ir.supports.notifications)}const Nd="v2";function xd(e){if(!Ld())throw new Error(xe.NOT_SUPPORTED_ON_PLATFORM.toString());if(eo(e))throw new Error(xe.INVALID_ARGUMENTS.toString());ws(Zn(Nd,"otherApp.install"),"otherApp.install",e)}function Dd(){if(!Ld())throw new Error(xe.NOT_SUPPORTED_ON_PLATFORM.toString());vc(Zn(Nd,"otherApp.unregisterInstall"),"otherApp.unregisterInstall"),Cs("otherApp.install")}function Ud(e){if(!Ld())throw new Error(xe.NOT_SUPPORTED_ON_PLATFORM.toString());return pc("otherApp.notifyInstallCompleted",[e.toString()],Zn(Nd,"otherApp.notifyInstallCompleted"))}function Ld(){return!(!Vr(ir)||!ir.supports.otherAppStateChange)}const Hd="v1";var _d,Vd,Bd;function Wd(e){if(!e)throw new Error("[remoteCamera.getCapableParticipants] Callback cannot be null");if(Vr(ir,sn.sidePanel),!Qd())throw pn;vc(Zn(Hd,"remoteCamera.getCapableParticipants"),"remoteCamera.getCapableParticipants",e)}function jd(e,t){if(!e)throw new Error("[remoteCamera.requestControl] Participant cannot be null");if(!t)throw new Error("[remoteCamera.requestControl] Callback cannot be null");if(Vr(ir,sn.sidePanel),!Qd())throw pn;vc(Zn(Hd,"remoteCamera.requestControl"),"remoteCamera.requestControl",[e],t)}function zd(e,t){if(!e)throw new Error("[remoteCamera.sendControlCommand] ControlCommand cannot be null");if(!t)throw new Error("[remoteCamera.sendControlCommand] Callback cannot be null");if(Vr(ir,sn.sidePanel),!Qd())throw pn;vc(Zn(Hd,"remoteCamera.sendControlCommand"),"remoteCamera.sendControlCommand",[e],t)}function $d(e){if(!e)throw new Error("[remoteCamera.terminateSession] Callback cannot be null");if(Vr(ir,sn.sidePanel),!Qd())throw pn;vc(Zn(Hd,"remoteCamera.terminateSession"),"remoteCamera.terminateSession",e)}function qd(e){if(!e)throw new Error("[remoteCamera.registerOnCapableParticipantsChangeHandler] Handler cannot be null");if(Vr(ir,sn.sidePanel),!Qd())throw pn;ws(Zn(Hd,"remoteCamera.registerOnCapableParticipantsChangeHandler"),"remoteCamera.capableParticipantsChange",e)}function Gd(e){if(!e)throw new Error("[remoteCamera.registerOnErrorHandler] Handler cannot be null");if(Vr(ir,sn.sidePanel),!Qd())throw pn;ws(Zn(Hd,"remoteCamera.registerOnErrorHandler"),"remoteCamera.handlerError",e)}function Jd(e){if(!e)throw new Error("[remoteCamera.registerOnDeviceStateChangeHandler] Handler cannot be null");if(Vr(ir,sn.sidePanel),!Qd())throw pn;ws(Zn(Hd,"remoteCamera.registerOnDeviceStateChangeHandler"),"remoteCamera.deviceStateChange",e)}function Kd(e){if(!e)throw new Error("[remoteCamera.registerOnSessionStatusChangeHandler] Handler cannot be null");if(Vr(ir,sn.sidePanel),!Qd())throw pn;ws(Zn(Hd,"remoteCamera.registerOnSessionStatusChangeHandler"),"remoteCamera.sessionStatusChange",e)}function Qd(){return!(!Vr(ir)||!ir.supports.remoteCamera)}!function(e){e.Reset="Reset",e.ZoomIn="ZoomIn",e.ZoomOut="ZoomOut",e.PanLeft="PanLeft",e.PanRight="PanRight",e.TiltUp="TiltUp",e.TiltDown="TiltDown"}(_d||(_d={})),function(e){e[e.CommandResetError=0]="CommandResetError",e[e.CommandZoomInError=1]="CommandZoomInError",e[e.CommandZoomOutError=2]="CommandZoomOutError",e[e.CommandPanLeftError=3]="CommandPanLeftError",e[e.CommandPanRightError=4]="CommandPanRightError",e[e.CommandTiltUpError=5]="CommandTiltUpError",e[e.CommandTiltDownError=6]="CommandTiltDownError",e[e.SendDataError=7]="SendDataError"}(Vd||(Vd={})),function(e){e[e.None=0]="None",e[e.ControlDenied=1]="ControlDenied",e[e.ControlNoResponse=2]="ControlNoResponse",e[e.ControlBusy=3]="ControlBusy",e[e.AckTimeout=4]="AckTimeout",e[e.ControlTerminated=5]="ControlTerminated",e[e.ControllerTerminated=6]="ControllerTerminated",e[e.DataChannelError=7]="DataChannelError",e[e.ControllerCancelled=8]="ControllerCancelled",e[e.ControlDisabled=9]="ControlDisabled",e[e.ControlTerminatedToAllowOtherController=10]="ControlTerminatedToAllowOtherController"}(Bd||(Bd={}));const Zd="v1";function Xd(e,t,n,r){if(Vr(ir,sn.content),!Yd())throw pn;if(!e||0==e.length)throw new Error("[appEntity.selectAppEntity] threadId name cannot be null or empty");if(!r)throw new Error("[appEntity.selectAppEntity] Callback cannot be null");vc(Zn(Zd,"appEntity.selectAppEntity"),"appEntity.selectAppEntity",[e,t,n],r)}function Yd(){return!(!Vr(ir)||!ir.supports.appEntity)}const ef="v1";function tf(e){return new Promise((t=>{if(Vr(ir),!nf())throw pn;if(($n.hostClientType===on.android||$n.hostClientType===on.teamsRoomsAndroid||$n.hostClientType===on.teamsPhones||$n.hostClientType===on.teamsDisplays)&&!Br(Je)){const e={errorCode:xe.OLD_PLATFORM};throw new Error(JSON.stringify(e))}t(ac(Zn(ef,"teams.fullTrust.joinedTeams.getUserJoinedTeams"),"getUserJoinedTeams",e))}))}function nf(){return!(!Vr(ir)||!ir.supports.teams)&&(!!ir.supports.teams.fullTrust&&!!ir.supports.teams.fullTrust.joinedTeams)}const rf="v1";function of(e){return new Promise((t=>{if(Vr(ir),!af())throw pn;t(ac(Zn(rf,"teams.fullTrust.getConfigSetting"),"getConfigSetting",e))}))}function af(){return!(!Vr(ir)||!ir.supports.teams)&&!!ir.supports.teams.fullTrust}const sf="v1";var cf;function uf(e,t){if(Vr(ir,sn.content),!df())throw pn;if(!e)throw new Error("[teams.getTeamChannels] groupId cannot be null or empty");if(!t)throw new Error("[teams.getTeamChannels] Callback cannot be null");vc(Zn(sf,"teams.getTeamChannels"),"teams.getTeamChannels",[e],t)}function lf(e,t){if(Vr(ir),!df())throw pn;if(!e)throw new Error("[teams.refreshSiteUrl] threadId cannot be null or empty");if(!t)throw new Error("[teams.refreshSiteUrl] Callback cannot be null");vc(Zn(sf,"teams.refreshSiteUrl"),"teams.refreshSiteUrl",[e],t)}function df(){return!(!Vr(ir)||!ir.supports.teams)}!function(e){e[e.Regular=0]="Regular",e[e.Private=1]="Private",e[e.Shared=2]="Shared"}(cf||(cf={}));class ff{static setTimeout(e,t){const n=performance.now(),r=yn();return ff.setTimeoutCallbacks[r]={callback:e,timeoutInMs:t,startedAtInMs:n},r}static clearTimeout(e){delete ff.setTimeoutCallbacks[e]}static setInterval(e,t){ff.setTimeout((function n(){e(),ff.setTimeout(n,t)}),t)}static tick(){const e=performance.now(),t=[];for(const n in ff.setTimeoutCallbacks){const r=ff.setTimeoutCallbacks[n];e-r.startedAtInMs>=r.timeoutInMs&&t.push(n)}for(const e of t){ff.setTimeoutCallbacks[e].callback(),delete ff.setTimeoutCallbacks[e]}}}ff.setTimeoutCallbacks={};class pf{constructor(e,t){this.reportStatisticsResult=t,this.sampleCount=0,this.distributionBins=new Uint32Array(e)}processStarts(e,t,n,r){ff.tick(),this.suitableForThisSession(e,t,n,r)||this.reportAndResetSession(this.getStatistics(),e,r,t,n),this.start()}processEnds(){const e=performance.now()-this.frameProcessingStartedAt,t=Math.floor(Math.max(0,Math.min(this.distributionBins.length-1,e)));this.distributionBins[t]+=1,this.sampleCount+=1}getStatistics(){return this.currentSession?{effectId:this.currentSession.effectId,effectParam:this.currentSession.effectParam,frameHeight:this.currentSession.frameHeight,frameWidth:this.currentSession.frameWidth,duration:performance.now()-this.currentSession.startedAtInMs,sampleCount:this.sampleCount,distributionBins:this.distributionBins.slice()}:null}start(){this.frameProcessingStartedAt=performance.now()}suitableForThisSession(e,t,n,r){return this.currentSession&&this.currentSession.effectId===e&&this.currentSession.effectParam===r&&this.currentSession.frameWidth===t&&this.currentSession.frameHeight===n}reportAndResetSession(e,t,n,r,o){e&&this.reportStatisticsResult(e),this.resetCurrentSession(this.getNextTimeout(t,this.currentSession),t,n,r,o),this.timeoutId&&ff.clearTimeout(this.timeoutId),this.timeoutId=ff.setTimeout((()=>this.reportAndResetSession(this.getStatistics(),t,n,r,o)).bind(this),this.currentSession.timeoutInMs)}resetCurrentSession(e,t,n,r,o){this.currentSession={startedAtInMs:performance.now(),timeoutInMs:e,effectId:t,effectParam:n,frameWidth:r,frameHeight:o},this.sampleCount=0,this.distributionBins.fill(0)}getNextTimeout(e,t){return t&&t.effectId===e?Math.min(pf.maxSessionTimeoutInMs,2*t.timeoutInMs):pf.initialSessionTimeoutInMs}}pf.initialSessionTimeoutInMs=1e3,pf.maxSessionTimeoutInMs=3e4;const gf="v2";class mf{constructor(e){this.reportPerformanceEvent=e,this.isFirstFrameProcessed=!1,this.frameProcessTimeLimit=100,this.frameProcessingStartedAt=0,this.frameProcessingTimeCost=0,this.processedFrameCount=0,this.performanceStatistics=new pf(mf.distributionBinSize,(e=>this.reportPerformanceEvent(Zn(gf,"videoPerformanceMonitor.performanceDataGenerated"),"video.performance.performanceDataGenerated",[e])))}startMonitorSlowFrameProcessing(){ff.setInterval((()=>{if(0===this.processedFrameCount)return;const e=this.frameProcessingTimeCost/this.processedFrameCount;e>this.frameProcessTimeLimit&&this.reportPerformanceEvent(Zn(gf,"videoPerformanceMonitor.startMonitorSlowFrameProcessing"),"video.performance.frameProcessingSlow",[e]),this.frameProcessingTimeCost=0,this.processedFrameCount=0}),mf.calculateFPSInterval)}setFrameProcessTimeLimit(e){this.frameProcessTimeLimit=e}reportApplyingVideoEffect(e,t){var n,r;(null===(n=this.applyingEffect)||void 0===n?void 0:n.effectId)===e&&(null===(r=this.applyingEffect)||void 0===r?void 0:r.effectParam)===t||(this.applyingEffect={effectId:e,effectParam:t},this.appliedEffect=void 0)}reportVideoEffectChanged(e,t){void 0===this.applyingEffect||this.applyingEffect.effectId!==e&&this.applyingEffect.effectParam!==t||(this.appliedEffect={effectId:e,effectParam:t},this.applyingEffect=void 0,this.isFirstFrameProcessed=!1)}reportStartFrameProcessing(e,t){ff.tick(),this.appliedEffect&&(this.frameProcessingStartedAt=performance.now(),this.performanceStatistics.processStarts(this.appliedEffect.effectId,e,t,this.appliedEffect.effectParam))}reportFrameProcessed(){var e;this.appliedEffect&&(this.processedFrameCount++,this.frameProcessingTimeCost+=performance.now()-this.frameProcessingStartedAt,this.performanceStatistics.processEnds(),this.isFirstFrameProcessed||(this.isFirstFrameProcessed=!0,this.reportPerformanceEvent(Zn(gf,"videoPerformanceMonitor.reportFrameProcessed"),"video.performance.firstFrameProcessed",[Date.now(),this.appliedEffect.effectId,null===(e=this.appliedEffect)||void 0===e?void 0:e.effectParam])))}reportGettingTextureStream(e){this.gettingTextureStreamStartedAt=performance.now(),this.currentStreamId=e}reportTextureStreamAcquired(){if(void 0!==this.gettingTextureStreamStartedAt){const e=performance.now()-this.gettingTextureStreamStartedAt;this.reportPerformanceEvent(Zn(gf,"videoPerformanceMonitor.reportTextureStreamAcquired"),"video.performance.textureStreamAcquired",[this.currentStreamId,e])}}}mf.distributionBinSize=1e3,mf.calculateFPSInterval=1e3;var hf=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))},vf=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};const wf="v2",Cf=Mn()?void 0:new mf(vc);var yf,Sf,bf;function Ef(e){if(Vr(ir,sn.sidePanel),!Of())throw pn;if(!e.videoFrameHandler||!e.videoBufferHandler)throw new Error("Both videoFrameHandler and videoBufferHandler must be provided");if(ws(Zn(wf,"videoEffects.setFrameProcessTimeLimitHandler"),"video.setFrameProcessTimeLimit",(e=>null==Cf?void 0:Cf.setFrameProcessTimeLimit(e.timeLimit)),!1),Nf())Rf(e.videoFrameHandler,e.config);else{if(!Df())throw pn;kf(e.videoBufferHandler,e.config)}null==Cf||Cf.startMonitorSlowFrameProcessing()}function Af(e,t){if(Vr(ir,sn.sidePanel),!Of())throw pn;vc(Zn(wf,"videoEffects.notifySelectedVideoEffectChanged"),"video.videoEffectChanged",[e,t])}function If(e){if(Vr(ir,sn.sidePanel),!Of())throw pn;ws(Zn(wf,"videoEffects.registerEffectParameterChangeHandler"),"video.effectParameterChange",Gf(e,Cf),!1),vc(Zn(wf,"videoEffects.registerForVideoEffect"),"video.registerForVideoEffect")}function Pf(e){vc(Zn(wf,"videoEffects.notifyVideoFrameProcessed"),"video.videoFrameProcessed",[e])}function Tf(e){vc(Zn(wf,"videoEffects.notifyError"),"video.notifyError",[e])}function Of(){return Vr(ir)&&!!ir.supports.video&&(!!ir.supports.video.mediaStream||!!ir.supports.video.sharedFrame)}function Rf(e,t){if(Vr(ir,sn.sidePanel),!Of()||!Nf())throw pn;ws(Zn(wf,"videoEffects.startVideoExtensibilityVideoStreamHandler"),"video.startVideoExtensibilityVideoStream",(t=>hf(this,void 0,void 0,(function*(){const{streamId:n}=t,r=Ff(e,Cf);yield Hf(n,r,Tf,Cf)}))),!1),vc(Zn(wf,"videoEffects.mediaStream.registerForVideoFrame"),"video.mediaStream.registerForVideoFrame",[t])}function Ff(e,t){return n=>hf(this,void 0,void 0,(function*(){const r=n.videoFrame;null==t||t.reportStartFrameProcessing(r.codedWidth,r.codedHeight);const o=yield e(n);return null==t||t.reportFrameProcessed(),o}))}function kf(e,t){if(Vr(ir,sn.sidePanel),!Of()||!Df())throw pn;ws(Zn(wf,"videoEffects.registerForVideoBufferHandler"),"video.newVideoFrame",(t=>{if(t){const n=t.timestamp;null==Cf||Cf.reportStartFrameProcessing(t.width,t.height),e(Mf(t),(()=>{null==Cf||Cf.reportFrameProcessed(),Pf(n)}),Tf)}}),!1),vc(Zn(wf,"videoEffects.registerForVideoFrame"),"video.registerForVideoFrame",[t])}function Mf(e){if("videoFrameBuffer"in e)return e;{const{data:t}=e,n=vf(e,["data"]);return Object.assign(Object.assign({},n),{videoFrameBuffer:t})}}function Nf(){var e;return Vr(ir,sn.sidePanel)&&xf()&&!!(null===(e=ir.supports.video)||void 0===e?void 0:e.mediaStream)}function xf(){var e,t,n,r;return!(!(null===(t=null===(e=kn().chrome)||void 0===e?void 0:e.webview)||void 0===t?void 0:t.getTextureStream)||!(null===(r=null===(n=kn().chrome)||void 0===n?void 0:n.webview)||void 0===r?void 0:r.registerTextureStream))}function Df(){var e;return Vr(ir,sn.sidePanel)&&!!(null===(e=ir.supports.video)||void 0===e?void 0:e.sharedFrame)}!function(e){e.NV12="NV12"}(yf||(yf={})),function(e){e.EffectChanged="EffectChanged",e.EffectDisabled="EffectDisabled"}(Sf||(Sf={})),function(e){e.InvalidEffectId="InvalidEffectId",e.InitializationFailure="InitializationFailure"}(bf||(bf={}));var Uf=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const Lf="v2";function Hf(e,t,n,r){var o,i;return Uf(this,void 0,void 0,(function*(){const a=Bf();!Mn()&&(null===(i=null===(o=window.chrome)||void 0===o?void 0:o.webview)||void 0===i||i.registerTextureStream(e,a)),Wf(yield Vf(e,n,r),new jf(n,t),a.writable)}))}function _f(e,t,n,r){var o,i;return Uf(this,void 0,void 0,(function*(){const a=Bf();!Mn()&&(null===(i=null===(o=window.chrome)||void 0===o?void 0:o.webview)||void 0===i||i.registerTextureStream(e,a)),Wf(yield Vf(e,n,r),new qf(n,t),a.writable)}))}function Vf(e,t,n){return Uf(this,void 0,void 0,(function*(){if(Mn())throw pn;const r=kn().chrome;try{null==n||n.reportGettingTextureStream(e);const t=(yield r.webview.getTextureStream(e)).getVideoTracks();if(0===t.length)throw new Error(`No video track in stream ${e}`);return null==n||n.reportTextureStreamAcquired(),t[0]}catch(n){throw t(`Failed to get video track from stream ${e}, error: ${n}`),new Error(`Internal error: can't get video track from stream ${e}`)}}))}function Bf(){if(Mn())throw pn;const e=window.MediaStreamTrackGenerator;if(!e)throw pn;return new e({kind:"video"})}function Wf(e,t,n){new(0,kn().MediaStreamTrackProcessor)({track:e}).readable.pipeThrough(new TransformStream(t)).pipeTo(n)}class jf{constructor(e,t){this.notifyError=e,this.videoFrameHandler=t,this.transform=(e,t)=>Uf(this,void 0,void 0,(function*(){const n=e.timestamp;if(null!==n)try{const r=yield this.videoFrameHandler({videoFrame:e}),o=new VideoFrame(r,{timestamp:n});t.enqueue(o),e.close(),r.close()}catch(t){e.close(),this.notifyError(t)}else this.notifyError("timestamp of the original video frame is null")}))}}class zf{constructor(e,t){if(this.headerBuffer=e,this.notifyError=t,this.ONE_TEXTURE_INPUT_ID=1869900081,this.INVALID_HEADER_ERROR="Invalid video frame header",this.UNSUPPORTED_LAYOUT_ERROR="Unsupported texture layout",this.headerDataView=new Uint32Array(e),this.headerDataView.length<8)throw this.notifyError(this.INVALID_HEADER_ERROR),new Error(this.INVALID_HEADER_ERROR);if(this.headerDataView[0]!==this.ONE_TEXTURE_INPUT_ID)throw this.notifyError(this.UNSUPPORTED_LAYOUT_ERROR),new Error(this.UNSUPPORTED_LAYOUT_ERROR)}get oneTextureLayoutId(){return this.headerDataView[0]}get version(){return this.headerDataView[1]}get frameRowOffset(){return this.headerDataView[2]}get frameFormat(){return this.headerDataView[3]}get frameWidth(){return this.headerDataView[4]}get frameHeight(){return this.headerDataView[5]}get multiStreamHeaderRowOffset(){return this.headerDataView[6]}get multiStreamCount(){return this.headerDataView[7]}}class $f{constructor(e,t){this.metadataMap=new Map,this.AUDIO_INFERENCE_RESULT_STREAM_ID=828664161,this.ATTRIBUTE_ID_MAP_STREAM_ID=1296320833;const n=new Uint32Array(e);for(let r=0,o=0;r<t;r++){const t=n[o++],r=n[o++],i=n[o++],a=new Uint8Array(e,r,i);this.metadataMap.set(t,a)}}get audioInferenceResult(){return this.metadataMap.get(this.AUDIO_INFERENCE_RESULT_STREAM_ID)}get attributes(){const e=this.metadataMap.get(this.ATTRIBUTE_ID_MAP_STREAM_ID);if(void 0===e)return;const t=new Map,n=new TextDecoder("utf-8");let r=0;const o=e[r]+(e[++r]<<8)+(e[++r]<<16)+(e[++r]<<24);for(let i=0;i<o&&r<e.length-1;i++){const o=e[++r]+(e[++r]<<8)+(e[++r]<<16)+(e[++r]<<24),i=e.findIndex(((e,t,n)=>0==e&&t>r)),a=n.decode(e.slice(++r,i)),s=this.metadataMap.get(o);void 0!==s&&t.set(a,s);r=i+(4-(i-r)%4-1)}return t}}class qf{constructor(e,t){this.notifyError=e,this.videoFrameHandler=t,this.shouldDiscardAudioInferenceResult=!1,this.transform=(e,t)=>Uf(this,void 0,void 0,(function*(){const n=e.timestamp;if(null!==n)try{const{videoFrame:r,metadata:{audioInferenceResult:o,attributes:i}={}}=yield this.extractVideoFrameAndMetadata(e),a=yield this.videoFrameHandler({videoFrame:r,audioInferenceResult:o,attributes:i}),s=new VideoFrame(a,{timestamp:n});t.enqueue(s),r.close(),e.close(),a.close()}catch(t){e.close(),this.notifyError(t)}else this.notifyError("timestamp of the original video frame is null")})),this.extractVideoFrameAndMetadata=e=>Uf(this,void 0,void 0,(function*(){if(Mn())throw pn;if("NV12"!==e.format)throw this.notifyError("Unsupported video frame pixel format"),new Error("Unsupported video frame pixel format");const t={x:0,y:0,width:e.codedWidth,height:2},n=new ArrayBuffer(t.width*t.height*3/2);yield e.copyTo(n,{rect:t});const r=new zf(n,this.notifyError),o={x:0,y:r.multiStreamHeaderRowOffset,width:e.codedWidth,height:e.codedHeight-r.multiStreamHeaderRowOffset},i=new ArrayBuffer(o.width*o.height*3/2);yield e.copyTo(i,{rect:o});const a=new $f(i,r.multiStreamCount);return{videoFrame:new VideoFrame(e,{timestamp:e.timestamp,visibleRect:{x:0,y:r.frameRowOffset,width:r.frameWidth,height:r.frameHeight}}),metadata:{audioInferenceResult:this.shouldDiscardAudioInferenceResult?void 0:a.audioInferenceResult,attributes:a.attributes}}})),ws(Zn(Lf,"videoEffectsUtils.transformerWithMetadata.constructor"),"video.mediaStream.audioInferenceDiscardStatusChange",(({discardAudioInferenceResult:e})=>{this.shouldDiscardAudioInferenceResult=e}))}}function Gf(e,t){return(n,r)=>{null==t||t.reportApplyingVideoEffect(n||"",r),e(n,r).then((()=>{null==t||t.reportVideoEffectChanged(n||"",r),vc(Zn(Lf,"videoEffectsUtils.reportVideoEffectChanged"),"video.videoEffectReadiness",[!0,n,void 0,r])})).catch((e=>{const t=e in bf?e:bf.InitializationFailure;vc(Zn(Lf,"videoEffectsUtils.effectFailure"),"video.videoEffectReadiness",[!1,n,t,r])}))}}var Jf=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const Kf="v2",Qf=2e3,Zf=Mn()?void 0:new mf(vc);var Xf;function Yf(e){var t,n;if(!ap())throw pn;if(!e.videoFrameHandler||!e.videoBufferHandler)throw new Error("Both videoFrameHandler and videoBufferHandler must be provided");if(Vr(ir,sn.sidePanel)){if(ws(Zn(Kf,"videoEffectsEX.registerSetFrameProcessTimeLimitHandler"),"video.setFrameProcessTimeLimit",(e=>null==Zf?void 0:Zf.setFrameProcessTimeLimit(e)),!1),null===(t=ir.supports.video)||void 0===t?void 0:t.mediaStream)ws(Zn(Kf,"videoEffectsEX.registerStartVideoExtensibilityVideoStreamHandler"),"video.startVideoExtensibilityVideoStream",(t=>Jf(this,void 0,void 0,(function*(){const{streamId:n,metadataInTexture:r}=t,o=Zf?tp(e.videoFrameHandler,Zf):e.videoFrameHandler;r?yield _f(n,o,cp,Zf):yield Hf(n,o,cp,Zf)}))),!1),vc(Zn(Kf,"videoEffectsEX.mediaStream.registerForVideoFrame"),"video.mediaStream.registerForVideoFrame",[e.config]);else{if(!(null===(n=ir.supports.video)||void 0===n?void 0:n.sharedFrame))throw pn;ws(Zn(Kf,"videoEffectsEx.registerNewVideoFrameHandler"),"video.newVideoFrame",(t=>{if(t){null==Zf||Zf.reportStartFrameProcessing(t.width,t.height);const n=ep(),r=t.timestamp;e.videoBufferHandler(np(t),(()=>{n(),null==Zf||Zf.reportFrameProcessed(),sp(r)}),cp)}}),!1),vc(Zn(Kf,"videoEffectsEx.registerForVideoFrame"),"video.registerForVideoFrame",[e.config])}null==Zf||Zf.startMonitorSlowFrameProcessing()}}function ep(){const e=setTimeout((()=>{cp(`Frame not processed in ${Qf}ms`,Xf.Warn)}),Qf);return function(){clearTimeout(e)}}function tp(e,t){return n=>Jf(this,void 0,void 0,(function*(){const r=n.videoFrame;t.reportStartFrameProcessing(r.codedWidth,r.codedHeight);const o=ep(),i=yield e(n);return o(),t.reportFrameProcessed(),i}))}function np(e){return e.videoFrameBuffer=e.videoFrameBuffer||e.data,delete e.data,e}function rp(e,t,n){if(Vr(ir,sn.sidePanel),!ap())throw pn;vc(Zn(Kf,"videoEffectsEx.notifySelectedVideoEffectChanged"),"video.videoEffectChanged",[e,t,n])}function op(e){if(Vr(ir,sn.sidePanel),!ap())throw pn;ws(Zn(Kf,"videoEffectsEx.registerEffectParamterChangeHandler"),"video.effectParameterChange",Gf(e,Zf),!1),vc(Zn(Kf,"videoEffectsEx.registerForVideoEffect"),"video.registerForVideoEffect")}function ip(e){if(Vr(ir,sn.sidePanel),!Of())throw pn;vc(Zn(Kf,"videoEffectsEx.updatePersonalizedEffects"),"video.personalizedEffectsChanged",[e])}function ap(){return Vr(ir),Of()}function sp(e){vc(Zn(Kf,"videoEffectsEx.notifyVideoFrameProcessed"),"video.videoFrameProcessed",[e])}function cp(e,t=Xf.Warn){vc(Zn(Kf,"videoEffectsEx.notifyError"),"video.notifyError",[e,t])}function up(e){if(Vr(ir),!Of())throw pn;cp(e,Xf.Fatal)}!function(e){e.Fatal="fatal",e.Warn="warn"}(Xf||(Xf={}));const lp="v2";class dp extends Wi{validate(e){return"ConfigurableTab"===e.tabType}deserialize(e){return e}}class fp{constructor(e){this.configurableTabInstance=e}serialize(){return this.configurableTabInstance}}class pp{constructor(e){this.hostEntityId=e}serialize(){return this.hostEntityId}}class gp extends Wi{validate(e){return"ConfigurableTab"===e.tabType||"StaticTab"===e.tabType}deserialize(e){return e}}class mp{constructor(e){this.hostEntityTabInstance=e}serialize(){return this.hostEntityTabInstance}}class hp extends Wi{validate(e){const t=new gp;let n=!0;return e.allTabs&&e.allTabs.forEach((e=>{n||(n=t.validate(e))})),n}deserialize(e){return e}}function vp(e,t){if(Vr(ir),!bp())throw new Error(`Error code: ${xe.NOT_SUPPORTED_ON_PLATFORM}, message: Not supported on platform`);if(Ep(e.threadId),t&&0===t.length)throw new Error(`Error code: ${xe.INVALID_ARGUMENTS}, message: App types cannot be an empty array`);return fc("hostEntity.tab.addAndConfigure",[new pp(e),t],new gp,Zn(lp,"hostEntity.tab.addAndConfigure"))}function wp(e){if(Vr(ir),!bp())throw new Error(`Error code: ${xe.NOT_SUPPORTED_ON_PLATFORM}, message: Not supported on platform`);return Ep(e.threadId),fc("hostEntity.tab.getAll",[new pp(e)],new hp,Zn(lp,"hostEntity.tab.getAll"))}function Cp(e,t){if(Vr(ir),!bp())throw new Error(`Error code: ${xe.NOT_SUPPORTED_ON_PLATFORM}, message: Not supported on platform`);return Ap(e),Ep(t.threadId),fc("hostEntity.tab.reconfigure",[new fp(e),new pp(t)],new dp,Zn(lp,"hostEntity.tab.reconfigure"))}function yp(e,t){if(Vr(ir),!bp())throw new Error(`Error code: ${xe.NOT_SUPPORTED_ON_PLATFORM}, message: Not supported on platform`);return Ap(e),Ep(t.threadId),fc("hostEntity.tab.rename",[new fp(e),new pp(t)],new dp,Zn(lp,"hostEntity.tab.rename"))}function Sp(e,t){if(Vr(ir),!bp())throw new Error(`Error code: ${xe.NOT_SUPPORTED_ON_PLATFORM}, message: Not supported on platform`);return Ep(t.threadId),Ap(e),fc("hostEntity.tab.remove",[new mp(e),new pp(t)],new ji,Zn(lp,"hostEntity.tab.remove"))}function bp(){var e;return!!(Vr(ir)&&Pp()&&(null===(e=ir.supports.hostEntity)||void 0===e?void 0:e.tab))}function Ep(e){if(!e||0==e.length)throw new Error(`Error code: ${xe.INVALID_ARGUMENTS}, message: ThreadId cannot be null or empty`)}function Ap(e){if(!(null==e?void 0:e.internalTabInstanceId)||0===e.internalTabInstanceId.length)throw new Error(`Error code: ${xe.INVALID_ARGUMENTS}, message: TabId cannot be null or empty`)}var Ip;function Pp(){return!(!Vr(ir)||!ir.supports.hostEntity)}!function(e){e.edu="EDU",e.baseTownhall="BASE_TOWNHALL",e.streamingTownhall="STREAMING_TOWNHALL"}(Ip||(Ip={}));var Tp=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const Op="v2",Rp="Invalid store dialog size",Fp="No App Id present, but AppId needed to open AppDetail store",kp="No Collection Id present, but CollectionId needed to open a store specific to a collection";function Mp(e){return Tp(this,void 0,void 0,(function*(){Lp();const{size:t}=null!=e?e:{};return pc("store.openFullStore",[Hp(t)],Zn(Op,"store.openFullStore"))}))}function Np(e){return Tp(this,void 0,void 0,(function*(){Lp();const{size:t,appId:n}=e;if(!(n instanceof Yr))throw new Error(Fp);return pc("store.openAppDetail",[Hp(t),n],Zn(Op,"store.openAppDetail"))}))}function xp(e){return Tp(this,void 0,void 0,(function*(){Lp();const{size:t,appCapability:n,appMetaCapabilities:r,installationScope:o,filteredOutAppIds:i}=null!=e?e:{};return pc("store.openInContextStore",[Hp(t),n,r,o,null==i?void 0:i.map((e=>e.toString()))],Zn(Op,"store.openInContextStore"))}))}function Dp(e){return Tp(this,void 0,void 0,(function*(){Lp();const{size:t,collectionId:n}=e;if(void 0===n)throw new Error(kp);return pc("store.openSpecificStore",[Hp(t),n],Zn(Op,"store.openSpecificStore"))}))}function Up(){return Vr(ir)&&!!ir.supports.store}function Lp(){if(Vr(ir,sn.content,sn.sidePanel,sn.meetingStage),!Up())throw pn}function Hp(e){if(void 0===e)return;const{width:t,height:n}=e;if(void 0!==t&&"number"==typeof t&&t<0)throw new Error(Rp);if(void 0!==n&&"number"==typeof n&&n<0)throw new Error(Rp);return JSON.stringify(e)}var _p=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const Vp="v1",Bp="v2";let Wp;function jp(e){Wp=e}function zp(e){const t=void 0!==e,n=t?e:Wp;if(!n)throw new Error("No parameters are provided for authentication");Vr(ir,sn.content,sn.sidePanel,sn.settings,sn.remove,sn.task,sn.stage,sn.meetingStage);return $p(n.successCallback||n.failureCallback?Zn(Vp,"authentication.authenticate"):Zn(Bp,"authentication.authenticate"),n).then((e=>{try{return n&&n.successCallback?(n.successCallback(e),""):e}finally{t||(Wp=void 0)}})).catch((e=>{try{if(n&&n.failureCallback)return n.failureCallback(e.message),"";throw e}finally{t||(Wp=void 0)}}))}function $p(e,t){return _p(this,void 0,void 0,(function*(){const n=Dn(t.url);return xn(n),lc(e,"authentication.authenticate",[n.href,t.width,t.height,t.isExternal]).then((([e,t])=>{if(e)return t;throw new Error(t)}))}))}function qp(e){_r();return Gp(e&&(e.successCallback||e.failureCallback)?Zn(Vp,"authentication.getAuthToken"):Zn(Bp,"authentication.getAuthToken"),e).then((t=>e&&e.successCallback?(e.successCallback(t),""):t)).catch((t=>{if(e&&e.failureCallback)return e.failureCallback(t.message),"";throw t}))}function Gp(e,t){return new Promise((n=>{n(lc(e,"authentication.getAuthToken",[null==t?void 0:t.resources,null==t?void 0:t.claims,null==t?void 0:t.silent,null==t?void 0:t.tenantId]))})).then((([e,t])=>{if(e)return t;throw new Error(t)}))}function Jp(e){_r();return Kp(e&&(e.successCallback||e.failureCallback)?Zn(Vp,"authentication.getUser"):Zn(Bp,"authentication.getUser")).then((t=>e&&e.successCallback?(e.successCallback(t),null):t)).catch((t=>{const n=`Error returned, code = ${t.errorCode}, message = ${t.message}`;if(e&&e.failureCallback)return e.failureCallback(n),null;throw new Error(n)}))}function Kp(e){return new Promise((t=>{t(lc(e,"authentication.getUser"))})).then((([e,t])=>{if(e)return t;throw t}))}function Qp(e,t){Vr(ir,sn.authentication);vc(Zn(t?Vp:Bp,"authentication.notifySuccess"),"authentication.authenticate.success",[e]),Bc(nc.parentWindow,(()=>setTimeout((()=>nc.currentWindow.close()),200)))}function Zp(e,t){Vr(ir,sn.authentication);vc(Zn(t?Vp:Bp,"authentication.notifyFailure"),"authentication.authenticate.failure",[e]),Bc(nc.parentWindow,(()=>setTimeout((()=>nc.currentWindow.close()),200)))}var Xp;function Yp(e){const t=!e||e.length<=0,n=null==e?void 0:e.indexOf("@"),r=null==e?void 0:e.indexOf(".",n);if(t||-1===n||-1===r)throw new Error("Input email address does not have the correct format.")}!function(e){e.Public="public",e.EUDB="eudb",e.Other="other"}(Xp||(Xp={}));class eg{constructor(e){this.val=e,Yp(e)}toString(){return this.val}}const tg="/l/app/",ng="/l/meeting/new",rg="attendees",og="startTime",ig="endTime",ag="subject",sg="content",cg="/l/call/0/0",ug="source",lg="withVideo",dg="/l/chat/0/0",fg="users",pg="topicName",gg="message";function mg(e,t,n){if(0===e.length)throw new Error("Must have at least one user when creating a chat deep link");const r=`${fg}=`+e.map((e=>encodeURIComponent(e))).join(","),o=void 0===t?"":`&${pg}=${encodeURIComponent(t)}`,i=void 0===n?"":`&${gg}=${encodeURIComponent(n)}`;return`${ot}://${it}${dg}?${r}${o}${i}`}function hg(e,t,n){if(0===e.length)throw new Error("Must have at least one target when creating a call deep link");const r=`${fg}=`+e.map((e=>encodeURIComponent(e))).join(","),o=void 0===t?"":`&${lg}=${encodeURIComponent(t)}`,i=void 0===n?"":`&${ug}=${encodeURIComponent(n)}`;return`${ot}://${it}${cg}?${r}${o}${i}`}function vg(e,t,n,r,o){const i=void 0===e?"":`${rg}=`+e.map((e=>encodeURIComponent(e))).join(","),a=void 0===t?"":`&${og}=${encodeURIComponent(t)}`,s=void 0===n?"":`&${ig}=${encodeURIComponent(n)}`,c=void 0===r?"":`&${ag}=${encodeURIComponent(r)}`,u=void 0===o?"":`&${sg}=${encodeURIComponent(o)}`;return`${ot}://${it}${ng}?${i}${a}${s}${c}${u}`}function wg(e){if(!e)throw new Error("App ID must be set when creating an app install dialog deep link");return`${ot}://${it}${tg}${encodeURIComponent(e)}`}const Cg="v1";function yg(e){return new Promise((t=>{if(Vr(ir,sn.content,sn.sidePanel,sn.settings,sn.task,sn.stage,sn.meetingStage),!Sg())throw new Error("Not supported");const n=Zn(Cg,"appInstallDialog.openAppInstallDialog");ir.isLegacyTeams?t(sc(n,"executeDeepLink",wg(e.appId))):(vc(n,"appInstallDialog.openAppInstallDialog",[e]),t())}))}function Sg(){return!(!Vr(ir)||!ir.supports.appInstallDialog)}const bg="v1",Eg=Qn("media");var Ag,Ig,Pg,Tg,Og,Rg,Fg;!function(e){e.Base64="base64",e.ID="id"}(Ag||(Ag={}));class kg{}function Mg(e){if(!e)throw new Error("[captureImage] Callback cannot be null");if(Vr(ir,sn.content,sn.task),$n.isFramelessWindow)if(Br(Ze))vc(Zn(bg,"media.captureImage"),"captureImage",e);else{e({errorCode:xe.OLD_PLATFORM},[])}else{e({errorCode:xe.NOT_SUPPORTED_ON_PLATFORM},[])}}function Ng(){if(Vr(ir,sn.content,sn.task),!Dg())throw pn;const e=De.Media;return new Promise((t=>{t(uc(Zn(bg,"media.hasPermission"),"permissions.has",e))}))}function xg(){if(Vr(ir,sn.content,sn.task),!Dg())throw pn;const e=De.Media;return new Promise((t=>{t(uc(Zn(bg,"media.requestPermission"),"permissions.request",e))}))}function Dg(){return!(!Vr(ir)||!ir.supports.permissions)}class Ug extends kg{constructor(e){super(),e&&(this.content=e.content,this.format=e.format,this.mimeType=e.mimeType,this.name=e.name,this.preview=e.preview,this.size=e.size)}getMedia(e){if(!e)throw new Error("[get Media] Callback cannot be null");if(Vr(ir,sn.content,sn.task),Br(Xe))if(Qg(this.mimeType,this.format,this.content))Br("2.0.0")?this.getMediaViaCallback(e):this.getMediaViaHandler(e);else{e({errorCode:xe.INVALID_ARGUMENTS},new Blob)}else{e({errorCode:xe.OLD_PLATFORM},new Blob)}}getMediaViaCallback(e){const t={mediaMimeType:this.mimeType,assembleAttachment:[]},n=[this.content];vc(Zn(bg,"media.getMedia"),"getMedia",n,(function(n){if(e)if(n&&n.error)e(n.error,new Blob);else if(n&&n.mediaChunk)if(n.mediaChunk.chunkSequence<=0){const r=Wg(t.assembleAttachment,t.mediaMimeType);e(n.error,null!=r?r:new Blob)}else{const e=jg(n.mediaChunk,t.mediaMimeType);e?t.assembleAttachment.push(e):Eg(`Received a null assemble attachment for when decoding chunk sequence ${n.mediaChunk.chunkSequence}; not including the chunk in the assembled file.`)}else e({errorCode:xe.INTERNAL_ERROR,message:"data received is null"},new Blob)}))}getMediaViaHandler(e){const t=yn(),n={mediaMimeType:this.mimeType,assembleAttachment:[]},r=[t,this.content];this.content&&!eo(e)&&vc(Zn(bg,"media.getMedia"),"getMedia",r),ws(Zn(bg,"media.registerGetMediaRequestHandler"),"getMedia"+t,(function(r){if(e){const o=JSON.parse(r);if(o.error)e(o.error,new Blob),Cs("getMedia"+t);else if(o.mediaChunk)if(o.mediaChunk.chunkSequence<=0){const r=Wg(n.assembleAttachment,n.mediaMimeType);e(o.error,null!=r?r:new Blob),Cs("getMedia"+t)}else{const e=jg(o.mediaChunk,n.mediaMimeType);e&&n.assembleAttachment.push(e)}else e({errorCode:xe.INTERNAL_ERROR,message:"data received is null"},new Blob),Cs("getMedia"+t)}}))}}class Lg{constructor(e){this.controllerCallback=e}notifyEventToHost(e,t){Vr(ir,sn.content,sn.task);try{jr(qe)}catch(e){return void(t&&t(e))}const n={mediaType:this.getMediaType(),mediaControllerEvent:e};vc(Zn(bg,"media.controller"),"media.controller",[n],(e=>{t&&t(e)}))}stop(e){this.notifyEventToHost(Ig.StopRecording,e)}}class Hg extends Lg{getMediaType(){return Og.Video}notifyEventToApp(e){if(this.controllerCallback)switch(e){case Ig.StartRecording:if(this.controllerCallback.onRecordingStarted){this.controllerCallback.onRecordingStarted();break}}}}function _g(e,t){if(!t)throw new Error("[select Media] Callback cannot be null");if(Vr(ir,sn.content,sn.task),!Br(Xe)){const e={errorCode:xe.OLD_PLATFORM};return void t(e,[])}try{zg(e)}catch(e){return void t(e,[])}if(!qg(e)){const e={errorCode:xe.INVALID_ARGUMENTS};return void t(e,[])}const n=[e];vc(Zn(bg,"media.selectMedia"),"selectMedia",n,((n,r,o)=>{var i,a;if(o)return void($g(e)&&(null===(a=null===(i=null==e?void 0:e.videoProps)||void 0===i?void 0:i.videoController)||void 0===a||a.notifyEventToApp(o)));if(!r)return void t(n,[]);const s=[];for(const e of r)s.push(new Ug(e));t(n,s)}))}function Vg(e,t){if(!t)throw new Error("[view images] Callback cannot be null");if(Vr(ir,sn.content,sn.task),!Br(Xe)){return void t({errorCode:xe.OLD_PLATFORM})}if(!Zg(e)){return void t({errorCode:xe.INVALID_ARGUMENTS})}const n=[e];vc(Zn(bg,"media.viewImages"),"viewImages",n,t)}function Bg(e,t){if(!e)throw new Error("[media.scanBarCode] Callback cannot be null");if(Vr(ir,sn.content,sn.task),$n.hostClientType!==on.desktop&&$n.hostClientType!==on.web&&$n.hostClientType!==on.rigel&&$n.hostClientType!==on.teamsRoomsWindows&&$n.hostClientType!==on.teamsRoomsAndroid&&$n.hostClientType!==on.teamsPhones&&$n.hostClientType!==on.teamsDisplays)if(Br(Ye))if(Xg(t))vc(Zn(bg,"media.scanBarCode"),"media.scanBarCode",[t],e);else{e({errorCode:xe.INVALID_ARGUMENTS},"")}else{e({errorCode:xe.OLD_PLATFORM},"")}else{e({errorCode:xe.NOT_SUPPORTED_ON_PLATFORM},"")}}function Wg(e,t){if(null==e||null==t||e.length<=0)return null;let n=null,r=1;return e.sort(((e,t)=>e.sequence>t.sequence?1:-1)),e.forEach((e=>{e.sequence==r&&(n=n?new Blob([n,e.file],{type:t}):new Blob([e.file],{type:t}),r++)})),n}function jg(e,t){if(null==e||null==t)return null;const n=atob(e.chunk),r=new Array(n.length);for(let e=0;e<n.length;e++)r[e]=n.charCodeAt(e);const o=new Uint8Array(r),i=new Blob([o],{type:t});return{sequence:e.chunkSequence,file:i}}function zg(e){Jg(e)?jr($e):Kg(e)?jr(qe):Gg(e)&&jr(Ge)}function $g(e){return!(e.mediaType!=Og.Video||!e.videoProps||!e.videoProps.videoController)}function qg(e){return!(null==e||e.maxMediaCount>10)}function Gg(e){var t;return!((null==e?void 0:e.mediaType)!=Og.Image||!(null===(t=null==e?void 0:e.imageProps)||void 0===t?void 0:t.imageOutputFormats))}function Jg(e){return!(!e||e.mediaType!=Og.VideoAndImage&&!e.videoAndImageProps)}function Kg(e){return!(!e||e.mediaType!=Og.Video||!e.videoProps||e.videoProps.isFullScreenMode)}function Qg(e,t,n){return null!=e&&null!=t&&t==Ag.ID&&null!=n}function Zg(e){return!(null==e||e.length<=0||e.length>10)}function Xg(e){return!e||!(null===e.timeOutIntervalInSec||null!=e.timeOutIntervalInSec&&e.timeOutIntervalInSec<=0||null!=e.timeOutIntervalInSec&&e.timeOutIntervalInSec>60)}function Yg(e){if(e){if(e.title&&"string"!=typeof e.title)return!1;if(e.setSelected&&"object"!=typeof e.setSelected)return!1;if(e.openOrgWideSearchInChatOrChannel&&"boolean"!=typeof e.openOrgWideSearchInChatOrChannel)return!1;if(e.singleSelect&&"boolean"!=typeof e.singleSelect)return!1}return!0}!function(e){e[e.StartRecording=1]="StartRecording",e[e.StopRecording=2]="StopRecording"}(Ig||(Ig={})),function(e){e[e.Photo=1]="Photo",e[e.Document=2]="Document",e[e.Whiteboard=3]="Whiteboard",e[e.BusinessCard=4]="BusinessCard"}(Pg||(Pg={})),function(e){e[e.Camera=1]="Camera",e[e.Gallery=2]="Gallery"}(Tg||(Tg={})),function(e){e[e.Image=1]="Image",e[e.Video=2]="Video",e[e.VideoAndImage=3]="VideoAndImage",e[e.Audio=4]="Audio"}(Og||(Og={})),function(e){e[e.ID=1]="ID",e[e.URL=2]="URL"}(Rg||(Rg={})),function(e){e[e.IMAGE=1]="IMAGE",e[e.PDF=2]="PDF"}(Fg||(Fg={}));const em="v2";function tm(e){return new Promise((t=>{if(Vr(ir,sn.content,sn.task),!om())throw pn;if(!Xg(e))throw{errorCode:xe.INVALID_ARGUMENTS};t(uc(Zn(em,"barCode.scanBarCode"),"media.scanBarCode",e))}))}function nm(){if(Vr(ir,sn.content,sn.task),!om())throw pn;const e=De.Media;return new Promise((t=>{t(uc(Zn(em,"barCode.hasPermission"),"permissions.has",e))}))}function rm(){if(Vr(ir,sn.content,sn.task),!om())throw pn;const e=De.Media;return new Promise((t=>{t(uc(Zn(em,"barCode.requestPermission"),"permissions.request",e))}))}function om(){return!!(Vr(ir)&&ir.supports.barCode&&ir.supports.permissions)}const im="v2";function am(e){return sm(Zn(im,"chat.openChat"),e)}function sm(e,t){return new Promise((n=>{if(Vr(ir,sn.content,sn.task),!um())throw pn;if(ir.isLegacyTeams)n(sc(e,"executeDeepLink",mg([t.user],void 0,t.message)));else{n(sc(e,"chat.openChat",{members:[t.user],message:t.message}))}}))}function cm(e){const t=Zn(im,"chat.openGroupChat");return new Promise((n=>{if(e.users.length<1)throw Error("OpenGroupChat Failed: No users specified");if(1===e.users.length){const r={user:e.users[0],message:e.message};n(sm(t,r))}else{if(Vr(ir,sn.content,sn.task),!um())throw pn;if(ir.isLegacyTeams)n(sc(t,"executeDeepLink",mg(e.users,e.topic,e.message)));else{n(sc(t,"chat.openChat",{members:e.users,message:e.message,topic:e.topic}))}}}))}function um(){return!(!Vr(ir)||!ir.supports.chat)}var lm=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const dm="v2";function fm(e){return lm(this,void 0,void 0,(function*(){if(Vr(ir,sn.content,sn.meetingStage,sn.task,sn.settings,sn.stage,sn.sidePanel),!gm())throw pn;if(!e.type||!Object.values(Ve).includes(e.type))throw new Error(`Blob type ${e.type} is not supported. Supported blob types are ${Object.values(Ve)}`);const t=yield Fn(e),n={mimeType:e.type,content:t};return uc(Zn(dm,"clipboard.write"),"clipboard.writeToClipboard",n)}))}function pm(){return lm(this,void 0,void 0,(function*(){Vr(ir,sn.content,sn.meetingStage,sn.task,sn.settings,sn.stage,sn.sidePanel);const e=Zn(dm,"clipboard.read");if(!gm())throw pn;const t=yield uc(e,"clipboard.readFromClipboard");if("string"==typeof t){const e=JSON.parse(t);return Rn(e.mimeType,e.content)}return t}))}function gm(){return $n.isFramelessWindow?!(!Vr(ir)||!ir.supports.clipboard):!!(Vr(ir)&&navigator&&navigator.clipboard&&ir.supports.clipboard)}var mm=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const hm="v2",vm={validate:e=>Array.isArray(e)||"object"==typeof e,deserialize:e=>e};var wm;function Cm(){var e;return null!==(e=Vr(ir)&&(ir.isNAAChannelRecommended||Am()))&&void 0!==e&&e}function ym(){return Vr(ir),nc.parentOrigin}function Sm(){var e;return null!==(e=Vr(ir)&&ir.canParentManageNAATrustedOrigins)&&void 0!==e&&e}function bm(){var e;return null!==(e=Vr(ir)&&(ir.isDeeplyNestedAuthSupported||Em()))&&void 0!==e&&e}function Em(){return!!(Vr(ir)&&Im()&&ir.isLegacyTeams&&Br(fr))}function Am(){return!!(Vr(ir)&&Im()&&ir.isLegacyTeams&&ir.supports.nestedAppAuth)}function Im(){return $n.hostClientType===on.android||$n.hostClientType===on.ios||$n.hostClientType===on.ipados||$n.hostClientType===on.visionOS}function Pm(e){return mm(this,void 0,void 0,(function*(){if(!Sm())throw pn;const t=e.map(Rm);return Om(wm.ADD,t)}))}function Tm(e){return mm(this,void 0,void 0,(function*(){if(!Sm())throw pn;const t=e.map(Rm);return Om(wm.DELETE,t)}))}function Om(e,t){return mm(this,void 0,void 0,(function*(){if(window.parent!==window.top)throw new Error("This API is only available in the top-level parent.");if(!Array.isArray(t)||0===t.length)throw new Error(`The '${t}' parameter is required and must be a non-empty array.`);return fc("nestedAppAuth.manageNAATrustedOrigins",[new Fm(e,t)],vm,Zn(hm,"nestedAppAuth.manageNAATrustedOrigins"))}))}function Rm(e){try{return new URL(e).origin.toLowerCase()}catch(t){throw new Error(`Invalid origin provided: ${e}`)}}!function(e){e.ADD="ADD",e.DELETE="DELETE"}(wm||(wm={}));class Fm{constructor(e,t){this.action=e,this.appOrigins=t}serialize(){return{action:this.action,appOrigins:this.appOrigins}}}const km="v2";function Mm(){if(Vr(ir,sn.content,sn.task),!xm())throw pn;return uc(Zn(km,"geoLocation.map.chooseLocation"),"location.getLocation",{allowChooseLocation:!0,showMap:!0})}function Nm(e){if(Vr(ir,sn.content,sn.task),!xm())throw pn;if(!e)throw{errorCode:xe.INVALID_ARGUMENTS};return uc(Zn(km,"geoLocation.showLocation"),"location.showLocation",e)}function xm(){return!!(Vr(ir)&&ir.supports.geoLocation&&ir.supports.geoLocation.map&&ir.supports.permissions)}const Dm="v2";function Um(){if(Vr(ir,sn.content,sn.task),!_m())throw pn;return uc(Zn(Dm,"geoLocation.getCurrentLocation"),"location.getLocation",{allowChooseLocation:!1,showMap:!1})}function Lm(){if(Vr(ir,sn.content,sn.task),!_m())throw pn;const e=De.GeoLocation;return new Promise((t=>{t(uc(Zn(Dm,"geoLocation.hasPermission"),"permissions.has",e))}))}function Hm(){if(Vr(ir,sn.content,sn.task),!_m())throw pn;const e=De.GeoLocation;return new Promise((t=>{t(uc(Zn(Dm,"geoLocation.requestPermission"),"permissions.request",e))}))}function _m(){return!!(Vr(ir)&&ir.supports.geoLocation&&ir.supports.permissions)}function Vm(){return ir.hostVersionsInfo?ir.hostVersionsInfo.adaptiveCardSchemaVersion:void 0}const Bm="v1";class Wm{postMessage(e,t){Vr(ir),vc(Zn(Bm,"appWindow.childAppWindow.postMessage"),"messageForChild",[e],t||wn())}addEventListener(e,t){Vr(ir),"message"===e&&ws(Zn(Bm,"appWindow.childAppWindow.addEventListener"),"messageForParent",t)}}class jm{static get Instance(){return this._instance||(this._instance=new this)}postMessage(e,t){Vr(ir,sn.task),vc(Zn(Bm,"appWindow.parentAppWindow.postMessage"),"messageForParent",[e],t||wn())}addEventListener(e,t){Vr(ir,sn.task),"message"===e&&ws(Zn(Bm,"appWindow.parentAppWindow.addEventListener"),"messageForChild",t)}}const zm="v2";function $m(e){if(Vr(ir,sn.content),!qm())throw pn;if(!e||!On(e))throw{errorCode:xe.INVALID_ARGUMENTS,message:"Invalid Url: Only https URL is allowed"};return uc(Zn(zm,"secondaryBrowser.openUrl"),"secondaryBrowser.open",e.toString())}function qm(){return!(!Vr(ir)||!ir.supports.secondaryBrowser)}const Gm="v1";function Jm(e,t){if(!t)throw new Error("[location.getLocation] Callback cannot be null");if(Vr(ir,sn.content,sn.task),!Br(Ke))throw{errorCode:xe.OLD_PLATFORM};if(!e)throw{errorCode:xe.INVALID_ARGUMENTS};if(!Qm())throw pn;vc(Zn(Gm,"location.getLocation"),"location.getLocation",[e],t)}function Km(e,t){if(!t)throw new Error("[location.showLocation] Callback cannot be null");if(Vr(ir,sn.content,sn.task),!Br(Ke))throw{errorCode:xe.OLD_PLATFORM};if(!e)throw{errorCode:xe.INVALID_ARGUMENTS};if(!Qm())throw pn;vc(Zn(Gm,"location.showLocation"),"location.showLocation",[e],t)}function Qm(){return!(!Vr(ir)||!ir.supports.location)}const Zm="v1";function Xm(e){Vr(ir,sn.sidePanel),e.contentUrl&&new URL(e.contentUrl),vc(Zn(Zm,"meeting.appShareButton.setOptions"),"meeting.appShareButton.setOptions",[e])}var Ym=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const eh="v1";var th,nh,rh,oh,ih,ah;function sh(e){if(!e)throw new Error("[get incoming client audio state] Callback cannot be null");Vr(ir,sn.sidePanel,sn.meetingStage),vc(Zn(eh,"meeting.getIncomingClientAudioState"),"getIncomingClientAudioState",e)}function ch(e){if(!e)throw new Error("[toggle incoming client audio] Callback cannot be null");Vr(ir,sn.sidePanel,sn.meetingStage),vc(Zn(eh,"meeting.toggleIncomingClientAudio"),"toggleIncomingClientAudio",e)}function uh(e){if(!e)throw new Error("[get meeting details] Callback cannot be null");Vr(ir,sn.sidePanel,sn.meetingStage,sn.settings,sn.content),vc(Zn(eh,"meeting.getMeetingDetails"),"meeting.getMeetingDetails",e)}function lh(){var e,t,n;return Ym(this,void 0,void 0,(function*(){let r;Vr(ir,sn.sidePanel,sn.meetingStage,sn.settings,sn.content);try{const e=!0;r=yield uc(Zn("v2","meeting.getMeetingDetailsVerbose"),"meeting.getMeetingDetails",e)}catch(t){throw new Error(null===(e=null==t?void 0:t.errorCode)||void 0===e?void 0:e.toString())}if(((null===(t=r.details)||void 0===t?void 0:t.type)==oh.GroupCall||(null===(n=r.details)||void 0===n?void 0:n.type)==oh.OneOnOneCall)&&!r.details.originalCallerInfo)throw new Error(xe.NOT_SUPPORTED_ON_PLATFORM.toString());return r}))}function dh(e){if(!e)throw new Error("[get Authentication Token For AnonymousUser] Callback cannot be null");Vr(ir,sn.sidePanel,sn.meetingStage,sn.task),vc(Zn(eh,"meeting.getAuthenticationTokenForAnonymousUser"),"meeting.getAuthenticationTokenForAnonymousUser",e)}function fh(e){if(!e)throw new Error("[get live stream state] Callback cannot be null");Vr(ir,sn.sidePanel),vc(Zn(eh,"meeting.getLiveStreamState"),"meeting.getLiveStreamState",e)}function ph(e,t,n){if(!e)throw new Error("[request start live streaming] Callback cannot be null");Vr(ir,sn.sidePanel),vc(Zn(eh,"meeting.requestStartLiveStreaming"),"meeting.requestStartLiveStreaming",[t,n],e)}function gh(e){if(!e)throw new Error("[request stop live streaming] Callback cannot be null");Vr(ir,sn.sidePanel),vc(Zn(eh,"meeting.requestStopLiveStreaming"),"meeting.requestStopLiveStreaming",e)}function mh(e){if(!e)throw new Error("[register live stream changed handler] Handler cannot be null");Vr(ir,sn.sidePanel),ws(Zn(eh,"meeting.registerLiveStreamChangedHandler"),"meeting.liveStreamChanged",e)}function hh(e,t,n={sharingProtocol:ih.Collaborative}){if(!e)throw new Error("[share app content to stage] Callback cannot be null");Vr(ir,sn.sidePanel,sn.meetingStage),vc(Zn(eh,"meeting.shareAppContentToStage"),"meeting.shareAppContentToStage",[t,n],e)}function vh(e){if(!e)throw new Error("[get app content stage sharing capabilities] Callback cannot be null");Vr(ir,sn.sidePanel,sn.meetingStage),vc(Zn(eh,"meeting.getAppContentStageSharingCapabilities"),"meeting.getAppContentStageSharingCapabilities",e)}function wh(e){if(!e)throw new Error("[stop sharing app content to stage] Callback cannot be null");Vr(ir,sn.sidePanel,sn.meetingStage),vc(Zn(eh,"meeting.stopSharingAppContentToStage"),"meeting.stopSharingAppContentToStage",e)}function Ch(e){if(!e)throw new Error("[get app content stage sharing state] Callback cannot be null");Vr(ir,sn.sidePanel,sn.meetingStage),vc(Zn(eh,"meeting.getAppContentStageSharingState"),"meeting.getAppContentStageSharingState",e)}function yh(e){if(!e)throw new Error("[registerSpeakingStateChangeHandler] Handler cannot be null");Vr(ir,sn.sidePanel,sn.meetingStage),ws(Zn(eh,"meeting.registerSpeakingStateChangeHandler"),"meeting.speakingStateChanged",e)}function Sh(e){if(!e)throw new Error("[registerRaiseHandStateChangedHandler] Handler cannot be null");Vr(ir,sn.sidePanel,sn.meetingStage),ws(Zn(eh,"meeting.registerRaiseHandStateChangedHandler"),"meeting.raiseHandStateChanged",e)}function bh(e){if(!e)throw new Error("[registerMeetingReactionReceivedHandler] Handler cannot be null");Vr(ir,sn.sidePanel,sn.meetingStage),ws(Zn(eh,"meeting.registerMeetingReactionReceivedHandler"),"meeting.meetingReactionReceived",e)}function Eh(e){if(void 0===(null==e?void 0:e.joinWebUrl)||null===(null==e?void 0:e.joinWebUrl))return Promise.reject(new Error("Invalid joinMeetingParams"));Vr(ir);const t={joinWebUrl:e.joinWebUrl.href,source:e.source||ah.Other};return uc(Zn("v2","meeting.joinMeeting"),"meeting.joinMeeting",t)}function Ah(e,t){if(!t)throw new Error("[requestAppAudioHandling] Callback response cannot be null");if(!e.micMuteStateChangedCallback)throw new Error("[requestAppAudioHandling] Callback Mic mute state handler cannot be null");Vr(ir,sn.sidePanel,sn.meetingStage),e.isAppHandlingAudio?Ih(e,t):Ph(e,t)}function Ih(e,t){vc(Zn(eh,"meeting.requestAppAudioHandling"),"meeting.requestAppAudioHandling",[e.isAppHandlingAudio],((n,r)=>{if(n&&null!=r)throw new Error("[requestAppAudioHandling] Callback response - both parameters cannot be set");if(n)throw new Error(`[requestAppAudioHandling] Callback response - SDK error ${n.errorCode} ${n.message}`);if("boolean"!=typeof r)throw new Error("[requestAppAudioHandling] Callback response - isHostAudioless must be a boolean");ws(Zn(eh,"meeting.registerMicStateChangeHandler"),"meeting.micStateChanged",(t=>Ym(this,void 0,void 0,(function*(){try{const n=yield e.micMuteStateChangedCallback(t);Oh(n,n.isMicMuted===t.isMicMuted?th.HostInitiated:th.AppDeclinedToChange)}catch(e){Oh(t,th.AppFailedToChange)}}))));ws(Zn(eh,"meeting.registerAudioDeviceSelectionChangedHandler"),"meeting.audioDeviceSelectionChanged",(t=>{var n;null===(n=e.audioDeviceSelectionChangedCallback)||void 0===n||n.call(e,t)})),t(r)}))}function Ph(e,t){vc(Zn(eh,"meeting.requestAppAudioHandling"),"meeting.requestAppAudioHandling",[e.isAppHandlingAudio],((e,n)=>{if(e&&null!=n)throw new Error("[requestAppAudioHandling] Callback response - both parameters cannot be set");if(e)throw new Error(`[requestAppAudioHandling] Callback response - SDK error ${e.errorCode} ${e.message}`);if("boolean"!=typeof n)throw new Error("[requestAppAudioHandling] Callback response - isHostAudioless must be a boolean");ys("meeting.micStateChanged")&&Cs("meeting.micStateChanged"),ys("meeting.audioDeviceSelectionChanged")&&Cs("meeting.audioDeviceSelectionChanged"),t(n)}))}function Th(e){Oh(e,th.AppInitiated)}function Oh(e,t){Vr(ir,sn.sidePanel,sn.meetingStage),vc(Zn(eh,"meeting.setMicStateWithReason"),"meeting.updateMicState",[e,t])}!function(e){e[e.HostInitiated=0]="HostInitiated",e[e.AppInitiated=1]="AppInitiated",e[e.AppDeclinedToChange=2]="AppDeclinedToChange",e[e.AppFailedToChange=3]="AppFailedToChange"}(th||(th={})),function(e){e.like="like",e.heart="heart",e.laugh="laugh",e.surprised="surprised",e.applause="applause"}(nh||(nh={})),function(e){e.Unknown="Unknown",e.Adhoc="Adhoc",e.Scheduled="Scheduled",e.Recurring="Recurring",e.Broadcast="Broadcast",e.MeetNow="MeetNow"}(rh||(rh={})),function(e){e.OneOnOneCall="oneOnOneCall",e.GroupCall="groupCall"}(oh||(oh={})),function(e){e.Collaborative="Collaborative",e.ScreenShare="ScreenShare"}(ih||(ih={})),function(e){e.M365CalendarGridContextMenu="m365_calendar_grid_context_menu",e.M365CalendarGridPeek="m365_calendar_grid_peek",e.M365CalendarGridEventCardJoinButton="m365_calendar_grid_event_card_join_button",e.M365CalendarFormRibbonJoinButton="m365_calendar_form_ribbon_join_button",e.M365CalendarFormJoinTeamsMeetingButton="m365_calendar_form_join_teams_meeting_button",e.Other="other"}(ah||(ah={}));const Rh="v1",Fh="v2";function kh(e,t){let n,r,o="";"function"==typeof e?(n=e,r=t,o=Zn(Rh,"monetization.openPurchaseExperience")):(r=e,o=Zn(Fh,"monetization.openPurchaseExperience"));return Vr(ir,sn.content),An((()=>new Promise((e=>{if(!Mh())throw pn;e(uc(o,"monetization.openPurchaseExperience",r))}))),n)}function Mh(){return!(!Vr(ir)||!ir.supports.monetization)}const Nh="v2";function xh(e){return new Promise((t=>{if(Vr(ir,sn.content),!Uh())throw new Error("Not supported");if(!e.itemId||!e.itemId.trim())throw new Error("Must supply an itemId to openCalendarItem");t(sc(Zn(Nh,"calendar.openCalendarItem"),"calendar.openCalendarItem",e))}))}function Dh(e){return new Promise((t=>{if(Vr(ir,sn.content),!Uh())throw new Error("Not supported");const n=Zn(Nh,"calendar.composeMeeting");ir.isLegacyTeams?t(sc(n,"executeDeepLink",vg(e.attendees,e.startTime,e.endTime,e.subject,e.content))):t(sc(n,"calendar.composeMeeting",e))}))}function Uh(){return!(!Vr(ir)||!ir.supports.calendar)}const Lh="v2";function Hh(e){e&&0!==e.length&&e.forEach((e=>{Yp(e)}))}function _h(e){if(!e.handoffId||0==e.handoffId.trim().length||""===e.handoffId.trim())throw new Error("handoffId should not be null or empty string.");const t=e.composeMailParams;t.type===Gh.New&&(Hh(t.toRecipients),Hh(t.ccRecipients),Hh(t.bccRecipients))}function Vh(e){if(Vr(ir,sn.content),!Bh())throw new Error("Not supported");return _h(e),pc("mail.handoff.composeMail",[new Wh(e)],Zn(Lh,"mail.handoff.composeMail"))}function Bh(){return!!(Vr(ir)&&ir.supports.mail&&ir.supports.mail.handoff)}class Wh{constructor(e){this.composeMailParamsWithHandoff=e}serialize(){return this.composeMailParamsWithHandoff}}const jh="v2";function zh(e){return new Promise((t=>{if(Vr(ir,sn.content),!qh())throw new Error("Not supported");if(!e.itemId||!e.itemId.trim())throw new Error("Must supply an itemId to openMailItem");t(sc(Zn(jh,"mail.openMailItem"),"mail.openMailItem",e))}))}function $h(e){return new Promise((t=>{if(Vr(ir,sn.content),!qh())throw new Error("Not supported");t(sc(Zn(jh,"mail.composeMail"),"mail.composeMail",e))}))}function qh(){return!(!Vr(ir)||!ir.supports.mail)}var Gh;!function(e){e.New="new",e.Reply="reply",e.ReplyAll="replyAll",e.Forward="forward"}(Gh||(Gh={}));const Jh="v2";function Kh(){if(!$n.printCapabilityEnabled){if(Vr(ir),!tv())throw pn;$n.printCapabilityEnabled=!0,document.addEventListener("keydown",(e=>{(e.ctrlKey||e.metaKey)&&80===e.keyCode&&(Qh(),e.cancelBubble=!0,e.preventDefault(),e.stopImmediatePropagation())}))}}function Qh(){kn().print()}function Zh(e){Xh(Zn(Jh,"teamsAPIs_registerOnLoadHandler"),e,(()=>{if(!eo(e)&&!tv())throw pn}))}function Xh(e,t,n){!eo(t)&&Vr(ir),!eo(t)&&n&&n(),Ps(e,t)}function Yh(e){ev(Zn(Jh,"teamsAPIs_registerBeforeUnloadHandler"),e,(()=>{if(!eo(e)&&!tv())throw pn}))}function ev(e,t,n){!eo(t)&&Vr(ir),!eo(t)&&n&&n(),Rs(e,t)}function tv(){return!(!Vr(ir)||!ir.supports.teamsCore)}const nv="v1",rv="v2";function ov(e,t){let n,r;Vr(ir,sn.content,sn.task,sn.settings);let o="";return"function"==typeof e?([n,r]=[e,t],o=Zn(nv,"people.selectPeople")):(r=e,o=Zn(rv,"people.selectPeople")),bn(iv,n,o,r)}function iv(e,t){return new Promise((n=>{if(!Br(Qe))throw{errorCode:xe.OLD_PLATFORM};if(!Yg(t))throw{errorCode:xe.INVALID_ARGUMENTS};if(!av())throw pn;n(uc(e,"people.selectPeople",t))}))}function av(){return!(!Vr(ir)||!ir.supports.people)}function sv(e){return e?e.modality&&"string"!=typeof e.modality?[!1,"modality must be a string"]:e.targetElementBoundingRect&&"object"==typeof e.targetElementBoundingRect?e.triggerType&&"string"==typeof e.triggerType?cv(e.persona):[!1,"triggerType must be a valid string"]:[!1,"targetElementBoundingRect must be a DOMRect"]:[!1,"A request object is required"]}function cv(e){return e?e.displayName&&"string"!=typeof e.displayName?[!1,"displayName must be a string"]:e.identifiers&&"object"==typeof e.identifiers?e.identifiers.AadObjectId||e.identifiers.Smtp||e.identifiers.Upn?e.identifiers.AadObjectId&&"string"!=typeof e.identifiers.AadObjectId?[!1,"AadObjectId identifier must be a string"]:e.identifiers.Smtp&&"string"!=typeof e.identifiers.Smtp?[!1,"Smtp identifier must be a string"]:e.identifiers.Upn&&"string"!=typeof e.identifiers.Upn?[!1,"Upn identifier must be a string"]:[!0,void 0]:[!1,"at least one valid identifier must be provided"]:[!1,"persona identifiers object must be provided"]:[!1,"persona object must be provided"]}const uv="v2";function lv(e){return Vr(ir,sn.content),new Promise((t=>{const[n,r]=sv(e);if(!n)throw{errorCode:xe.INVALID_ARGUMENTS,message:r};const o={modality:e.modality,persona:e.persona,triggerType:e.triggerType,targetRectangle:{x:e.targetElementBoundingRect.x,y:e.targetElementBoundingRect.y,width:e.targetElementBoundingRect.width,height:e.targetElementBoundingRect.height}};t(uc(Zn(uv,"profile.showProfile"),"profile.showProfile",o))}))}function dv(){return!(!Vr(ir)||!ir.supports.profile)}const fv="v2",pv="search.queryChange",gv="search.queryClose",mv="search.queryExecute";function hv(e,t,n){if(Vr(ir,sn.content),!wv())throw pn;ws(Zn(fv,"search.registerOnClosedHandler"),gv,e),ws(Zn(fv,"search.registerOnExecutedHandler"),mv,t),n&&ws(Zn(fv,"search.registerOnChangeHandler"),pv,n)}function vv(){if(Vr(ir,sn.content),!wv())throw pn;vc(Zn(fv,"search.unregisterHandlers"),"search.unregister"),Cs(pv),Cs(gv),Cs(mv)}function wv(){return!(!Vr(ir)||!ir.supports.search)}function Cv(){return new Promise((e=>{if(Vr(ir,sn.content),!wv())throw new Error("Not supported");e(sc(Zn(fv,"search.closeSearch"),"search.closeSearch"))}))}var yv=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const Sv="v2";function bv(){return yv(this,void 0,void 0,(function*(){if(Vr(ir,sn.sidePanel,sn.meetingStage),!Ev())throw pn;return yield uc(Zn(Sv,"sharing.history.getContent"),"sharing.history.getContent")}))}function Ev(){var e;return Vr(ir)&&void 0!==(null===(e=ir.supports.sharing)||void 0===e?void 0:e.history)}const Av="v1",Iv="v2",Pv={shareWebContent:"sharing.shareWebContent"};function Tv(e,t){try{Rv(e),Fv(e),kv(e)}catch(e){return En((()=>Promise.reject(e)),t)}Vr(ir,sn.content,sn.sidePanel,sn.task,sn.stage,sn.meetingStage);return En(Ov,t,Zn(t?Av:Iv,"sharing.shareWebContent"),e)}function Ov(e,t){return new Promise((n=>{if(!Mv())throw pn;n(uc(e,Pv.shareWebContent,t))}))}function Rv(e){if(!(e&&e.content&&e.content.length)){throw{errorCode:xe.INVALID_ARGUMENTS,message:"Shared content is missing"}}}function Fv(e){let t;if(e.content.some((e=>!e.type)))throw t={errorCode:xe.INVALID_ARGUMENTS,message:"Shared content type cannot be undefined"},t;if(e.content.some((t=>t.type!==e.content[0].type)))throw t={errorCode:xe.INVALID_ARGUMENTS,message:"Shared content must be of the same type"},t}function kv(e){let t;if("URL"!==e.content[0].type)throw t={errorCode:xe.INVALID_ARGUMENTS,message:"Content type is unsupported"},t;if(e.content.some((e=>!e.url)))throw t={errorCode:xe.INVALID_ARGUMENTS,message:"URLs are required for URL content types"},t}function Mv(){return!(!Vr(ir)||!ir.supports.sharing)}const Nv="v2";function xv(){return new Promise((e=>{if(Vr(ir,sn.content),!Dv())throw pn;e(uc(Zn(Nv,"stageView.self.close"),"stageView.self.close"))}))}function Dv(){var e;return Vr(ir)&&void 0!==(null===(e=ir.supports.stageView)||void 0===e?void 0:e.self)}const Uv="v2";var Lv;function Hv(e){return new Promise((t=>{if(Vr(ir,sn.content),!_v())throw pn;if(!e)throw new Error("[stageView.open] Stage view params cannot be null");t(uc(Zn(Uv,"stageView.open"),"stageView.open",e))}))}function _v(){return!(!Vr(ir)||!ir.supports.stageView)}!function(e){e.modal="modal",e.popout="popout",e.popoutWithChat="popoutWithChat"}(Lv||(Lv={}));const Vv=10;var Bv=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const Wv="v2";function jv(e){return Bv(this,void 0,void 0,(function*(){Vr(ir,sn.content,sn.task),qv(),Gv(e);const t=yield uc(Zn(Wv,"visualMedia.image.captureImages"),"visualMedia.image.captureImages",e);return Jv(e.maxVisualMediaCount,t),t}))}function zv(e){return Bv(this,void 0,void 0,(function*(){Vr(ir,sn.content,sn.task),qv(),Gv(e);const t=yield uc(Zn(Wv,"visualMedia.image.retrieveImages"),"visualMedia.image.retrieveImages",e);return Jv(e.maxVisualMediaCount,t),t}))}function $v(){return!!(Vr(ir)&&ir.supports.visualMedia&&ir.supports.visualMedia.image&&ir.supports.permissions)}function qv(){if(!$v())throw pn}function Gv(e){if(!e||e.maxVisualMediaCount>Vv||e.maxVisualMediaCount<1)throw hn}function Jv(e,t){if(t.length>e)throw vn}const Kv="v2";var Qv,Zv;function Xv(){if(Vr(ir,sn.content,sn.task),!$v())throw pn;const e=De.Media;return uc(Zn(Kv,"visualMedia.hasPermission"),"permissions.has",e)}function Yv(){if(Vr(ir,sn.content,sn.task),!$v())throw pn;const e=De.Media;return uc(Zn(Kv,"visualMedia.requestPermission"),"permissions.request",e)}!function(e){e[e.FrontOrRear=1]="FrontOrRear",e[e.FrontOnly=2]="FrontOnly",e[e.RearOnly=3]="RearOnly"}(Qv||(Qv={})),function(e){e[e.Camera=1]="Camera",e[e.Gallery=2]="Gallery"}(Zv||(Zv={}));var ew=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};let tw=null;function nw(){return ew(this,void 0,void 0,(function*(){return null===tw&&(tw=(yield Oo()).app.host.name),tw}))}var rw=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};function ow(){return rw(this,void 0,void 0,(function*(){if(Vr(ir),!aw())throw pn;return!(!ir.isLegacyTeams||$n.hostClientType!==on.android&&$n.hostClientType!==on.ios&&$n.hostClientType!==on.ipados&&$n.hostClientType!==on.visionOS||(yield iw())!==an.teams)||(yield ac(Zn("v2","webStorage.isWebStorageClearedOnUserLogOut"),"webStorage.isWebStorageClearedOnUserLogOut"))}))}function iw(){return rw(this,void 0,void 0,(function*(){return nw()}))}function aw(){return Vr(ir)&&void 0!==ir.supports.webStorage}const sw="v2";var cw;function uw(e){const t=Zn(sw,"call.startCall");return new Promise((n=>{var r;if(Vr(ir,sn.content,sn.task),!lw())throw pn;if(!ir.isLegacyTeams)return vc(t,"call.startCall",[e],n);n(ac(t,"executeDeepLink",hg(e.targets,null===(r=e.requestedModalities)||void 0===r?void 0:r.includes(cw.Video),e.source)).then((e=>{if(!e)throw new Error(ut);return e})))}))}function lw(){return!(!Vr(ir)||!ir.supports.call)}!function(e){e.Unknown="unknown",e.Audio="audio",e.Video="video",e.VideoBasedScreenSharing="videoBasedScreenSharing",e.Data="data"}(cw||(cw={}));const dw="v1";function fw(){Ji(Zn(dw,"appInitialization.notifyAppLoaded"))}function pw(){vc(Zn(dw,"appInitialization.notifySuccess"),yo.Success,[yr])}function gw(e){Qi(Zn(dw,"appInitialization.notifyFailure"),e)}function mw(e){Ki(Zn(dw,"appInitialization.notifyExpectedFailure"),e)}const hw=Qn("thirdPartyCloudStorage"),vw="v2";class ww{constructor(e,t){this.fileType=e,this.assembleAttachment=t}}let Cw=[],yw=null,Sw=!0,bw=null;function Ew(e,t){if(!t)throw new Error("[getDragAndDropFiles] Callback cannot be null");if(e&&""!==e){if(Vr(ir,sn.content,sn.task),!Iw())throw pn;if(bw)throw bw=null,new Error("getDragAndDropFiles cannot be called twice");bw=t,Sw=!0,vc(Zn(vw,"thirdPartyCloudStorage.getDragAndDropFiles"),"thirdPartyCloudStorage.getDragAndDropFiles",[e],Aw)}else{t([],{errorCode:xe.INVALID_ARGUMENTS})}}function Aw(e){if(bw)if(e&&e.error)bw([],e.error),bw=null;else if(e&&e.fileChunk)try{Sw||0!==e.fileChunk.chunkSequence||(hw("Last chunk is not received or 'endOfFile' value for previous chunk was not set to true"),Sw=!0,bw([],{errorCode:xe.INTERNAL_ERROR,message:"error occurred while receiving data"}),Cw=[],bw=null);const t=jg(e.fileChunk,e.fileType);if(t?(yw||(yw=new ww(e.fileType,[])),yw.assembleAttachment.push(t)):(hw(`Received a null assemble attachment for when decoding chunk sequence ${e.fileChunk.chunkSequence}; not including the chunk in the assembled file.`),bw?bw([],{errorCode:xe.INTERNAL_ERROR,message:"error occurred while receiving data"}):bw=null,Cw=[],bw=null,Sw=!0),Sw=e.fileChunk.endOfFile,e.fileChunk.endOfFile&&yw){const t=Wg(yw.assembleAttachment,yw.fileType);if(t){const n=new File([t],e.fileName,{type:t.type});Cw.push(n)}e.isLastFile&&bw&&(bw(Cw,e.error),Cw=[],bw=null,Sw=!0),yw=null}}catch(e){bw&&(bw([],{errorCode:xe.INTERNAL_ERROR,message:e}),Cw=[],bw=null,Sw=!0)}else bw([],{errorCode:xe.INTERNAL_ERROR,message:"data received is null"}),Cw=[],bw=null,Sw=!0}function Iw(){return!(!Vr(ir)||!ir.supports.thirdPartyCloudStorage)}const Pw="v1";function Tw(e,t){Gi(Zn(Pw,"initialize"),t).then((()=>{e&&e()}))}function Ow(){Kh()}function Rw(){Qh()}function Fw(e){_r(),vc(Zn(Pw,"getContext"),"getContext",(t=>{t.frameContext||(t.frameContext=$n.frameContext),e(t)}))}function kw(e){na(Zn(Pw,"registerOnThemeChangeHandlerHelper"),e)}function Mw(e){Ss(Zn(Pw,"registerFullScreenHandler"),"fullScreenChange",e,[])}function Nw(e){Ss(Zn(Pw,"registerAppButtonClickHandler"),"appButtonClick",e,[sn.content])}function xw(e){Ss(Zn(Pw,"registerAppButtonHoverEnterHandler"),"appButtonHoverEnter",e,[sn.content])}function Dw(e){Ss(Zn(Pw,"registerAppButtonHoverLeaveHandler"),"appButtonHoverLeave",e,[sn.content])}function Uw(e){ba(Zn(Pw,"registerBackButtonHandler"),e)}function Lw(e){Xh(Zn(Pw,"registerOnLoadHandler"),e)}function Hw(e){ev(Zn(Pw,"registerBeforeUnloadHandler"),e)}function _w(e){Ss(Zn(Pw,"registerFocusEnterHandler"),"focusEnter",e,[])}function Vw(e){Ss(Zn(Pw,"registerChangeSettingsHandler"),"changeSettings",e,[sn.content])}function Bw(e,t){Vr(ir),Za(Zn(Pw,"getTabInstances"),t).then((t=>{e(t)}))}function Ww(e,t){Vr(ir),Xa(Zn(Pw,"getMruTabInstances"),t).then((t=>{e(t)}))}function jw(e){Ya(Zn(Pw,"shareDeepLink"),{subPageId:e.subEntityId,subPageLabel:e.subEntityLabel,subPageWebUrl:e.subEntityWebUrl})}function zw(e,t){Vr(ir,sn.content,sn.sidePanel,sn.settings,sn.task,sn.stage,sn.meetingStage);const n=null!=t?t:wn();ra(Zn(Pw,"executeDeepLink"),e).then((()=>{n(!0)})).catch((e=>{n(!1,e.message)}))}function $w(e){es(Zn(Pw,"setFrameContext"),e)}function qw(e,t,n){Gi(Zn(Pw,"initializeWithFrameContext"),n).then((()=>t&&t())),es(Zn(Pw,"setFrameContext"),e)}const Gw="v1";function Jw(e){Qa(Zn(Gw,"navigation.returnFocus"),e)}function Kw(e,t){Vr(ir);const n=null!=t?t:wn();Ka(Zn(Gw,"navigation.navigateToTab"),e).then((()=>{n(!0)})).catch((e=>{n(!1,e.message)}))}function Qw(e,t){Vr(ir,sn.content,sn.sidePanel,sn.settings,sn.remove,sn.task,sn.stage,sn.meetingStage);const n=null!=t?t:wn();Ga(Zn(Gw,"navigation.navigateCrossDomain"),e).then((()=>{n(!0)})).catch((e=>{n(!1,e.message)}))}function Zw(e){Vr(ir);const t=null!=e?e:wn();Ja(Zn(Gw,"navigation.navigateBack")).then((()=>{t(!0)})).catch((e=>{t(!1,e.message)}))}const Xw="v1";function Yw(e){ts(Zn(Xw,"settings.setValidityState"),e)}function eC(e){Vr(ir,sn.content,sn.settings,sn.remove,sn.sidePanel),ns(Zn(Xw,"settings.getSettings")).then((t=>{e(t)}))}function tC(e,t){Vr(ir,sn.content,sn.settings,sn.sidePanel);const n=null!=t?t:wn();rs(Zn(Xw,"settings.setSettings"),e).then((()=>{n(!0)})).catch((e=>{n(!1,e.message)}))}function nC(e){Ni(Zn(Xw,"settings.registerOnSaveHandler"),e)}function rC(e){Di(Zn(Xw,"settings.registerOnRemoveHandler"),e)}var oC=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};const iC="v1";function aC(e,t){const n=Zn(iC,"tasks.startTask"),r=t?e=>{var n,r;return t(null!==(n=e.err)&&void 0!==n?n:"",null!==(r=e.result)&&void 0!==r?r:"")}:void 0;return void 0===e.card&&void 0===e.url||e.card?(Vr(ir,sn.content,sn.sidePanel,sn.meetingStage),vc(n,"tasks.startTask",[e],t)):void 0!==e.completionBotId?ei(n,lC(e),r):Yo(n,uC(e),r),new Wm}function sC(e){e=dC(e);const{width:t,height:n}=e,r=oC(e,["width","height"]);if(Object.keys(r).length)throw new Error("resize requires a TaskInfo argument containing only width and height");Xo(Zn(iC,"tasks.updateTask"),e)}function cC(e,t){ti(Zn(iC,"tasks.submitTask"),e,t)}function uC(e){if(void 0===e.url)throw new Error("url property of taskInfo object can't be undefined");return{url:e.url,size:{height:e.height?e.height:dn.Small,width:e.width?e.width:dn.Small},title:e.title,fallbackUrl:e.fallbackUrl}}function lC(e){if(void 0===e.url||void 0===e.completionBotId)throw new Error(`Both url ${e.url} and completionBotId ${e.completionBotId} are required for bot url dialog. At least one is undefined.`);return{url:e.url,size:{height:e.height?e.height:dn.Small,width:e.width?e.width:dn.Small},title:e.title,fallbackUrl:e.fallbackUrl,completionBotId:e.completionBotId}}function dC(e){return e.height=e.height?e.height:dn.Small,e.width=e.width?e.width:dn.Small,e}const fC="v2";var pC,gC;function mC(){return!(!Vr(ir,sn.meetingStage,sn.sidePanel,sn.content)||!ir.supports.interactive)}!function(e){e.guest="Guest",e.attendee="Attendee",e.presenter="Presenter",e.organizer="Organizer"}(pC||(pC={})),function(e){e.added="Added",e.alreadyExists="AlreadyExists",e.conflict="Conflict",e.notFound="NotFound"}(gC||(gC={}));class hC{getFluidTenantInfo(){return vC(),new Promise((e=>{e(uc(Zn(fC,"interactive.getFluidTenantInfo"),"interactive.getFluidTenantInfo"))}))}getFluidToken(e){return vC(),new Promise((t=>{t(uc(Zn(fC,"interactive.getFluidToken"),"interactive.getFluidToken",e))}))}getFluidContainerId(){return vC(),new Promise((e=>{e(uc(Zn(fC,"interactive.getFluidContainerId"),"interactive.getFluidContainerId"))}))}setFluidContainerId(e){return vC(),new Promise((t=>{t(uc(Zn(fC,"interactive.setFluidContainerId"),"interactive.setFluidContainerId",e))}))}getNtpTime(){return vC(),new Promise((e=>{e(uc(Zn(fC,"interactive.getNtpTime"),"interactive.getNtpTime"))}))}registerClientId(e){return vC(),new Promise((t=>{t(uc(Zn(fC,"interactive.registerClientId"),"interactive.registerClientId",e))}))}getClientRoles(e){return vC(),new Promise((t=>{t(uc(Zn(fC,"interactive.getClientRoles"),"interactive.getClientRoles",e))}))}getClientInfo(e){return vC(),new Promise((t=>{t(uc(Zn(fC,"interactive.getClientInfo"),"interactive.getClientInfo",e))}))}static create(){return vC(),new hC}}function vC(){if(!mC())throw new Error("LiveShareHost Not supported")}var wC=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};function CC(e){try{return e.cartItems=yC(e.cartItems),e}catch(e){throw new Error("Error deserializing cart")}}function yC(e){return e.map((e=>{if(e.imageURL){const t=new URL(e.imageURL);e.imageURL=t}return e.accessories&&(e.accessories=yC(e.accessories)),e}))}const SC=e=>{try{return e.map((e=>{const{imageURL:t,accessories:n}=e,r=wC(e,["imageURL","accessories"]),o=Object.assign({},r);return t&&(o.imageURL=t.href),n&&(o.accessories=SC(n)),o}))}catch(e){throw new Error("Error serializing cart items")}};function bC(e){if(!Array.isArray(e)||0===e.length)throw new Error("cartItems must be a non-empty array");for(const t of e)AC(t),EC(t.accessories)}function EC(e){if(null!=e){if(!Array.isArray(e)||0===e.length)throw new Error("CartItem.accessories must be a non-empty array");for(const t of e){if(t.accessories)throw new Error("Item in CartItem.accessories cannot have accessories");AC(t)}}}function AC(e){if(!e.id)throw new Error("cartItem.id must not be empty");if(!e.name)throw new Error("cartItem.name must not be empty");PC(e.price),TC(e.quantity)}function IC(e){if(null!=e){if(!e)throw new Error("id must not be empty");if(!1===rn(e))throw new Error("id must be a valid UUID")}}function PC(e){if("number"!=typeof e||e<0)throw new Error(`price ${e} must be a number not less than 0`);if(parseFloat(e.toFixed(3))!==e)throw new Error(`price ${e} must have at most 3 decimal places`)}function TC(e){if("number"!=typeof e||e<=0||parseInt(e.toString())!==e)throw new Error(`quantity ${e} must be an integer greater than 0`)}function OC(e){if(!Object.values(MC).includes(e))throw new Error(`cartStatus ${e} is not valid`)}const RC="v2",FC={majorVersion:1,minorVersion:1};var kC,MC;function NC(){if(Vr(ir,sn.content,sn.task),!LC())throw pn;return uc(Zn(RC,"marketplace.getCart"),"marketplace.getCart",FC).then(CC)}function xC(e){if(Vr(ir,sn.content,sn.task),!LC())throw pn;if(!e)throw new Error("addOrUpdateCartItemsParams must be provided");return IC(null==e?void 0:e.cartId),bC(null==e?void 0:e.cartItems),uc(Zn(RC,"marketplace.addOrUpdateCartItems"),"marketplace.addOrUpdateCartItems",Object.assign(Object.assign({},e),{cartItems:SC(e.cartItems),cartVersion:FC})).then(CC)}function DC(e){if(Vr(ir,sn.content,sn.task),!LC())throw pn;if(!e)throw new Error("removeCartItemsParams must be provided");if(IC(null==e?void 0:e.cartId),!Array.isArray(null==e?void 0:e.cartItemIds)||0===(null==e?void 0:e.cartItemIds.length))throw new Error("cartItemIds must be a non-empty array");return uc(Zn(RC,"marketplace.removeCartItems"),"marketplace.removeCartItems",Object.assign(Object.assign({},e),{cartVersion:FC})).then(CC)}function UC(e){if(Vr(ir,sn.content,sn.task),!LC())throw pn;if(!e)throw new Error("updateCartStatusParams must be provided");return IC(null==e?void 0:e.cartId),OC(null==e?void 0:e.cartStatus),uc(Zn(RC,"marketplace.updateCartStatus"),"marketplace.updateCartStatus",Object.assign(Object.assign({},e),{cartVersion:FC})).then(CC)}function LC(){return!(!Vr(ir)||!ir.supports.marketplace)}!function(e){e.TACAdminUser="TACAdminUser",e.TeamsAdminUser="TeamsAdminUser",e.TeamsEndUser="TeamsEndUser"}(kC||(kC={})),function(e){e.Open="Open",e.Processing="Processing",e.Processed="Processed",e.Closed="Closed",e.Error="Error"}(MC||(MC={}))})(),r})()));
//# sourceMappingURL=MicrosoftTeams.min.js.map